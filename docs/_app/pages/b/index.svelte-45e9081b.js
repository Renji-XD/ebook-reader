import{S as qe,i as Xe,n as We,Q as Gn,k as Qe,R as Hn,f as N,E as nt,d as D,T as St,u as qn,e as Z,j as re,c as x,a as $,l as ie,b as Y,s as P,w as _e,x as we,U as j,y as Se,L as Ee,q as K,o as J,B as ve,V as vt,W as qt,X as pn,Y as ee,J as oe,Z as bn,m as Ze,p as xe,t as ge,g as ke,h as Be,_ as W,$ as se,a0 as ue,v as Xn,a1 as Wn,a2 as jn,a3 as Ut,I as Yn}from"../../chunks/index-fca9486f.js";import{F as Je,f as Kn,a as Rt,p as ct,o as ht,b as Un,c as Jn,n as Qn,t as Zn,d as xn,q as Jt,e as Qt}from"../../chunks/css-classes-d5103e52.js";import{p as $n}from"../../chunks/stores-c68c1c1f.js";import{d as eo,i as to,m as dt,a as $e,b as no,E as Xt,c as oo,f as ro,p as io,e as ao,g as Ne,o as it,s as kt,h as me,j as yt,F as Ce,k as Cn,l as _n,t as Wt,n as Lt,q as Nt,R as lo,r as Gt,V as mt,B as Re,u as Zt,v as lt,w as so,x as uo,y as fo,z as co,A as Ot,C as ho,D as mo,G as go,H as ko,I as po,J as bo,K as Co,L as _o,M as wo,N as So,O as vo,P as yo,Q as Mo}from"../../chunks/format-page-title-093c0453.js";import{S as wn,_ as pt,a as ot,b as at,c as Fo,i as Ge,O as Ie,n as Sn,d as Po,B as Ht,e as Pe,w as Eo}from"../../chunks/store-9e108e48.js";import{m as Bo,c as rt,o as vn,b as Do,f as To,a as xt}from"../../chunks/index.es-7b1e7ea8.js";import{r as Ye,c as Io,a as Ao}from"../../chunks/use-click-outside-e0a5912b.js";import{t as Ve}from"../../chunks/tap-3267680f.js";import"../../chunks/singletons-d1fb5791.js";const yn=!0;var tt={schedule:function(t){var e=requestAnimationFrame,n=cancelAnimationFrame,r=tt.delegate;r&&(e=r.requestAnimationFrame,n=r.cancelAnimationFrame);var o=e(function(i){n=void 0,t(i)});return new wn(function(){return n==null?void 0:n(o)})},requestAnimationFrame:function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=tt.delegate;return((n==null?void 0:n.requestAnimationFrame)||requestAnimationFrame).apply(void 0,pt([],ot(t)))},cancelAnimationFrame:function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=tt.delegate;return((n==null?void 0:n.cancelAnimationFrame)||cancelAnimationFrame).apply(void 0,pt([],ot(t)))},delegate:void 0},Oo=function(t){at(e,t);function e(n,r){return t.call(this)||this}return e.prototype.schedule=function(n,r){return this},e}(wn),bt={setInterval:function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];var o=bt.delegate;return o!=null&&o.setInterval?o.setInterval.apply(o,pt([t,e],ot(n))):setInterval.apply(void 0,pt([t,e],ot(n)))},clearInterval:function(t){var e=bt.delegate;return((e==null?void 0:e.clearInterval)||clearInterval)(t)},delegate:void 0},Mn=function(t){at(e,t);function e(n,r){var o=t.call(this,n,r)||this;return o.scheduler=n,o.work=r,o.pending=!1,o}return e.prototype.schedule=function(n,r){if(r===void 0&&(r=0),this.closed)return this;this.state=n;var o=this.id,i=this.scheduler;return o!=null&&(this.id=this.recycleAsyncId(i,o,r)),this.pending=!0,this.delay=r,this.id=this.id||this.requestAsyncId(i,this.id,r),this},e.prototype.requestAsyncId=function(n,r,o){return o===void 0&&(o=0),bt.setInterval(n.flush.bind(n,this),o)},e.prototype.recycleAsyncId=function(n,r,o){if(o===void 0&&(o=0),o!=null&&this.delay===o&&this.pending===!1)return r;bt.clearInterval(r)},e.prototype.execute=function(n,r){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;var o=this._execute(n,r);if(o)return o;this.pending===!1&&this.id!=null&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))},e.prototype._execute=function(n,r){var o=!1,i;try{this.work(n)}catch(a){o=!0,i=a||new Error("Scheduled action threw falsy error")}if(o)return this.unsubscribe(),i},e.prototype.unsubscribe=function(){if(!this.closed){var n=this,r=n.id,o=n.scheduler,i=o.actions;this.work=this.state=this.scheduler=null,this.pending=!1,Fo(i,this),r!=null&&(this.id=this.recycleAsyncId(o,r,null)),this.delay=null,t.prototype.unsubscribe.call(this)}},e}(Oo),$t=function(){function t(e,n){n===void 0&&(n=t.now),this.schedulerActionCtor=e,this.now=n}return t.prototype.schedule=function(e,n,r){return n===void 0&&(n=0),new this.schedulerActionCtor(this,e).schedule(r,n)},t.now=eo.now,t}(),Fn=function(t){at(e,t);function e(n,r){r===void 0&&(r=$t.now);var o=t.call(this,n,r)||this;return o.actions=[],o._active=!1,o._scheduled=void 0,o}return e.prototype.flush=function(n){var r=this.actions;if(this._active){r.push(n);return}var o;this._active=!0;do if(o=n.execute(n.state,n.delay))break;while(n=r.shift());if(this._active=!1,o){for(;n=r.shift();)n.unsubscribe();throw o}},e}($t),Mt=new Fn(Mn),Vo=Mt,zo=function(t){at(e,t);function e(n,r){var o=t.call(this,n,r)||this;return o.scheduler=n,o.work=r,o}return e.prototype.requestAsyncId=function(n,r,o){return o===void 0&&(o=0),o!==null&&o>0?t.prototype.requestAsyncId.call(this,n,r,o):(n.actions.push(this),n._scheduled||(n._scheduled=tt.requestAnimationFrame(function(){return n.flush(void 0)})))},e.prototype.recycleAsyncId=function(n,r,o){if(o===void 0&&(o=0),o!=null&&o>0||o==null&&this.delay>0)return t.prototype.recycleAsyncId.call(this,n,r,o);n.actions.some(function(i){return i.id===r})||(tt.cancelAnimationFrame(r),n._scheduled=void 0)},e}(Mn),Ro=function(t){at(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.flush=function(n){this._active=!0;var r=this._scheduled;this._scheduled=void 0;var o=this.actions,i;n=n||o.shift();do if(i=n.execute(n.state,n.delay))break;while((n=o[0])&&n.id===r&&o.shift());if(this._active=!1,i){for(;(n=o[0])&&n.id===r&&o.shift();)n.unsubscribe();throw i}},e}(Fn),Ft=new Ro(zo);function Lo(t){return t instanceof Date&&!isNaN(t)}var No=["addListener","removeListener"],Go=["addEventListener","removeEventListener"],Ho=["on","off"];function He(t,e,n,r){if(Ge(n)&&(r=n,n=void 0),r)return He(t,e,n).pipe(Bo(r));var o=ot(Wo(t)?Go.map(function(l){return function(f){return t[l](e,f,n)}}):qo(t)?No.map(en(t,e)):Xo(t)?Ho.map(en(t,e)):[],2),i=o[0],a=o[1];if(!i&&to(t))return dt(function(l){return He(l,e,n)})($e(t));if(!i)throw new TypeError("Invalid event target");return new Ie(function(l){var f=function(){for(var s=[],h=0;h<arguments.length;h++)s[h]=arguments[h];return l.next(1<s.length?s:s[0])};return i(f),function(){return a(f)}})}function en(t,e){return function(n){return function(r){return t[n](e,r)}}}function qo(t){return Ge(t.addListener)&&Ge(t.removeListener)}function Xo(t){return Ge(t.on)&&Ge(t.off)}function Wo(t){return Ge(t.addEventListener)&&Ge(t.removeEventListener)}function jt(t,e,n){t===void 0&&(t=0),n===void 0&&(n=Vo);var r=-1;return e!=null&&(no(e)?n=e:r=e),new Ie(function(o){var i=Lo(t)?+t-n.now():t;i<0&&(i=0);var a=0;return n.schedule(function(){o.closed||(o.next(a++),0<=r?this.schedule(void 0,r):o.complete())},i)})}function jo(t,e){return t===void 0&&(t=0),e===void 0&&(e=Mt),t<0&&(t=0),jt(t,t,e)}function Pt(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=io(t),r=ao(t,1/0),o=t;return o.length?o.length===1?$e(o[0]):oo(r)(ro(o,n)):Xt}var Pn=new Ie(Sn),Yo=Array.isArray;function Ko(t){return t.length===1&&Yo(t[0])?t[0]:t}function Uo(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return t=Ko(t),t.length===1?$e(t[0]):new Ie(Jo(t))}function Jo(t){return function(e){for(var n=[],r=function(i){n.push($e(t[i]).subscribe(Ne(e,function(a){if(n){for(var l=0;l<n.length;l++)l!==i&&n[l].unsubscribe();n=null}e.next(a)})))},o=0;n&&!e.closed&&o<t.length;o++)r(o)}}function En(t,e){return e===void 0&&(e=Mt),it(function(n,r){var o=null,i=null,a=null,l=function(){if(o){o.unsubscribe(),o=null;var s=i;i=null,r.next(s)}};function f(){var s=a+t,h=e.now();if(h<s){o=this.schedule(void 0,s-h),r.add(o);return}l()}n.subscribe(Ne(r,function(s){i=s,a=e.now(),o||(o=e.schedule(f,t),r.add(o))},function(){l(),r.complete()},void 0,function(){i=o=null}))})}function Bn(t,e){return e===void 0&&(e=Po),t=t!=null?t:Qo,it(function(n,r){var o,i=!0;n.subscribe(Ne(r,function(a){var l=e(a);(i||!t(o,l))&&(i=!1,o=l,r.next(a))}))})}function Qo(t,e){return t===e}function Zo(){return it(function(t,e){var n,r=!1;t.subscribe(Ne(e,function(o){var i=n;n=o,r&&e.next([i,o]),r=!0}))})}function Le(t){return it(function(e,n){$e(t).subscribe(Ne(n,function(){return n.complete()},Sn)),!n.closed&&e.subscribe(n)})}var Dn={leading:!0,trailing:!1};function xo(t,e){return e===void 0&&(e=Dn),it(function(n,r){var o=e.leading,i=e.trailing,a=!1,l=null,f=null,s=!1,h=function(){f==null||f.unsubscribe(),f=null,i&&(u(),s&&r.complete())},k=function(){f=null,s&&r.complete()},p=function(d){return f=$e(t(d)).subscribe(Ne(r,h,k))},u=function(){if(a){a=!1;var d=l;l=null,r.next(d),!s&&p(d)}};n.subscribe(Ne(r,function(d){a=!0,l=d,!(f&&!f.closed)&&(o?u():p(d))},function(){s=!0,!(i&&a&&f&&!f.closed)&&r.complete()}))})}function $o(t,e,n){e===void 0&&(e=Mt),n===void 0&&(n=Dn);var r=jt(t,e);return xo(function(){return r},n)}function er(t){let e,n;return{c(){e=new Gn,n=Qe(),this.h()},l(r){e=Hn(r),n=Qe(),this.h()},h(){e.a=n},m(r,o){e.m(t[0],r,o),N(r,n,o)},p(r,[o]){o&1&&e.p(r[0])},i:nt,o:nt,d(r){r&&D(n),r&&e.d()}}}function tr(t,e,n){let{html:r}=e;const o=St();return qn(()=>{o("load")}),t.$$set=i=>{"html"in i&&n(0,r=i.html)},[r]}class Tn extends qe{constructor(e){super();Xe(this,e,tr,er,We,{html:0})}}/**
 * @license BSD-3-Clause
 * Copyright (c) 2022, ッツ Reader Authors
 * All rights reserved.
 */function Ke(t,e){return e==="rtl"?-t:t}/**
 * @license BSD-3-Clause
 * Copyright (c) 2022, ッツ Reader Authors
 * All rights reserved.
 */class nr{constructor(e,n){this.calculator=e,this.window=n}scrollToBookmark(e){const n=this.getBookmarkPosition(e);if(!n)return;const{scrollToData:r}=tn(n);this.window.scrollTo(r)}formatBookmarkData(e){const n=this.calculator.calcExploredCharCount(),r=this.calculator.charCount,{verticalMode:o}=this.calculator,i=o?"scrollX":"scrollY";return{dataId:e,exploredCharCount:n,progress:n/r,[i]:this.window[i]}}getBookmarkBarPosition(e){const n=this.getBookmarkPosition(e);if(!!n)return tn(n).bookmarkPosData}getBookmarkPosition(e){if(!e.exploredCharCount)return;const{verticalMode:n}=this.calculator,r=this.getBookmarkTargetPosByScrollValue(e);if(r)return r;const o=this.calculator.getScrollPosByCharCount(e.exploredCharCount);return n?{scrollX:o}:{scrollY:o}}getBookmarkTargetPosByScrollValue(e){const{exploredCharCount:n}=e,r=o=>{const i=e[o];if(!i)return;const a=Ke(i,this.calculator.direction);if(this.calculator.getCharCountByScrollPos(a)===n)return{[o]:i}};return this.calculator.verticalMode?r("scrollX"):r("scrollY")}}function tn(t){return"scrollX"in t?{scrollToData:{left:t.scrollX},bookmarkPosData:{right:`${-t.scrollX}px`}}:{scrollToData:{top:t.scrollY},bookmarkPosData:{top:`${t.scrollY}px`}}}/**
 * @license BSD-3-Clause
 * Copyright (c) 2022, ッツ Reader Authors
 * All rights reserved.
 */function or(t){const e=(n,r,o,i)=>{if(o<r)return t!=null?t:o;const a=Math.floor((r+o)/2);return n[a]===i?a:n[a]>i?e(n,r,a-1,i):e(n,a+1,o,i)};return(n,r)=>e(n,0,n.length-1,r)}const Ct=or(void 0);/**
 * @license BSD-3-Clause
 * Copyright (c) 2022, ッツ Reader Authors
 * All rights reserved.
 */function Yt(t){return Array.from(t.classList).some(e=>e.includes("gaiji"))}/**
 * @license BSD-3-Clause
 * Copyright (c) 2022, ッツ Reader Authors
 * All rights reserved.
 */function Kt(t){return t instanceof HTMLImageElement?Yt(t):!1}/**
 * @license BSD-3-Clause
 * Copyright (c) 2022, ッツ Reader Authors
 * All rights reserved.
 */function In(t){return Kt(t)?1:ir(t)}const rr=/[^0-9A-Z○◯々-〇〻ぁ-ゖゝ-ゞァ-ヺー０-９Ａ-Ｚｦ-ﾝ\p{Radical}\p{Unified_Ideograph}]+/gimu;function ir(t){return t.textContent?ar(t.textContent.replace(rr,"")):0}function ar(t){return Array.from(t).length}/**
 * @license BSD-3-Clause
 * Copyright (c) 2022, ッツ Reader Authors
 * All rights reserved.
 */function An(t){return On(t,e=>!(e.nodeName==="RT"||e instanceof HTMLElement&&(e.attributes.getNamedItem("aria-hidden")||e.attributes.getNamedItem("hidden")))).filter(e=>{var n;return!!(Kt(e)||(n=e.textContent)!=null&&n.replace(/\s/g,"").length)})}function On(t,e){return!t.hasChildNodes()||!e(t)?[]:Array.from(t.childNodes).flatMap(n=>n.nodeType===Node.TEXT_NODE?[n]:Kt(n)?[n]:On(n,e)).filter(e)}/**
 * @license BSD-3-Clause
 * Copyright (c) 2022, ッツ Reader Authors
 * All rights reserved.
 */class Vn{constructor(e,n,r,o,i){this.containerEl=e,this.axis=n,this.direction=r,this.scrollEl=o,this.document=i,this.paragraphPosToAccCharCount=new Map,this.paragraphs=An(e),this.paragraphPos=Array(this.paragraphs.length),this.accumulatedCharCount=[];let a=0;this.paragraphs.forEach(l=>{a+=In(l),this.accumulatedCharCount.push(a)}),this.charCount=a}get verticalMode(){return this.axis==="vertical"}updateParagraphPos(e=0){const n=this.scrollEl.getBoundingClientRect(),r=Ke(this.verticalMode?n.right:n.top,this.direction),o=new Map;for(let i=0;i<this.paragraphs.length;i+=1){const a=this.paragraphs[i],l=this.getNodeBoundingRect(a),s=Ke(this.verticalMode?l.left:l.bottom,this.direction)-r+e;this.paragraphPos[i]=s;const h=o.get(s)||[];o.set(s,h),h.push(i)}this.paragraphPosToAccCharCount=new Map(Array.from(o.entries()).map(([i,a])=>[i,Math.max(...a.map(l=>this.accumulatedCharCount[l]))]))}calcExploredCharCount(){return this.getCharCountByScrollPos(this.scrollPos)}getCharCountByScrollPos(e){const n=Ct(this.paragraphPos,e);return this.paragraphPosToAccCharCount.get(this.paragraphPos[n])||0}getScrollPosByCharCount(e){const n=Ct(this.accumulatedCharCount,e);return Ke(this.paragraphPos[n],this.direction)}getNodeBoundingRect(e){const n=this.document.createRange();return n.selectNode(e),n.getBoundingClientRect()}get scrollPos(){return Ke(this.scrollEl[this.scrollPosProp],this.direction)}get scrollPosProp(){return this.verticalMode?"scrollLeft":"scrollTop"}}/**
 * @license BSD-3-Clause
 * Copyright (c) 2022, ッツ Reader Authors
 * All rights reserved.
 */function lr(t,e,n){const r=fr(e,n)(t,"scrollLeft");return(o,i,a)=>{if(!sr(o))return;const l=ur(o,i,a);r(-l),o.preventDefault()}}function sr(t){return!(!t.deltaY||t.deltaX||t.altKey||t.shiftKey||t.ctrlKey||t.metaKey)}function ur(t,e,n){switch(t.deltaMode){case 0:return t.deltaY;case 1:return t.deltaY*e*1.75;default:return t.deltaY*n}}function fr(t,e){return(n,r)=>{let o=!1,i=t[r],a=t[r];const l=()=>{o=!0;const f=Math.trunc((i-t[r])/n);if(t[r]!==a){o=!1;return}if(a+=f,t.scrollBy(f,0),Math.abs(f)>0){e(l);return}o=!1};return f=>{o||(i=t[r],a=t[r]),i+=f,o||e(l)}}}/**
 * @license BSD-3-Clause
 * Copyright (c) 2022, ッツ Reader Authors
 * All rights reserved.
 */class cr{constructor(e,n,r){this.verticalMode=e,this.firstDimensionMargin=n,this.window=r}nextPage(){this.scrollByPercent(.9)}prevPage(){this.scrollByPercent(-.9)}scrollTo(e){this.window.scrollTo({[this.verticalMode?"left":"top"]:e})}scrollByPercent(e){let n=this.window.innerHeight,r="top",o=1;this.verticalMode&&(n=this.window.innerWidth,r="left",o=-1);const i=n-this.firstDimensionMargin*2;this.window.scrollBy({[r]:i*e*o,behavior:"smooth"})}}/**
 * @license BSD-3-Clause
 * Copyright (c) 2022, ッツ Reader Authors
 * All rights reserved.
 */class hr{constructor(e,n,r,o,i=Ft){this.multiplier=e,this.verticalMode=n,this.enabled$=new Ht(!1),this.enabled$.pipe(kt(a=>{if(!a)return Xt;let l=0;return jo(0,i).pipe(me(()=>Date.now()),Zo(),me(f=>this.calcNewPos(f)),me(f=>{l+=f;const s=Math.trunc(l);return l-=s,s}),yt(f=>f!==0))}),Le(r)).subscribe(a=>{let l="top";n&&(l="left"),o.documentElement.scrollBy({[l]:a})})}toggle(){this.enabled$.next(!this.enabled$.getValue())}calcNewPos([e,n]){let r=.00365956;return this.verticalMode&&(r=-91489e-8),r*this.multiplier*(n-e)}}const{document:dr,window:mr}=pn;function nn(t){let e,n,r,o,i;return{c(){e=Z("div"),r=re(),o=Z("div"),this.h()},l(a){e=x(a,"DIV",{class:!0,style:!0}),$(e).forEach(D),r=ie(a),o=x(a,"DIV",{class:!0,style:!0}),$(o).forEach(D),this.h()},h(){Y(e,"class","fixed"),Y(e,"style",n=t[20]+": 100%; "+t[19]+": "+t[14]+"px; "+t[18][0]+": 0"),P(e,"background-color",t[4],!1),Y(o,"class","fixed"),Y(o,"style",i=t[20]+": 100%; "+t[19]+": "+t[14]+"px; "+t[18][1]+": 0"),P(o,"background-color",t[4],!1)},m(a,l){N(a,e,l),N(a,r,l),N(a,o,l)},p(a,l){l[0]&1851392&&n!==(n=a[20]+": 100%; "+a[19]+": "+a[14]+"px; "+a[18][0]+": 0")&&Y(e,"style",n),l[0]&16&&P(e,"background-color",a[4],!1),l[0]&1851392&&i!==(i=a[20]+": 100%; "+a[19]+": "+a[14]+"px; "+a[18][1]+": 0")&&Y(o,"style",i),l[0]&16&&P(o,"background-color",a[4],!1)},d(a){a&&D(e),a&&D(r),a&&D(o)}}}function on(t){let e;function n(i,a){return i[2]?kr:gr}let r=n(t),o=r(t);return{c(){o.c(),e=Qe()},l(i){o.l(i),e=Qe()},m(i,a){o.m(i,a),N(i,e,a)},p(i,a){r===(r=n(i))&&o?o.p(i,a):(o.d(1),o=r(i),o&&(o.c(),o.m(e.parentNode,e)))},d(i){o.d(i),i&&D(e)}}}function gr(t){let e;return{c(){e=Z("div"),this.h()},l(n){e=x(n,"DIV",{class:!0}),$(e).forEach(D),this.h()},h(){Y(e,"class","absolute inset-x-0 h-12 bg-yellow-600 bg-opacity-10 pointer-events-none"),P(e,"top",t[16].top,!1)},m(n,r){N(n,e,r)},p(n,r){r[0]&65536&&P(e,"top",n[16].top,!1)},d(n){n&&D(e)}}}function kr(t){let e;return{c(){e=Z("div"),this.h()},l(n){e=x(n,"DIV",{class:!0}),$(e).forEach(D),this.h()},h(){Y(e,"class","pointer-events-none absolute inset-y-0 w-12 bg-yellow-600 bg-opacity-10"),P(e,"right",t[16].right,!1)},m(n,r){N(n,e,r)},p(n,r){r[0]&65536&&P(e,"right",n[16].right,!1)},d(n){n&&D(e)}}}function pr(t){let e,n,r=`${t[7]}px`,o=`${t[17]||t[1]}px`,i,a,l,f,s,h;n=new Tn({props:{html:t[0]}}),n.$on("load",t[23]);let k=t[14]&&nn(t),p=t[16]&&on(t);return{c(){e=Z("div"),_e(n.$$.fragment),i=re(),k&&k.c(),a=re(),p&&p.c(),l=re(),this.h()},l(u){e=x(u,"DIV",{class:!0});var d=$(e);we(n.$$.fragment,d),d.forEach(D),i=ie(u),k&&k.l(u),a=ie(u),p&&p.l(u),l=ie(u),this.h()},h(){Y(e,"class","book-content m-auto svelte-19jjpx4"),j(e,"book-content--writing-vertical-rl",t[2]),j(e,"book-content--writing-horizontal-rl",!t[2]),j(e,"book-content--hide-furigana",t[11]),j(e,"book-content--hide-spoiler-image",t[10]),j(e,"book-content--furigana-style-partial",t[12]===Ce.Partial),j(e,"book-content--furigana-style-full",t[12]===Ce.Full),j(e,"book-content--furigana-style-toggle",t[12]===Ce.Toggle),P(e,"color",t[3],!1),P(e,"font-size",r,!1),P(e,"max-width",!t[2]&&t[13]?`${t[13]}px`:void 0,!1),P(e,"max-height",t[17]?`${t[17]}px`:void 0,!1),P(e,"padding-left",t[2]&&t[14]?`${t[14]}px`:void 0,!1),P(e,"padding-right",t[2]&&t[14]?`${t[14]}px`:void 0,!1),P(e,"padding-top",!t[2]&&t[14]?`${t[14]}px`:void 0,!1),P(e,"padding-bottom",!t[2]&&t[14]?`${t[14]}px`:void 0,!1),P(e,"--font-family-serif",t[8],!1),P(e,"--font-family-sans-serif",t[9],!1),P(e,"--book-content-hint-furigana-font-color",t[5],!1),P(e,"--book-content-hint-furigana-shadow-color",t[6],!1),P(e,"--book-content-child-height",o,!1)},m(u,d){N(u,e,d),Se(n,e,null),t[39](e),N(u,i,d),k&&k.m(u,d),N(u,a,d),p&&p.m(u,d),N(u,l,d),f=!0,s||(h=[Ee(mr,"scroll",t[22]),Ee(dr.body,"wheel",t[21],{passive:!1})],s=!0)},p(u,d){const y={};d[0]&1&&(y.html=u[0]),n.$set(y),d[0]&4&&j(e,"book-content--writing-vertical-rl",u[2]),d[0]&4&&j(e,"book-content--writing-horizontal-rl",!u[2]),d[0]&2048&&j(e,"book-content--hide-furigana",u[11]),d[0]&1024&&j(e,"book-content--hide-spoiler-image",u[10]),d[0]&4096&&j(e,"book-content--furigana-style-partial",u[12]===Ce.Partial),d[0]&4096&&j(e,"book-content--furigana-style-full",u[12]===Ce.Full),d[0]&4096&&j(e,"book-content--furigana-style-toggle",u[12]===Ce.Toggle),d[0]&8&&P(e,"color",u[3],!1),d[0]&128&&r!==(r=`${u[7]}px`)&&P(e,"font-size",r,!1),d[0]&8196&&P(e,"max-width",!u[2]&&u[13]?`${u[13]}px`:void 0,!1),d[0]&131072&&P(e,"max-height",u[17]?`${u[17]}px`:void 0,!1),d[0]&16388&&P(e,"padding-left",u[2]&&u[14]?`${u[14]}px`:void 0,!1),d[0]&16388&&P(e,"padding-right",u[2]&&u[14]?`${u[14]}px`:void 0,!1),d[0]&16388&&P(e,"padding-top",!u[2]&&u[14]?`${u[14]}px`:void 0,!1),d[0]&16388&&P(e,"padding-bottom",!u[2]&&u[14]?`${u[14]}px`:void 0,!1),d[0]&256&&P(e,"--font-family-serif",u[8],!1),d[0]&512&&P(e,"--font-family-sans-serif",u[9],!1),d[0]&32&&P(e,"--book-content-hint-furigana-font-color",u[5],!1),d[0]&64&&P(e,"--book-content-hint-furigana-shadow-color",u[6],!1),d[0]&131074&&o!==(o=`${u[17]||u[1]}px`)&&P(e,"--book-content-child-height",o,!1),u[14]?k?k.p(u,d):(k=nn(u),k.c(),k.m(a.parentNode,a)):k&&(k.d(1),k=null),u[16]?p?p.p(u,d):(p=on(u),p.c(),p.m(l.parentNode,l)):p&&(p.d(1),p=null)},i(u){f||(K(n.$$.fragment,u),f=!0)},o(u){J(n.$$.fragment,u),f=!1},d(u){u&&D(e),ve(n),t[39](null),u&&D(i),k&&k.d(u),u&&D(a),p&&p.d(u),u&&D(l),s=!1,vt(h)}}}function br(t,e,n){let r,o,i,a,{htmlContent:l}=e,{width:f}=e,{height:s}=e,{verticalMode:h}=e,{fontColor:k}=e,{backgroundColor:p}=e,{hintFuriganaFontColor:u}=e,{hintFuriganaShadowColor:d}=e,{fontSize:y}=e,{fontFamilyGroupOne:b}=e,{fontFamilyGroupTwo:C}=e,{hideSpoilerImage:V}=e,{hideFurigana:c}=e,{furiganaStyle:M}=e,{secondDimensionMaxValue:S}=e,{firstDimensionMargin:A}=e,{autoPositionOnResize:O}=e,{loadingState:G}=e,{multiplier:F}=e,{bookmarkData:z}=e,{exploredCharCount:U}=e,{bookCharCount:H}=e,{autoScroller:g}=e,{bookmarkManager:B}=e,{pageManager:I}=e;const q=St();let L,X,ae={},te,w,T,fe,R,le=0,Q=!1;const de=lr(4,document.documentElement,requestAnimationFrame),pe=new Pe,be=new Pe,he=new Pe;qt(()=>{he.next(),he.complete()}),te=new hr(F,h,he,document),g=te,rt([pe,be]).pipe(yt(()=>O),Cn(1),me(([E,ye])=>h?ye:E),Bn(),En(10),_n(Ft),Le(he)).subscribe(()=>{if(!X||!T)return;const E=X.getScrollPosByCharCount(le);Q=!0,T.scrollTo(E)});function Me(E){E.updateParagraphPos(),n(24,U=E.calcExploredCharCount()),R&&(R=!1,z.then(ye=>{!ye||!B||B.scrollToBookmark(ye)})),n(35,ae={})}function ce(E){h&&de(E,y,window.innerWidth)}function Fe(){requestAnimationFrame(()=>{!X||(n(24,U=X.calcExploredCharCount()),Q||(le=U),Q=!1)})}function Ae(){!L||(n(34,X=new Vn(L,h?"vertical":"horizontal",h?"rtl":"ltr",document.documentElement,document)),n(24,U=0),le=U,n(25,H=X.charCount),q("contentChange",L))}function De(E){ee[E?"unshift":"push"](()=>{L=E,n(15,L)})}return t.$$set=E=>{"htmlContent"in E&&n(0,l=E.htmlContent),"width"in E&&n(29,f=E.width),"height"in E&&n(1,s=E.height),"verticalMode"in E&&n(2,h=E.verticalMode),"fontColor"in E&&n(3,k=E.fontColor),"backgroundColor"in E&&n(4,p=E.backgroundColor),"hintFuriganaFontColor"in E&&n(5,u=E.hintFuriganaFontColor),"hintFuriganaShadowColor"in E&&n(6,d=E.hintFuriganaShadowColor),"fontSize"in E&&n(7,y=E.fontSize),"fontFamilyGroupOne"in E&&n(8,b=E.fontFamilyGroupOne),"fontFamilyGroupTwo"in E&&n(9,C=E.fontFamilyGroupTwo),"hideSpoilerImage"in E&&n(10,V=E.hideSpoilerImage),"hideFurigana"in E&&n(11,c=E.hideFurigana),"furiganaStyle"in E&&n(12,M=E.furiganaStyle),"secondDimensionMaxValue"in E&&n(13,S=E.secondDimensionMaxValue),"firstDimensionMargin"in E&&n(14,A=E.firstDimensionMargin),"autoPositionOnResize"in E&&n(30,O=E.autoPositionOnResize),"loadingState"in E&&n(31,G=E.loadingState),"multiplier"in E&&n(32,F=E.multiplier),"bookmarkData"in E&&n(33,z=E.bookmarkData),"exploredCharCount"in E&&n(24,U=E.exploredCharCount),"bookCharCount"in E&&n(25,H=E.bookCharCount),"autoScroller"in E&&n(26,g=E.autoScroller),"bookmarkManager"in E&&n(27,B=E.bookmarkManager),"pageManager"in E&&n(28,I=E.pageManager)},t.$$.update=()=>{if(t.$$.dirty[0]&4&&n(20,r=h?"height":"width"),t.$$.dirty[0]&4&&n(19,o=h?"width":"height"),t.$$.dirty[0]&4&&n(18,i=h?["left","right"]:["top","bottom"]),t.$$.dirty[0]&536870912&&pe.next(f),t.$$.dirty[0]&2&&be.next(s),t.$$.dirty[0]&8196&&n(17,a=h&&S?S:void 0),t.$$.dirty[0]&1&&l&&(R=!0),t.$$.dirty[0]&536870914|t.$$.dirty[1]&9&&X&&f&&s&&!G){const E=X;requestAnimationFrame(()=>{Me(E)})}t.$$.dirty[0]&4|t.$$.dirty[1]&34&&te&&(n(36,te.multiplier=F,te),n(36,te.verticalMode=h,te)),t.$$.dirty[1]&72&&X&&(n(37,w=X&&new nr(X,window)),n(27,B=w)),t.$$.dirty[1]&84&&ae&&(n(16,fe=void 0),z.then(E=>{!E||n(16,fe=w==null?void 0:w.getBookmarkBarPosition(E))})),t.$$.dirty[0]&16388|t.$$.dirty[1]&128&&(n(38,T=new cr(h,A,window)),n(28,I=T))},[l,s,h,k,p,u,d,y,b,C,V,c,M,S,A,L,fe,a,i,o,r,ce,Fe,Ae,U,H,g,B,I,f,O,G,F,z,X,ae,te,w,T,De]}class Cr extends qe{constructor(e){super();Xe(this,e,br,pr,We,{htmlContent:0,width:29,height:1,verticalMode:2,fontColor:3,backgroundColor:4,hintFuriganaFontColor:5,hintFuriganaShadowColor:6,fontSize:7,fontFamilyGroupOne:8,fontFamilyGroupTwo:9,hideSpoilerImage:10,hideFurigana:11,furiganaStyle:12,secondDimensionMaxValue:13,firstDimensionMargin:14,autoPositionOnResize:30,loadingState:31,multiplier:32,bookmarkData:33,exploredCharCount:24,bookCharCount:25,autoScroller:26,bookmarkManager:27,pageManager:28},null,[-1,-1])}}/**
 * @license BSD-3-Clause
 * Copyright (c) 2022, ッツ Reader Authors
 * All rights reserved.
 */const _r="px-4 md:px-8";/**
 * @license BSD-3-Clause
 * Copyright (c) 2022, ッツ Reader Authors
 * All rights reserved.
 */function _t(t,e=yn){return e?t():Pn}/**
 * @license BSD-3-Clause
 * Copyright (c) 2022, ッツ Reader Authors
 * All rights reserved.
 */function wr(t){const e=Array.from(t.getElementsByTagName("img"));return new Ie(n=>{const r=e.filter(i=>i.src).map(Sr);if(r.length<=0){n.next(!1),n.complete();return}const o=rt(r).subscribe(()=>{n.next(!1),n.complete()});return n.next(!0),o})}function Sr(t){return t.complete?vn(1):Uo(He(t,"load"),He(t,"error"))}/**
 * @license BSD-3-Clause
 * Copyright (c) 2022, ッツ Reader Authors
 * All rights reserved.
 */function vr(t,e){const n=yr(t),r=Fr(t);return o=>Pt(n(o),Mr(o,e),r(o))}function yr(t){return e=>{const n=Array.from(e.getElementsByTagName("a"));n.forEach(o=>{o.href=t.location.pathname+o.hash});const r=n.map(o=>wt(o).pipe(Ve(()=>{const i=t.getElementById(o.hash.substring(1));i&&i.scrollIntoView()})));return Pt(...r)}}function Mr(t,e){const n=e===Ce.Toggle,o=Array.from(t.getElementsByTagName("ruby")).map(i=>n?wt(i).pipe(Ve(()=>{i.classList.toggle("reveal-rt")})):wt(i).pipe(Wt(1),Ve(()=>{i.classList.add("reveal-rt")})));return Pt(...o)}function Fr(t){return e=>{const r=Array.from(e.querySelectorAll("[data-ttu-spoiler-img]")).map(o=>{const i=t.createElement("span");return i.classList.add("spoiler-label"),i.setAttribute("aria-hidden","true"),i.innerText="\u30CD\u30BF\u30D0\u30EC",o.appendChild(i),wt(o).pipe(Wt(1),Ve(()=>{o.removeChild(i),o.removeAttribute("data-ttu-spoiler-img")}))});return Pt(...r)}}function wt(t){return He(t,"click").pipe(Ve(e=>{e.preventDefault(),e.stopImmediatePropagation()}))}const Pr=300,Er=60,zn="none";function et(t,e,n){return t.addEventListener(e,n),()=>t.removeEventListener(e,n)}function Br(t,e){return e.filter(n=>t.pointerId!==n.pointerId)}function st(t,e,n,r,o){t.dispatchEvent(new CustomEvent(`${e}${o}`,{detail:{event:n,pointersCount:r.length}}))}function Dr(t,e,n,r,o,i=zn){e.style.touchAction=i;let a=[];function l(s){a.push(s),st(e,t,s,a,"down"),r==null||r(a,s);const h=s.pointerId;function k(C){h===C.pointerId&&(a=Br(C,a),a.length||p(),st(e,t,C,a,"up"),o==null||o(a,C))}function p(){u(),d(),y(),b()}const u=et(e,"pointermove",C=>{a=a.map(V=>C.pointerId===V.pointerId?C:V),st(e,t,C,a,"move"),n==null||n(a,C)}),d=et(e,"lostpointercapture",C=>{k(C)}),y=et(e,"pointerup",C=>{k(C)}),b=et(e,"pointerleave",C=>{a=[],p(),st(e,t,C,a,"up"),o==null||o(a,C)})}const f=et(e,"pointerdown",l);return{destroy:()=>{f()}}}function Tr(t,e={timeframe:Pr,minSwipeDistance:Er,touchAction:zn}){const n="swipe";let r,o,i,a;function l(s,h){o=h.clientX,i=h.clientY,r=Date.now(),s.length===1&&(a=h.target)}function f(s,h){if(h.type==="pointerup"&&s.length===0&&Date.now()-r<e.timeframe){const k=h.clientX-o,p=h.clientY-i,u=Math.abs(k),d=Math.abs(p);let y=null;u>=2*d&&u>e.minSwipeDistance?y=k>0?"right":"left":d>=2*u&&d>e.minSwipeDistance&&(y=p>0?"bottom":"top"),y&&t.dispatchEvent(new CustomEvent(n,{detail:{direction:y,target:a}}))}}return Dr(n,t,null,l,f,e.touchAction)}/**
 * @license BSD-3-Clause
 * Copyright (c) 2022, ッツ Reader Authors
 * All rights reserved.
 */class Ir{constructor(e,n,r,o,i,a,l,f,s,h,k){this.contentEl=e,this.scrollEl=n,this.sections=r,this.sectionIndex$=o,this.virtualScrollPos$=i,this.width=a,this.height=l,this.pageGap=f,this.verticalMode=s,this.pageChange$=h,this.sectionRenderComplete$=k,this.translateX=0}nextPage(){this.flipPage(1)}prevPage(){this.flipPage(-1)}flipPage(e){const n=this.verticalMode?"scrollHeight":"scrollWidth",r=this.verticalMode?this.height:this.width,o=r+this.pageGap,i=!0;if(this.translateX){const k=()=>{this.contentEl.style.removeProperty("transform"),this.translateX=0};if(e<0){const p=this.translateX;k(),this.scrollToPos(-p-o,i);return}if(this.nextSection(i)){k();return}return}const a=0,l=this.scrollEl[n],f=this.virtualScrollPos$.getValue(),s=f+o*e,h=Math.ceil(s);if(h<a){if(f!==a){this.scrollToPos(a,i);return}this.prevSection(o,n,r,i);return}if(h>=l){this.nextSection(i);return}this.scrollOrTranslateToPos(s,l,r,i)}scrollTo(e,n){const r=this.verticalMode?"scrollHeight":"scrollWidth",o=this.verticalMode?this.height:this.width;this.scrollOrTranslateToPos(e,this.scrollEl[r],o,n)}prevSection(e,n,r,o){const i=this.sectionIndex$.getValue()-1;return i<0?!1:(this.updateSectionIndex(i).subscribe(()=>{const a=this.scrollEl[n];let l=e*(Math.ceil(a/e)-1);Math.ceil(l)>=a&&(l-=e),this.scrollOrTranslateToPos(l,a,r,o)}),!0)}nextSection(e){const n=this.sectionIndex$.getValue()+1;return n>=this.sections.length?!1:(this.updateSectionIndex(n).subscribe(()=>{this.scrollToPos(0,e)}),!0)}scrollOrTranslateToPos(e,n,r,o){if(this.verticalMode){this.scrollToPos(e,o);return}if(e+r<=n){this.scrollToPos(e,o);return}this.translateXToPos(-e,o)}scrollToPos(e,n){this.virtualScrollPos$.next(e),this.scrollEl.scrollTo({[this.verticalMode?"top":"left"]:e}),this.pageChange$.next(n)}translateXToPos(e,n){this.virtualScrollPos$.next(-e),this.contentEl.style.transform=`translateX(${e}px)`,this.translateX=e,this.pageChange$.next(n)}updateSectionIndex(e){return new Ie(n=>{if(this.sectionIndex$.getValue()===e){n.next(),n.complete();return}const r=this.sectionRenderComplete$.subscribe(o=>{o===e&&n.next(),n.complete(),r.unsubscribe()});return this.sectionIndex$.next(e),r})}}/**
 * @license BSD-3-Clause
 * Copyright (c) 2022, ッツ Reader Authors
 * All rights reserved.
 */class Ar{constructor(e,n,r,o,i,a,l,f,s){this.containerEl=e,this.sections=n,this.virtualScrollPos$=r,this.getWidth=o,this.getHeight=i,this.getPageGap=a,this.verticalMode=l,this.scrollEl=f,this.document=s,this.sectionIndex=-1;const h=p=>An(p).reduce((d,y)=>d+In(y),0);let k=0;this.sectionAccCharCounts=n.map(p=>(k+=h(p),k)),this.charCount=k}updateCurrentSection(e){this.calculator=new Vn(this.containerEl,this.verticalMode?"horizontal":"vertical","ltr",this.scrollEl,this.document),this.sectionIndex=e}updateParagraphPos(){!this.calculator||this.calculator.updateParagraphPos(this.virtualScrollPos$.getValue())}calcExploredCharCount(){const e=this.verticalMode?0:-this.screenSize;return this.getCharCountByScrollPos(this.virtualScrollPos$.getValue()+e)}getCharCountByScrollPos(e){if(!this.calculator)return-1;const n=this.getSectionStartCount();return this.calculator.getCharCountByScrollPos(e)+n}getSectionIndexByCharCount(e){return Ct(this.sectionAccCharCounts,e)+1}getScrollPosByCharCount(e){if(!this.calculator)return-1;const n=this.getSectionStartCount(),r=this.sectionAccCharCounts[this.sectionIndex],o=e-n,i=e===r&&r-n>0;if(o<0||e>r||i)return-1;if(o===0)return 0;const a=Ct(this.calculator.accumulatedCharCount,o),{accumulatedCharCount:l,paragraphPos:f}=this.calculator,s=l[a];if(Number.isNaN(Number(f[a])))return-1;const h=(y,b)=>y>=b?b:l[y]>s?y:h(y+1,b),k=f[h(a+1,l.length-1)],{screenSize:p}=this,u=this.verticalMode?-1:0,d=p*(Math.ceil(k/p)+u);return Ke(d,this.calculator.direction)}isCharOnScreen(e){const n=this.getScrollPosByCharCount(e),r=this.virtualScrollPos$.getValue();return n===r}getSectionStartCount(){return this.sectionAccCharCounts[this.sectionIndex-1]||0}get screenSize(){return(this.verticalMode?this.getHeight():this.getWidth())+this.getPageGap()}}/**
 * @license BSD-3-Clause
 * Copyright (c) 2022, ッツ Reader Authors
 * All rights reserved.
 */class Or{constructor(e,n,r,o,i){this.calculator=e,this.pageManager=n,this.sectionReady$=r,this.sectionIndex$=o,this.setIntendedCharCount=i}scrollToBookmark(e){const n=e.exploredCharCount;if(!n)return;const r=this.calculator.getSectionIndexByCharCount(n),o=l=>{const f=l.getScrollPosByCharCount(n);this.pageManager.scrollTo(f,!1),this.setIntendedCharCount(n)};if(this.sectionIndex$.getValue()===r){o(this.calculator);return}const a=this.sectionReady$.subscribe(l=>{o(l),a.unsubscribe()});this.sectionIndex$.next(r)}formatBookmarkData(e){const n=this.calculator.calcExploredCharCount(),r=this.calculator.charCount;return{dataId:e,exploredCharCount:n,progress:n/r}}}function rn(t){let e,n,r;return n=new Je({props:{icon:Kn,spin:!0}}),{c(){e=Z("div"),_e(n.$$.fragment),this.h()},l(o){e=x(o,"DIV",{class:!0});var i=$(e);we(n.$$.fragment,i),i.forEach(D),this.h()},h(){Y(e,"class","fixed inset-0 flex h-full w-full items-center justify-center text-7xl"),P(e,"color",t[4],!1),P(e,"background-color",t[5],!1)},m(o,i){N(o,e,i),Se(n,e,null),r=!0},p(o,i){i[0]&16&&P(e,"color",o[4],!1),i[0]&32&&P(e,"background-color",o[5],!1)},i(o){r||(K(n.$$.fragment,o),r=!0)},o(o){J(n.$$.fragment,o),r=!1},d(o){o&&D(e),ve(n)}}}function an(t){let e,n,r;return n=new Je({props:{icon:Rt}}),{c(){e=Z("div"),_e(n.$$.fragment),this.h()},l(o){e=x(o,"DIV",{class:!0});var i=$(e);we(n.$$.fragment,i),i.forEach(D),this.h()},h(){Y(e,"class","fixed top-3 right-3 text-xl opacity-25"),P(e,"color",t[4],!1)},m(o,i){N(o,e,i),Se(n,e,null),r=!0},p(o,i){i[0]&16&&P(e,"color",o[4],!1)},i(o){r||(K(n.$$.fragment,o),r=!0)},o(o){J(n.$$.fragment,o),r=!1},d(o){o&&D(e),ve(n)}}}function Vr(t){let e,n,r,o=`${t[8]}px`,i=`${t[1]}px`,a=`${t[2]}px`,l=`${t[3]?t[1]:(t[1]+Ue)/t[20]-Ue}px`,f,s,h,k,p,u;r=new Tn({props:{html:t[19]}}),r.$on("load",t[21]);let d=!t[18]&&rn(t),y=t[0]&&an(t);return{c(){e=Z("div"),n=Z("div"),_e(r.$$.fragment),f=re(),d&&d.c(),s=re(),y&&y.c(),h=Qe(),this.h()},l(b){e=x(b,"DIV",{class:!0});var C=$(e);n=x(C,"DIV",{class:!0});var V=$(n);we(r.$$.fragment,V),V.forEach(D),C.forEach(D),f=ie(b),d&&d.l(b),s=ie(b),y&&y.l(b),h=Qe(),this.h()},h(){Y(n,"class","book-content-container svelte-1h8k4zr"),Y(e,"class","book-content m-auto svelte-1h8k4zr"),j(e,"book-content--avoid-page-break",t[14]),j(e,"book-content--writing-vertical-rl",t[3]),j(e,"book-content--writing-horizontal-rl",!t[3]),j(e,"book-content--hide-furigana",t[12]),j(e,"book-content--hide-spoiler-image",t[11]),j(e,"book-content--furigana-style-partial",t[13]===Ce.Partial),j(e,"book-content--furigana-style-full",t[13]===Ce.Full),j(e,"book-content--furigana-style-toggle",t[13]===Ce.Toggle),P(e,"color",t[4],!1),P(e,"font-size",o,!1),P(e,"padding-top",!t[3]&&t[15]?`${t[15]}px`:void 0,!1),P(e,"padding-bottom",!t[3]&&t[15]?`${t[15]}px`:void 0,!1),P(e,"padding-left",t[3]&&t[15]?`${t[15]}px`:void 0,!1),P(e,"padding-right",t[3]&&t[15]?`${t[15]}px`:void 0,!1),P(e,"max-width",t[1]?`${t[1]}px`:void 0,!1),P(e,"max-height",t[3]&&t[2]?`${t[2]}px`:void 0,!1),P(e,"--font-family-serif",t[9],!1),P(e,"--font-family-sans-serif",t[10],!1),P(e,"--book-content-hint-furigana-font-color",t[6],!1),P(e,"--book-content-hint-furigana-shadow-color",t[7],!1),P(e,"--book-content-child-width",i,!1),P(e,"--book-content-child-height",a,!1),P(e,"--book-content-column-count",t[20],!1),P(e,"--book-content-image-max-width",l,!1)},m(b,C){N(b,e,C),oe(e,n),Se(r,n,null),t[35](n),t[36](e),N(b,f,C),d&&d.m(b,C),N(b,s,C),y&&y.m(b,C),N(b,h,C),k=!0,p||(u=[bn(Tr.call(null,e,{timeframe:500,minSwipeDistance:10,touchAction:"pan-y"})),Ee(e,"swipe",t[22])],p=!0)},p(b,C){const V={};C[0]&524288&&(V.html=b[19]),r.$set(V),C[0]&16384&&j(e,"book-content--avoid-page-break",b[14]),C[0]&8&&j(e,"book-content--writing-vertical-rl",b[3]),C[0]&8&&j(e,"book-content--writing-horizontal-rl",!b[3]),C[0]&4096&&j(e,"book-content--hide-furigana",b[12]),C[0]&2048&&j(e,"book-content--hide-spoiler-image",b[11]),C[0]&8192&&j(e,"book-content--furigana-style-partial",b[13]===Ce.Partial),C[0]&8192&&j(e,"book-content--furigana-style-full",b[13]===Ce.Full),C[0]&8192&&j(e,"book-content--furigana-style-toggle",b[13]===Ce.Toggle),C[0]&16&&P(e,"color",b[4],!1),C[0]&256&&o!==(o=`${b[8]}px`)&&P(e,"font-size",o,!1),C[0]&32776&&P(e,"padding-top",!b[3]&&b[15]?`${b[15]}px`:void 0,!1),C[0]&32776&&P(e,"padding-bottom",!b[3]&&b[15]?`${b[15]}px`:void 0,!1),C[0]&32776&&P(e,"padding-left",b[3]&&b[15]?`${b[15]}px`:void 0,!1),C[0]&32776&&P(e,"padding-right",b[3]&&b[15]?`${b[15]}px`:void 0,!1),C[0]&2&&P(e,"max-width",b[1]?`${b[1]}px`:void 0,!1),C[0]&12&&P(e,"max-height",b[3]&&b[2]?`${b[2]}px`:void 0,!1),C[0]&512&&P(e,"--font-family-serif",b[9],!1),C[0]&1024&&P(e,"--font-family-sans-serif",b[10],!1),C[0]&64&&P(e,"--book-content-hint-furigana-font-color",b[6],!1),C[0]&128&&P(e,"--book-content-hint-furigana-shadow-color",b[7],!1),C[0]&2&&i!==(i=`${b[1]}px`)&&P(e,"--book-content-child-width",i,!1),C[0]&4&&a!==(a=`${b[2]}px`)&&P(e,"--book-content-child-height",a,!1),C[0]&1048576&&P(e,"--book-content-column-count",b[20],!1),C[0]&1048586&&l!==(l=`${b[3]?b[1]:(b[1]+Ue)/b[20]-Ue}px`)&&P(e,"--book-content-image-max-width",l,!1),b[18]?d&&(Ze(),J(d,1,1,()=>{d=null}),xe()):d?(d.p(b,C),C[0]&262144&&K(d,1)):(d=rn(b),d.c(),K(d,1),d.m(s.parentNode,s)),b[0]?y?(y.p(b,C),C[0]&1&&K(y,1)):(y=an(b),y.c(),K(y,1),y.m(h.parentNode,h)):y&&(Ze(),J(y,1,1,()=>{y=null}),xe())},i(b){k||(K(r.$$.fragment,b),K(d),K(y),k=!0)},o(b){J(r.$$.fragment,b),J(d),J(y),k=!1},d(b){b&&D(e),ve(r),t[35](null),t[36](null),b&&D(f),d&&d.d(b),b&&D(s),y&&y.d(b),b&&D(h),p=!1,vt(u)}}}const ln="overflow-hidden",Ue=20;function zr(t,e,n){let r,{htmlContent:o}=e,{width:i}=e,{height:a}=e,{verticalMode:l}=e,{fontColor:f}=e,{backgroundColor:s}=e,{hintFuriganaFontColor:h}=e,{hintFuriganaShadowColor:k}=e,{fontSize:p}=e,{fontFamilyGroupOne:u}=e,{fontFamilyGroupTwo:d}=e,{hideSpoilerImage:y}=e,{hideFurigana:b}=e,{furiganaStyle:C}=e,{loadingState:V}=e,{bookmarkData:c}=e,{pageManager:M}=e,{bookmarkManager:S}=e,{exploredCharCount:A}=e,{bookCharCount:O}=e,{isBookmarkScreen:G=!1}=e,{avoidPageBreak:F=!0}=e,{pageColumns:z}=e,{firstDimensionMargin:U}=e;const H=St();let g,B,I,q=[],L,X,ae,te=!1,w="",T=!0,fe=0;const R=new Pe,le=new Pe,Q=new Ht(-1),de=new Pe,pe=new Ht(0),be=new Pe,he=new Pe,Me=Q.pipe(me(v=>{var ne;return((ne=q[v])==null?void 0:ne.innerHTML)||""})),ce=new Pe;qt(()=>{document.body.classList.remove(ln),ce.next(),ce.complete()}),rt([R,le]).pipe(Cn(1),kt(()=>he.pipe(Wt(1))),Le(ce)).subscribe(()=>{if(!I||!L)return;const v=I.getScrollPosByCharCount(fe);v<0||L.scrollTo(v,!1)}),de.pipe(Le(ce)).subscribe(v=>{!I||(n(25,A=I.calcExploredCharCount()),v&&(fe=A),c.then(De))}),Me.pipe(Bn(),Le(ce)).subscribe(()=>{n(18,te=!1)}),Me.pipe(Le(ce)).subscribe(v=>{const ne=(Oe,je)=>{if(je===0){Oe();return}requestAnimationFrame(()=>ne(Oe,je-1))};ne(()=>{n(19,w=v)},2)}),_t(()=>He(document.body,"wheel",{passive:!0})).pipe($o(50),Le(ce)).subscribe(v=>{let ne=(v.deltaX<0?-1:1)*(l?-1:1);v.deltaX||(ne=v.deltaY<0?-1:1),L==null||L.flipPage(ne)});function Fe(){if(T){T=!1;return}!g||(n(31,I=new Ar(g,q,pe,()=>i,()=>a,()=>Ue,l,g,document)),n(25,A=0),fe=0,n(26,O=I.charCount),I.updateCurrentSection(Q.getValue()),H("contentChange",g))}function Ae(v){v.updateParagraphPos(),n(25,A=v.calcExploredCharCount()),he.next(v),c.then(De),ae&&(ae=!1,c.then(ne=>{!ne||!S||S.scrollToBookmark(ne)})),n(18,te=!0)}function De(v){const ne=v==null?void 0:v.exploredCharCount;!I||!ne||n(0,G=I.isCharOnScreen(ne))}function E(v){if(!L||v.detail.direction!=="left"&&v.detail.direction!=="right")return;const ne=v.detail.direction==="left",Oe=l?!ne:ne;L.flipPage(Oe?1:-1)}function ye(v){ee[v?"unshift":"push"](()=>{B=v,n(17,B)})}function ze(v){ee[v?"unshift":"push"](()=>{g=v,n(16,g)})}return t.$$set=v=>{"htmlContent"in v&&n(27,o=v.htmlContent),"width"in v&&n(1,i=v.width),"height"in v&&n(2,a=v.height),"verticalMode"in v&&n(3,l=v.verticalMode),"fontColor"in v&&n(4,f=v.fontColor),"backgroundColor"in v&&n(5,s=v.backgroundColor),"hintFuriganaFontColor"in v&&n(6,h=v.hintFuriganaFontColor),"hintFuriganaShadowColor"in v&&n(7,k=v.hintFuriganaShadowColor),"fontSize"in v&&n(8,p=v.fontSize),"fontFamilyGroupOne"in v&&n(9,u=v.fontFamilyGroupOne),"fontFamilyGroupTwo"in v&&n(10,d=v.fontFamilyGroupTwo),"hideSpoilerImage"in v&&n(11,y=v.hideSpoilerImage),"hideFurigana"in v&&n(12,b=v.hideFurigana),"furiganaStyle"in v&&n(13,C=v.furiganaStyle),"loadingState"in v&&n(28,V=v.loadingState),"bookmarkData"in v&&n(29,c=v.bookmarkData),"pageManager"in v&&n(23,M=v.pageManager),"bookmarkManager"in v&&n(24,S=v.bookmarkManager),"exploredCharCount"in v&&n(25,A=v.exploredCharCount),"bookCharCount"in v&&n(26,O=v.bookCharCount),"isBookmarkScreen"in v&&n(0,G=v.isBookmarkScreen),"avoidPageBreak"in v&&n(14,F=v.avoidPageBreak),"pageColumns"in v&&n(30,z=v.pageColumns),"firstDimensionMargin"in v&&n(15,U=v.firstDimensionMargin)},t.$$.update=()=>{if(t.$$.dirty[0]&536870912&&c.then(De),t.$$.dirty[0]&2&&i&&R.next(i),t.$$.dirty[0]&4&&a&&le.next(a),t.$$.dirty[0]&1073741834&&n(20,r=l?1:z||Math.ceil(i/1e3)),t.$$.dirty[0]&134217728&&o&&(ae=!0),t.$$.dirty[0]&134217728){const v=document.createElement("div");v.innerHTML=o,n(32,q=Array.from(v.children)),Q.next(0)}if(t.$$.dirty[0]&196622|t.$$.dirty[1]&6&&B&&g&&q&&(n(33,L=new Ir(B,g,q,Q,pe,i,a,Ue,l,de,be)),n(23,M=L)),t.$$.dirty[0]&268435462|t.$$.dirty[1]&1&&I&&i&&a&&!V){const v=I;requestAnimationFrame(()=>{Ae(v)})}t.$$.dirty[0]&268435456|t.$$.dirty[1]&1&&I&&!V&&be.next(Q.getValue()),t.$$.dirty[1]&13&&I&&L&&(n(34,X=new Or(I,L,he,Q,v=>fe=v)),n(24,S=X))},document.body.classList.add(ln),[G,i,a,l,f,s,h,k,p,u,d,y,b,C,F,U,g,B,te,w,r,Fe,E,M,S,A,O,o,V,c,z,I,q,L,X,ye,ze]}class Rr extends qe{constructor(e){super();Xe(this,e,zr,Vr,We,{htmlContent:27,width:1,height:2,verticalMode:3,fontColor:4,backgroundColor:5,hintFuriganaFontColor:6,hintFuriganaShadowColor:7,fontSize:8,fontFamilyGroupOne:9,fontFamilyGroupTwo:10,hideSpoilerImage:11,hideFurigana:12,furiganaStyle:13,loadingState:28,bookmarkData:29,pageManager:23,bookmarkManager:24,exploredCharCount:25,bookCharCount:26,isBookmarkScreen:0,avoidPageBreak:14,pageColumns:30,firstDimensionMargin:15},null,[-1,-1])}}function Lr(t){var b,C,V;let e,n,r,o,i,a,l,f;function s(c){t[46](c)}function h(c){t[47](c)}function k(c){t[48](c)}function p(c){t[49](c)}function u(c){t[50](c)}function d(c){t[51](c)}let y={htmlContent:t[7],width:(b=t[27])!=null?b:0,height:(C=t[28])!=null?C:0,verticalMode:t[8],fontColor:t[9],backgroundColor:t[10],hintFuriganaFontColor:t[11],hintFuriganaShadowColor:t[12],fontSize:t[13],fontFamilyGroupOne:t[14],fontFamilyGroupTwo:t[15],hideSpoilerImage:t[16],hideFurigana:t[17],furiganaStyle:t[18],loadingState:(V=t[29])!=null?V:!0,avoidPageBreak:t[22],pageColumns:t[23],firstDimensionMargin:t[20]};return t[0]!==void 0&&(y.exploredCharCount=t[0]),t[1]!==void 0&&(y.bookCharCount=t[1]),t[6]!==void 0&&(y.isBookmarkScreen=t[6]),t[2]!==void 0&&(y.bookmarkData=t[2]),t[4]!==void 0&&(y.bookmarkManager=t[4]),t[5]!==void 0&&(y.pageManager=t[5]),e=new Rr({props:y}),ee.push(()=>se(e,"exploredCharCount",s)),ee.push(()=>se(e,"bookCharCount",h)),ee.push(()=>se(e,"isBookmarkScreen",k)),ee.push(()=>se(e,"bookmarkData",p)),ee.push(()=>se(e,"bookmarkManager",u)),ee.push(()=>se(e,"pageManager",d)),e.$on("contentChange",t[52]),{c(){_e(e.$$.fragment)},l(c){we(e.$$.fragment,c)},m(c,M){Se(e,c,M),f=!0},p(c,M){var A,O,G;const S={};M[0]&128&&(S.htmlContent=c[7]),M[0]&134217728&&(S.width=(A=c[27])!=null?A:0),M[0]&268435456&&(S.height=(O=c[28])!=null?O:0),M[0]&256&&(S.verticalMode=c[8]),M[0]&512&&(S.fontColor=c[9]),M[0]&1024&&(S.backgroundColor=c[10]),M[0]&2048&&(S.hintFuriganaFontColor=c[11]),M[0]&4096&&(S.hintFuriganaShadowColor=c[12]),M[0]&8192&&(S.fontSize=c[13]),M[0]&16384&&(S.fontFamilyGroupOne=c[14]),M[0]&32768&&(S.fontFamilyGroupTwo=c[15]),M[0]&65536&&(S.hideSpoilerImage=c[16]),M[0]&131072&&(S.hideFurigana=c[17]),M[0]&262144&&(S.furiganaStyle=c[18]),M[0]&536870912&&(S.loadingState=(G=c[29])!=null?G:!0),M[0]&4194304&&(S.avoidPageBreak=c[22]),M[0]&8388608&&(S.pageColumns=c[23]),M[0]&1048576&&(S.firstDimensionMargin=c[20]),!n&&M[0]&1&&(n=!0,S.exploredCharCount=c[0],ue(()=>n=!1)),!r&&M[0]&2&&(r=!0,S.bookCharCount=c[1],ue(()=>r=!1)),!o&&M[0]&64&&(o=!0,S.isBookmarkScreen=c[6],ue(()=>o=!1)),!i&&M[0]&4&&(i=!0,S.bookmarkData=c[2],ue(()=>i=!1)),!a&&M[0]&16&&(a=!0,S.bookmarkManager=c[4],ue(()=>a=!1)),!l&&M[0]&32&&(l=!0,S.pageManager=c[5],ue(()=>l=!1)),e.$set(S)},i(c){f||(K(e.$$.fragment,c),f=!0)},o(c){J(e.$$.fragment,c),f=!1},d(c){ve(e,c)}}}function Nr(t){var b,C,V;let e,n,r,o,i,a,l,f;function s(c){t[39](c)}function h(c){t[40](c)}function k(c){t[41](c)}function p(c){t[42](c)}function u(c){t[43](c)}function d(c){t[44](c)}let y={htmlContent:t[7],width:(b=t[27])!=null?b:0,height:(C=t[28])!=null?C:0,verticalMode:t[8],fontColor:t[9],backgroundColor:t[10],hintFuriganaFontColor:t[11],hintFuriganaShadowColor:t[12],fontSize:t[13],fontFamilyGroupOne:t[14],fontFamilyGroupTwo:t[15],hideSpoilerImage:t[16],hideFurigana:t[17],furiganaStyle:t[18],secondDimensionMaxValue:t[19],firstDimensionMargin:t[20],autoPositionOnResize:t[21],multiplier:t[25],loadingState:(V=t[29])!=null?V:!0};return t[0]!==void 0&&(y.exploredCharCount=t[0]),t[1]!==void 0&&(y.bookCharCount=t[1]),t[2]!==void 0&&(y.bookmarkData=t[2]),t[3]!==void 0&&(y.autoScroller=t[3]),t[4]!==void 0&&(y.bookmarkManager=t[4]),t[5]!==void 0&&(y.pageManager=t[5]),e=new Cr({props:y}),ee.push(()=>se(e,"exploredCharCount",s)),ee.push(()=>se(e,"bookCharCount",h)),ee.push(()=>se(e,"bookmarkData",k)),ee.push(()=>se(e,"autoScroller",p)),ee.push(()=>se(e,"bookmarkManager",u)),ee.push(()=>se(e,"pageManager",d)),e.$on("contentChange",t[45]),{c(){_e(e.$$.fragment)},l(c){we(e.$$.fragment,c)},m(c,M){Se(e,c,M),f=!0},p(c,M){var A,O,G;const S={};M[0]&128&&(S.htmlContent=c[7]),M[0]&134217728&&(S.width=(A=c[27])!=null?A:0),M[0]&268435456&&(S.height=(O=c[28])!=null?O:0),M[0]&256&&(S.verticalMode=c[8]),M[0]&512&&(S.fontColor=c[9]),M[0]&1024&&(S.backgroundColor=c[10]),M[0]&2048&&(S.hintFuriganaFontColor=c[11]),M[0]&4096&&(S.hintFuriganaShadowColor=c[12]),M[0]&8192&&(S.fontSize=c[13]),M[0]&16384&&(S.fontFamilyGroupOne=c[14]),M[0]&32768&&(S.fontFamilyGroupTwo=c[15]),M[0]&65536&&(S.hideSpoilerImage=c[16]),M[0]&131072&&(S.hideFurigana=c[17]),M[0]&262144&&(S.furiganaStyle=c[18]),M[0]&524288&&(S.secondDimensionMaxValue=c[19]),M[0]&1048576&&(S.firstDimensionMargin=c[20]),M[0]&2097152&&(S.autoPositionOnResize=c[21]),M[0]&33554432&&(S.multiplier=c[25]),M[0]&536870912&&(S.loadingState=(G=c[29])!=null?G:!0),!n&&M[0]&1&&(n=!0,S.exploredCharCount=c[0],ue(()=>n=!1)),!r&&M[0]&2&&(r=!0,S.bookCharCount=c[1],ue(()=>r=!1)),!o&&M[0]&4&&(o=!0,S.bookmarkData=c[2],ue(()=>o=!1)),!i&&M[0]&8&&(i=!0,S.autoScroller=c[3],ue(()=>i=!1)),!a&&M[0]&16&&(a=!0,S.bookmarkManager=c[4],ue(()=>a=!1)),!l&&M[0]&32&&(l=!0,S.pageManager=c[5],ue(()=>l=!1)),e.$set(S)},i(c){f||(K(e.$$.fragment,c),f=!0)},o(c){J(e.$$.fragment,c),f=!1},d(c){ve(e,c)}}}function Gr(t){var k;let e,n,r,o,i=((k=t[30])!=null?k:"")+"",a,l;const f=[Nr,Lr],s=[];function h(p,u){return p[24]===mt.Continuous?0:1}return n=h(t),r=s[n]=f[n](t),{c(){e=Z("div"),r.c(),o=re(),a=ge(i),this.h()},l(p){e=x(p,"DIV",{class:!0});var u=$(e);r.l(u),u.forEach(D),o=ie(p),a=ke(p,i),this.h()},h(){Y(e,"class",_r+" py-8")},m(p,u){N(p,e,u),s[n].m(e,null),t[53](e),N(p,o,u),N(p,a,u),l=!0},p(p,u){var y;let d=n;n=h(p),n===d?s[n].p(p,u):(Ze(),J(s[d],1,1,()=>{s[d]=null}),xe(),r=s[n],r?r.p(p,u):(r=s[n]=f[n](p),r.c()),K(r,1),r.m(e,null)),(!l||u[0]&1073741824)&&i!==(i=((y=p[30])!=null?y:"")+"")&&Be(a,i)},i(p){l||(K(r),l=!0)},o(p){J(r),l=!1},d(p){p&&D(e),s[n].d(),t[53](null),p&&D(o),p&&D(a)}}}function ut(t){return Number(t.replace(/px$/,""))}function Hr(t,e,n){let r,o,i,a,l,f,{htmlContent:s}=e,{width:h}=e,{height:k}=e,{verticalMode:p}=e,{fontColor:u}=e,{backgroundColor:d}=e,{hintFuriganaFontColor:y}=e,{hintFuriganaShadowColor:b}=e,{fontSize:C}=e,{fontFamilyGroupOne:V}=e,{fontFamilyGroupTwo:c}=e,{hideSpoilerImage:M}=e,{hideFurigana:S}=e,{furiganaStyle:A}=e,{secondDimensionMaxValue:O}=e,{firstDimensionMargin:G}=e,{autoPositionOnResize:F}=e,{avoidPageBreak:z}=e,{pageColumns:U}=e,{viewMode:H}=e,{exploredCharCount:g}=e,{bookCharCount:B}=e,{multiplier:I}=e,{bookmarkData:q}=e,{autoScroller:L}=e,{bookmarkManager:X}=e,{pageManager:ae}=e,{isBookmarkScreen:te}=e;const w=new Pe,T=new Pe,fe=Eo(null);W(t,fe,m=>n(26,o=m));const R=rt([fe.pipe(yt(m=>!!m)),rt([w,T]).pipe(Lt(0))]).pipe(En(0,Ft),me(([m])=>getComputedStyle(m)),Nt({refCount:!0,bufferSize:1})),le=new lo(1),Q=R.pipe(me(m=>he(h-ut(m.paddingLeft)-ut(m.paddingRight))));W(t,Q,m=>n(27,i=m));const de=R.pipe(me(m=>Me(k-ut(m.paddingTop)-ut(m.paddingBottom)-r)));W(t,de,m=>n(28,a=m));const pe=_t(()=>vn(document)).pipe(dt(m=>{const It=vr(m,A);return le.pipe(dt(At=>It(At)))}),Ye());W(t,pe,m=>n(30,f=m));const be=le.pipe(dt(m=>wr(m)),Gt());W(t,be,m=>n(29,l=m));function he(m){return mt.Paginated===H&&!p&&O?Math.min(O,m):m}function Me(m){return mt.Paginated===H&&p&&O?Math.min(O,m):m}function ce(m){g=m,n(0,g)}function Fe(m){B=m,n(1,B)}function Ae(m){q=m,n(2,q)}function De(m){L=m,n(3,L)}function E(m){X=m,n(4,X)}function ye(m){ae=m,n(5,ae)}const ze=m=>le.next(m.detail);function v(m){g=m,n(0,g)}function ne(m){B=m,n(1,B)}function Oe(m){te=m,n(6,te)}function je(m){q=m,n(2,q)}function Et(m){X=m,n(4,X)}function Bt(m){ae=m,n(5,ae)}const Dt=m=>le.next(m.detail);function Tt(m){ee[m?"unshift":"push"](()=>{o=m,fe.set(o)})}return t.$$set=m=>{"htmlContent"in m&&n(7,s=m.htmlContent),"width"in m&&n(37,h=m.width),"height"in m&&n(38,k=m.height),"verticalMode"in m&&n(8,p=m.verticalMode),"fontColor"in m&&n(9,u=m.fontColor),"backgroundColor"in m&&n(10,d=m.backgroundColor),"hintFuriganaFontColor"in m&&n(11,y=m.hintFuriganaFontColor),"hintFuriganaShadowColor"in m&&n(12,b=m.hintFuriganaShadowColor),"fontSize"in m&&n(13,C=m.fontSize),"fontFamilyGroupOne"in m&&n(14,V=m.fontFamilyGroupOne),"fontFamilyGroupTwo"in m&&n(15,c=m.fontFamilyGroupTwo),"hideSpoilerImage"in m&&n(16,M=m.hideSpoilerImage),"hideFurigana"in m&&n(17,S=m.hideFurigana),"furiganaStyle"in m&&n(18,A=m.furiganaStyle),"secondDimensionMaxValue"in m&&n(19,O=m.secondDimensionMaxValue),"firstDimensionMargin"in m&&n(20,G=m.firstDimensionMargin),"autoPositionOnResize"in m&&n(21,F=m.autoPositionOnResize),"avoidPageBreak"in m&&n(22,z=m.avoidPageBreak),"pageColumns"in m&&n(23,U=m.pageColumns),"viewMode"in m&&n(24,H=m.viewMode),"exploredCharCount"in m&&n(0,g=m.exploredCharCount),"bookCharCount"in m&&n(1,B=m.bookCharCount),"multiplier"in m&&n(25,I=m.multiplier),"bookmarkData"in m&&n(2,q=m.bookmarkData),"autoScroller"in m&&n(3,L=m.autoScroller),"bookmarkManager"in m&&n(4,X=m.bookmarkManager),"pageManager"in m&&n(5,ae=m.pageManager),"isBookmarkScreen"in m&&n(6,te=m.isBookmarkScreen)},t.$$.update=()=>{t.$$.dirty[0]&17826048&&(r=G&&mt.Paginated===H&&!p?G*2:0),t.$$.dirty[1]&64&&w.next(h),t.$$.dirty[1]&128&&T.next(k)},[g,B,q,L,X,ae,te,s,p,u,d,y,b,C,V,c,M,S,A,O,G,F,z,U,H,I,o,i,a,l,f,fe,le,Q,de,pe,be,h,k,ce,Fe,Ae,De,E,ye,ze,v,ne,Oe,je,Et,Bt,Dt,Tt]}class qr extends qe{constructor(e){super();Xe(this,e,Hr,Gr,We,{htmlContent:7,width:37,height:38,verticalMode:8,fontColor:9,backgroundColor:10,hintFuriganaFontColor:11,hintFuriganaShadowColor:12,fontSize:13,fontFamilyGroupOne:14,fontFamilyGroupTwo:15,hideSpoilerImage:16,hideFurigana:17,furiganaStyle:18,secondDimensionMaxValue:19,firstDimensionMargin:20,autoPositionOnResize:21,avoidPageBreak:22,pageColumns:23,viewMode:24,exploredCharCount:0,bookCharCount:1,multiplier:25,bookmarkData:2,autoScroller:3,bookmarkManager:4,pageManager:5,isBookmarkScreen:6},null,[-1,-1])}}function Xr(t,e){const n=document.createTextNode(e);if(t.firstChild){t.replaceChild(n,t.firstChild);return}t.appendChild(n)}function Wr(t,e,n){let{styleSheet:r}=e,o;return Xn(()=>{n(1,o=document.createElement("style")),document.head.appendChild(o)}),qt(()=>{o&&document.head.removeChild(o)}),t.$$set=i=>{"styleSheet"in i&&n(0,r=i.styleSheet)},t.$$.update=()=>{t.$$.dirty&3&&o&&Xr(o,r)},[r,o]}class jr extends qe{constructor(e){super();Xe(this,e,Wr,null,We,{styleSheet:0})}}/**
 * @license BSD-3-Clause
 * Copyright (c) 2022, ッツ Reader Authors
 * All rights reserved.
 */class Yr{constructor(e){this.document=e,this.fallbackSpec=sn(this.document)}get fullscreenEnabled(){var e;return(e=this.fallbackSpec("fullscreenEnabled","webkitFullscreenEnabled"))!=null?e:!1}get fullscreenElement(){var e;return(e=this.fallbackSpec("fullscreenElement","webkitFullscreenElement"))!=null?e:null}async requestFullscreen(e,n){const r=sn(e)("requestFullscreen","webkitRequestFullscreen");!r||await r(n)}async exitFullscreen(){const e=this.fallbackSpec("exitFullscreen","webkitExitFullscreen");!e||await e()}}function sn(t){return(e,n)=>{var r;return(r=un(t,e))!=null?r:un(t,n)}}function un(t,e){const n=t[e];return typeof n=="function"?n.bind(t):n}const gt=new Yr(document);/**
 * @license BSD-3-Clause
 * Copyright (c) 2022, ッツ Reader Authors
 * All rights reserved.
 */function Kr(t,e){return Ur(t).pipe(me(n=>{const r=e.createElement("div");return r.innerHTML=n,Jr(r),Qr(r),Zr(r,e),xr(r),r.innerHTML}))}function Ur(t){return new Ie(e=>{const{blobs:n}=t;let{elementHtml:r}=t;const o=[];return Object.entries(n).forEach(([i,a])=>{const l=URL.createObjectURL(a);o.push(l),r=r.replaceAll(Do(i),l).replaceAll(`ttu:${i}`,l)}),e.next(r),()=>{o.forEach(i=>URL.revokeObjectURL(i))}})}function Jr(t){Array.from(t.getElementsByTagName("img")).map(e=>({parentEl:e.parentElement,isGaiji:Yt(e)})).forEach(({parentEl:e,isGaiji:n})=>{e==null||e.classList.add("ttu-img-container"),n||e==null||e.classList.add("ttu-thumbnail-container")})}function Qr(t){Array.from(t.getElementsByTagName("svg")).forEach(e=>{e.removeAttribute("width"),e.removeAttribute("height")})}function Zr(t,e){const n=()=>{let o=[...t.children];const i=o.findIndex(a=>a.getElementsByTagName("a").length>1)+1;return i>0&&i<o.length&&(o=o.slice(i)),o},r=(o,i)=>{const a=e.createElement("span");a.toggleAttribute("data-ttu-spoiler-img"),(o.parentElement||i).insertBefore(a,o),a.appendChild(o)};n().forEach(o=>{Array.from(o.getElementsByTagName("img")).filter(i=>!Yt(i)).forEach(i=>r(i,o)),Array.from(o.getElementsByTagName("svg")).filter(i=>i.getElementsByTagName("image").length).forEach(i=>r(i,o))})}function xr(t){t.querySelectorAll(".placeholder-br").forEach(e=>{e.parentElement.removeChild(e)})}var $r=Rn;function Rn(t,e,n){t instanceof RegExp&&(t=fn(t,n)),e instanceof RegExp&&(e=fn(e,n));const r=Ln(t,e,n);return r&&{start:r[0],end:r[1],pre:n.slice(0,r[0]),body:n.slice(r[0]+t.length,r[1]),post:n.slice(r[1]+e.length)}}function fn(t,e){const n=e.match(t);return n?n[0]:null}Rn.range=Ln;function Ln(t,e,n){let r,o,i,a,l,f=n.indexOf(t),s=n.indexOf(e,f+1),h=f;if(f>=0&&s>0){if(t===e)return[f,s];for(r=[],i=n.length;h>=0&&!l;)h===f?(r.push(h),f=n.indexOf(t,h+1)):r.length===1?l=[r.pop(),s]:(o=r.pop(),o<i&&(i=o,a=s),s=n.indexOf(e,h+1)),h=f<s&&f>=0?f:s;r.length&&(l=[i,a])}return l}function ei(t,e={}){const r=Object.assign({},{preserveStatic:!0,removeComments:!1},e),o=[];function i(g){throw new Error(`CSS parse error: ${g}`)}function a(g){const B=g.exec(t);if(B)return t=t.slice(B[0].length),B}function l(){return a(/^{\s*/)}function f(){return a(/^}/)}function s(){a(/^\s*/)}function h(){if(s(),t[0]!=="/"||t[1]!=="*")return;let g=2;for(;t[g]&&(t[g]!=="*"||t[g+1]!=="/");)g++;if(!t[g])return i("end of comment is missing");const B=t.slice(2,g);return t=t.slice(g+2),{type:"comment",comment:B}}function k(){const g=[];let B;for(;B=h();)g.push(B);return r.removeComments?[]:g}function p(){for(s();t[0]==="}";)i("extra closing bracket");const g=a(/^(("(?:\\"|[^"])*"|'(?:\\'|[^'])*'|[^{])+)/);if(g)return g[0].trim().replace(/\/\*([^*]|[\r\n]|(\*+([^*/]|[\r\n])))*\*\/+/g,"").replace(/"(?:\\"|[^"])*"|'(?:\\'|[^'])*'/g,function(B){return B.replace(/,/g,"\u200C")}).split(/\s*(?![^(]*\)),\s*/).map(function(B){return B.replace(/\u200C/g,",")})}function u(){if(t[0]==="@")return z();a(/^([;\s]*)+/);const g=/\/\*[^*]*\*+([^/*][^*]*\*+)*\//g;let B=a(/^(\*?[-#/*\\\w]+(\[[0-9a-z_-]+\])?)\s*/);if(!B)return;if(B=B[0].trim(),!a(/^:\s*/))return i("property missing ':'");const I=a(/^((?:\/\*.*?\*\/|'(?:\\'|.)*?'|"(?:\\"|.)*?"|\((\s*'(?:\\'|.)*?'|"(?:\\"|.)*?"|[^)]*?)\s*\)|[^};])+)/),q={type:"declaration",property:B.replace(g,""),value:I?I[0].replace(g,"").trim():""};return a(/^[;\s]*/),q}function d(){if(!l())return i("missing '{'");let g,B=k();for(;g=u();)B.push(g),B=B.concat(k());return f()?B:i("missing '}'")}function y(){s();const g=[];let B;for(;B=a(/^((\d+\.\d+|\.\d+|\d+)%?|[a-z]+)\s*/);)g.push(B[1]),a(/^,\s*/);if(g.length)return{type:"keyframe",values:g,declarations:d()}}function b(){let g=a(/^@([-\w]+)?keyframes\s*/);if(!g)return;const B=g[1];if(g=a(/^([-\w]+)\s*/),!g)return i("@keyframes missing name");const I=g[1];if(!l())return i("@keyframes missing '{'");let q,L=k();for(;q=y();)L.push(q),L=L.concat(k());return f()?{type:"keyframes",name:I,vendor:B,keyframes:L}:i("@keyframes missing '}'")}function C(){if(a(/^@page */)){const B=p()||[];return{type:"page",selectors:B,declarations:d()}}}function V(){const g=a(/@(top|bottom|left|right)-(left|center|right|top|middle|bottom)-?(corner)?\s*/);if(g){const B=`${g[1]}-${g[2]}`+(g[3]?`-${g[3]}`:"");return{type:"page-margin-box",name:B,declarations:d()}}}function c(){if(a(/^@font-face\s*/))return{type:"font-face",declarations:d()}}function M(){const g=a(/^@supports *([^{]+)/);if(g)return{type:"supports",supports:g[1].trim(),rules:H()}}function S(){if(a(/^@host\s*/))return{type:"host",rules:H()}}function A(){const g=a(/^@media([^{]+)*/);if(g)return{type:"media",media:(g[1]||"").trim(),rules:H()}}function O(){const g=a(/^@custom-media\s+(--[^\s]+)\s*([^{;]+);/);if(g)return{type:"custom-media",name:g[1].trim(),media:g[2].trim()}}function G(){const g=a(/^@([-\w]+)?document *([^{]+)/);if(g)return{type:"document",document:g[2].trim(),vendor:g[1]?g[1].trim():null,rules:H()}}function F(){const g=a(/^@(import|charset|namespace)\s*([^;]+);/);if(g)return{type:g[1],name:g[2].trim()}}function z(){if(s(),t[0]==="@"){const g=F()||c()||A()||b()||M()||G()||O()||S()||C()||V();if(g&&!r.preserveStatic){let B=!1;return g.declarations?B=g.declarations.some(I=>/var\(/.test(I.value)):B=(g.keyframes||g.rules||[]).some(q=>(q.declarations||[]).some(L=>/var\(/.test(L.value))),B?g:{}}return g}}function U(){if(!r.preserveStatic){const I=$r("{","}",t);if(I){const q=/:(?:root|host)(?![.:#(])/.test(I.pre)&&/--\S*\s*:/.test(I.body),L=/var\(/.test(I.body);if(!q&&!L)return t=t.slice(I.end+1),{}}}const g=p()||[],B=r.preserveStatic?d():d().filter(I=>{const q=g.some(X=>/:(?:root|host)(?![.:#(])/.test(X))&&/^--\S/.test(I.property),L=/var\(/.test(I.value);return q||L});return g.length||i("selector missing"),{type:"rule",selectors:g,declarations:B}}function H(g){if(!g&&!l())return i("missing '{'");let B,I=k();for(;t.length&&(g||t[0]!=="}")&&(B=z()||U());)B.type&&I.push(B),I=I.concat(k());return!g&&!f()?i("missing '}'"):I}return{type:"stylesheet",stylesheet:{rules:H(!0),errors:o}}}function ti(t,e="",n){const r={charset(i){return"@charset "+i.name+";"},comment(i){return i.comment.indexOf("__CSSVARSPONYFILL")===0?"/*"+i.comment+"*/":""},"custom-media"(i){return"@custom-media "+i.name+" "+i.media+";"},declaration(i){return i.property+":"+i.value+";"},document(i){return"@"+(i.vendor||"")+"document "+i.document+"{"+o(i.rules)+"}"},"font-face"(i){return"@font-face{"+o(i.declarations)+"}"},host(i){return"@host{"+o(i.rules)+"}"},import(i){return"@import "+i.name+";"},keyframe(i){return i.values.join(",")+"{"+o(i.declarations)+"}"},keyframes(i){return"@"+(i.vendor||"")+"keyframes "+i.name+"{"+o(i.keyframes)+"}"},media(i){return"@media "+i.media+"{"+o(i.rules)+"}"},namespace(i){return"@namespace "+i.name+";"},page(i){return"@page "+(i.selectors.length?i.selectors.join(", "):"")+"{"+o(i.declarations)+"}"},"page-margin-box"(i){return"@"+i.name+"{"+o(i.declarations)+"}"},rule(i){const a=i.declarations;if(a.length)return i.selectors.join(",")+"{"+o(a)+"}"},supports(i){return"@supports "+i.supports+"{"+o(i.rules)+"}"}};function o(i){let a="";for(let l=0;l<i.length;l++){const f=i[l];n&&n(f);const s=r[f.type](f);s&&(a+=s,s.length&&f.selectors&&(a+=e))}return a}return o(t.stylesheet.rules)}/**
 * @license BSD-3-Clause
 * Copyright (c) 2022, ッツ Reader Authors
 * All rights reserved.
 */const ni=/\s?html\s?/gi,oi=/\s?body\s?/gi;function ri(t,e){const r=ei(t.styleSheet).stylesheet.rules.filter(o=>o.type==="rule").filter(o=>!o.selectors.some(i=>ni.test(i)||oi.test(i)));return r.forEach(o=>{const i={};o.declarations=o.declarations.filter(l=>!/line-height$/.test(l.property)&&!/text-indent$/.test(l.property));const a=new si(o.declarations,i);o.declarations.forEach(l=>{Vt(i,ai(l)),Vt(i,li(l)),Vt(i,a.convert(l))}),Object.entries(i).forEach(([l,f])=>{o.declarations.push({type:"declaration",property:l,value:f})}),o.declarations=o.declarations.filter(l=>!/writing-mode\s*$/.test(l.property))}),r.push(ui()),r.forEach(o=>{o.selectors=ii(o.selectors,e)}),ti({stylesheet:{rules:r},type:"stylesheet"})}function ii(t,e){return t.map(n=>`${e} ${n}`)}function Vt(t,e){return e&&(t[e.key]=e.value),t}function ai(t){const e=/(?:(?:-epub-)|(?:-webkit-))(.+)/i.exec(t.property);if(e)return{key:e[1],value:t.value}}function li(t){if(t.property==="font-family"){let e=t.value;return e.includes("sans-serif")?e="var(--font-family-sans-serif, Noto Sans JP, sans-serif)":e.includes("serif")&&(e="var(--font-family-serif, Noto Serif JP, serif)"),{key:t.property,value:e}}}class si{constructor(e,n){this.ruleDeclarations=e,this.newDeclarations=n}convert(e){if(/(?:(?:-epub-)|(?:-webkit-))?word-break$/i.exec(e.property)&&e.value==="break-all"&&(this.hasLineBreakDefined===void 0&&(this.hasLineBreakDefined=this.ruleDeclarations.some(n=>n.type==="declaration"&&n.property==="line-break")),!this.hasLineBreakDefined&&!this.newDeclarations["line-break"]))return{key:"line-break",value:"loose"}}}function ui(){return{type:"rule",selectors:["br"],declarations:[{type:"declaration",property:"display",value:"inline!important"}]}}/**
 * @license BSD-3-Clause
 * Copyright (c) 2022, ッツ Reader Authors
 * All rights reserved.
 */function fi(t,e,n){return Kr(t,n).pipe(me(r=>({htmlContent:r,styleSheet:ri(t,e)})))}/**
 * @license BSD-3-Clause
 * Copyright (c) 2022, ッツ Reader Authors
 * All rights reserved.
 */function ci(t){return new Ie(e=>t.subscribe(n=>{e.next(n)}))}/**
 * @license BSD-3-Clause
 * Copyright (c) 2022, ッツ Reader Authors
 * All rights reserved.
 */function ft(t=yn){return e=>t?e:Pn}/**
 * @license BSD-3-Clause
 * Copyright (c) 2022, ッツ Reader Authors
 * All rights reserved.
 */function cn(t,e,n){return r=>new Ie(o=>{const i=t();return r.pipe(_n(Ft),To(()=>n(i))).subscribe({next:a=>{e(a,i),o.next(a)},error:a=>o.error(a),complete:()=>o.complete()})})}/**
 * @license BSD-3-Clause
 * Copyright (c) 2022, ッツ Reader Authors
 * All rights reserved.
 */function hi(t,e,n,r,o,i,a){switch(e[t.code]){case Re.BOOKMARK:return n(),!0;case Re.JUMP_TO_BOOKMARK:return r(),!0;case Re.AUTO_SCROLL_TOGGLE:return i==null||i.toggle(),!0;case Re.AUTO_SCROLL_INCREASE:return o(1),!0;case Re.AUTO_SCROLL_DECREASE:return o(-1),!0;case Re.NEXT_PAGE:return a==null||a.nextPage(),!0;case Re.PREV_PAGE:return a==null||a.prevPage(),!0;default:return!1}}function hn(t){let e,n,r,o,i,a;return n=new Je({props:{icon:xn}}),{c(){e=Z("div"),_e(n.$$.fragment),this.h()},l(l){e=x(l,"DIV",{role:!0,class:!0});var f=$(e);we(n.$$.fragment,f),f.forEach(D),this.h()},h(){Y(e,"role","button"),Y(e,"class",r="flex h-full items-center text-xl xl:text-lg "+ct+" "+ht+" cursor-pointer")},m(l,f){N(l,e,f),Se(n,e,null),o=!0,i||(a=Ee(e,"click",t[5]),i=!0)},p:nt,i(l){o||(K(n.$$.fragment,l),o=!0)},o(l){J(n.$$.fragment,l),o=!1},d(l){l&&D(e),ve(n),i=!1,a()}}}function di(t){let e,n,r,o,i,a,l,f,s,h,k,p,u,d,y,b,C,V,c,M,S;o=new Je({props:{icon:t[2]?Rt:xt}});let A=t[1]&&hn(t);return d=new Je({props:{icon:Un}}),V=new Je({props:{icon:Jn}}),{c(){e=Z("div"),n=Z("div"),r=Z("div"),_e(o.$$.fragment),i=re(),a=Z("div"),l=ge(t[0]),f=ge("x"),s=re(),h=Z("div"),A&&A.c(),k=re(),p=Z("a"),u=Z("span"),_e(d.$$.fragment),y=re(),b=Z("a"),C=Z("span"),_e(V.$$.fragment),this.h()},l(O){e=x(O,"DIV",{class:!0});var G=$(e);n=x(G,"DIV",{class:!0});var F=$(n);r=x(F,"DIV",{class:!0,role:!0});var z=$(r);we(o.$$.fragment,z),z.forEach(D),i=ie(F),a=x(F,"DIV",{class:!0});var U=$(a);l=ke(U,t[0]),f=ke(U,"x"),U.forEach(D),F.forEach(D),s=ie(G),h=x(G,"DIV",{class:!0});var H=$(h);A&&A.l(H),k=ie(H),p=x(H,"A",{href:!0});var g=$(p);u=x(g,"SPAN",{class:!0});var B=$(u);we(d.$$.fragment,B),B.forEach(D),g.forEach(D),y=ie(H),b=x(H,"A",{href:!0});var I=$(b);C=x(I,"SPAN",{class:!0});var q=$(C);we(V.$$.fragment,q),q.forEach(D),I.forEach(D),H.forEach(D),G.forEach(D),this.h()},h(){Y(r,"class","flex h-full items-center text-xl xl:text-lg "+ct+" "+ht+" cursor-pointer"),Y(r,"role","button"),Y(a,"class","flex items-center px-4 text-xl xl:px-3 xl:text-lg"),Y(n,"class","flex transform-gpu "+Qn),Y(u,"class","flex h-full items-center text-xl xl:text-lg "+ct+" "+ht+" cursor-pointer"),Y(p,"href","/ebook-reader/settings"),Y(C,"class","flex h-full items-center text-xl xl:text-lg "+ct+" "+ht+" cursor-pointer"),Y(b,"href","/ebook-reader/manage"),Y(h,"class","flex transform-gpu "+Zn),Y(e,"class","flex h-12 justify-between bg-gray-700 px-4 text-white md:px-8 xl:h-10")},m(O,G){N(O,e,G),oe(e,n),oe(n,r),Se(o,r,null),oe(n,i),oe(n,a),oe(a,l),oe(a,f),oe(e,s),oe(e,h),A&&A.m(h,null),oe(h,k),oe(h,p),oe(p,u),Se(d,u,null),oe(h,y),oe(h,b),oe(b,C),Se(V,C,null),c=!0,M||(S=[Ee(r,"click",t[4]),Ee(p,"click",t[6]),Ee(b,"click",t[7])],M=!0)},p(O,[G]){const F={};G&4&&(F.icon=O[2]?Rt:xt),o.$set(F),(!c||G&1)&&Be(l,O[0]),O[1]?A?(A.p(O,G),G&2&&K(A,1)):(A=hn(O),A.c(),K(A,1),A.m(h,k)):A&&(Ze(),J(A,1,1,()=>{A=null}),xe())},i(O){c||(K(o.$$.fragment,O),K(A),K(d.$$.fragment,O),K(V.$$.fragment,O),c=!0)},o(O){J(o.$$.fragment,O),J(A),J(d.$$.fragment,O),J(V.$$.fragment,O),c=!1},d(O){O&&D(e),ve(o),A&&A.d(),ve(d),ve(V),M=!1,vt(S)}}}function mi(t,e,n){let{autoScrollMultiplier:r}=e,{showFullscreenButton:o}=e,{isBookmarkScreen:i}=e;const a=St(),l=()=>a("bookmarkClick"),f=()=>a("fullscreenClick"),s=()=>a("settingsClick"),h=()=>a("bookManagerClick");return t.$$set=k=>{"autoScrollMultiplier"in k&&n(0,r=k.autoScrollMultiplier),"showFullscreenButton"in k&&n(1,o=k.showFullscreenButton),"isBookmarkScreen"in k&&n(2,i=k.isBookmarkScreen)},[r,o,i,a,l,f,s,h]}class gi extends qe{constructor(e){super();Xe(this,e,mi,di,We,{autoScrollMultiplier:0,showFullscreenButton:1,isBookmarkScreen:2})}}const{document:zt}=pn;function dn(t){let e,n,r,o,i,a,l,f;function s(k){t[50](k)}let h={showFullscreenButton:gt.fullscreenEnabled,autoScrollMultiplier:t[11]};return t[5]!==void 0&&(h.isBookmarkScreen=t[5]),n=new gi({props:h}),ee.push(()=>se(n,"isBookmarkScreen",s)),n.$on("fullscreenClick",t[48]),n.$on("bookmarkClick",t[45]),n.$on("bookManagerClick",t[47]),n.$on("settingsClick",t[45]),{c(){e=Z("div"),_e(n.$$.fragment),this.h()},l(k){e=x(k,"DIV",{class:!0});var p=$(e);we(n.$$.fragment,p),p.forEach(D),this.h()},h(){Y(e,"class","elevation-4 writing-horizontal-tb fixed inset-x-0 top-0 z-10 w-full")},m(k,p){N(k,e,p),Se(n,e,null),a=!0,l||(f=bn(o=Io.call(null,e,t[51])),l=!0)},p(k,p){t=k;const u={};p[0]&2048&&(u.autoScrollMultiplier=t[11]),!r&&p[0]&32&&(r=!0,u.isBookmarkScreen=t[5],ue(()=>r=!1)),n.$set(u),o&&Wn(o.update)&&p[0]&16&&o.update.call(null,t[51])},i(k){a||(K(n.$$.fragment,k),k&&jn(()=>{i||(i=Ut(e,Qt,{y:-300,easing:Jt},!0)),i.run(1)}),a=!0)},o(k){J(n.$$.fragment,k),k&&(i||(i=Ut(e,Qt,{y:-300,easing:Jt},!1)),i.run(0)),a=!1},d(k){k&&D(e),ve(n),k&&i&&i.end(),l=!1,f()}}}function ki(t){var r;let e=((r=t[33])!=null?r:"")+"",n;return{c(){n=ge(e)},l(o){n=ke(o,e)},m(o,i){N(o,n,i)},p(o,i){var a;i[1]&4&&e!==(e=((a=o[33])!=null?a:"")+"")&&Be(n,e)},i:nt,o:nt,d(o){o&&D(n)}}}function pi(t){var g,B,I,q,L,X,ae,te;let e,n,r,o,i,a,l,f,s,h,k,p=((g=t[30])!=null?g:"")+"",u,d,y=((B=t[31])!=null?B:"")+"",b,C,V=((I=t[32])!=null?I:"")+"",c,M;e=new jr({props:{styleSheet:t[12].styleSheet}});function S(w){t[52](w)}function A(w){t[53](w)}function O(w){t[54](w)}function G(w){t[55](w)}function F(w){t[56](w)}function z(w){t[57](w)}function U(w){t[58](w)}let H={htmlContent:t[12].htmlContent,width:(q=t[13])!=null?q:0,height:(L=t[14])!=null?L:0,verticalMode:t[15],fontColor:(X=t[16])==null?void 0:X.fontColor,backgroundColor:t[17],hintFuriganaFontColor:(ae=t[16])==null?void 0:ae.hintFuriganaFontColor,hintFuriganaShadowColor:(te=t[16])==null?void 0:te.hintFuriganaShadowColor,fontSize:t[18],fontFamilyGroupOne:t[19],fontFamilyGroupTwo:t[20],hideSpoilerImage:t[21],hideFurigana:t[22],furiganaStyle:t[23],viewMode:t[24],secondDimensionMaxValue:t[25],firstDimensionMargin:t[26],autoPositionOnResize:t[27],avoidPageBreak:t[28],pageColumns:t[29],multiplier:t[11]};return t[7]!==void 0&&(H.exploredCharCount=t[7]),t[8]!==void 0&&(H.bookCharCount=t[8]),t[5]!==void 0&&(H.isBookmarkScreen=t[5]),t[0]!==void 0&&(H.bookmarkData=t[0]),t[1]!==void 0&&(H.autoScroller=t[1]),t[2]!==void 0&&(H.bookmarkManager=t[2]),t[3]!==void 0&&(H.pageManager=t[3]),r=new qr({props:H}),ee.push(()=>se(r,"exploredCharCount",S)),ee.push(()=>se(r,"bookCharCount",A)),ee.push(()=>se(r,"isBookmarkScreen",O)),ee.push(()=>se(r,"bookmarkData",G)),ee.push(()=>se(r,"autoScroller",F)),ee.push(()=>se(r,"bookmarkManager",z)),ee.push(()=>se(r,"pageManager",U)),{c(){_e(e.$$.fragment),n=re(),_e(r.$$.fragment),k=re(),u=ge(p),d=re(),b=ge(y),C=re(),c=ge(V)},l(w){we(e.$$.fragment,w),n=ie(w),we(r.$$.fragment,w),k=ie(w),u=ke(w,p),d=ie(w),b=ke(w,y),C=ie(w),c=ke(w,V)},m(w,T){Se(e,w,T),N(w,n,T),Se(r,w,T),N(w,k,T),N(w,u,T),N(w,d,T),N(w,b,T),N(w,C,T),N(w,c,T),M=!0},p(w,T){var le,Q,de,pe,be,he,Me,ce;const fe={};T[0]&4096&&(fe.styleSheet=w[12].styleSheet),e.$set(fe);const R={};T[0]&4096&&(R.htmlContent=w[12].htmlContent),T[0]&8192&&(R.width=(le=w[13])!=null?le:0),T[0]&16384&&(R.height=(Q=w[14])!=null?Q:0),T[0]&32768&&(R.verticalMode=w[15]),T[0]&65536&&(R.fontColor=(de=w[16])==null?void 0:de.fontColor),T[0]&131072&&(R.backgroundColor=w[17]),T[0]&65536&&(R.hintFuriganaFontColor=(pe=w[16])==null?void 0:pe.hintFuriganaFontColor),T[0]&65536&&(R.hintFuriganaShadowColor=(be=w[16])==null?void 0:be.hintFuriganaShadowColor),T[0]&262144&&(R.fontSize=w[18]),T[0]&524288&&(R.fontFamilyGroupOne=w[19]),T[0]&1048576&&(R.fontFamilyGroupTwo=w[20]),T[0]&2097152&&(R.hideSpoilerImage=w[21]),T[0]&4194304&&(R.hideFurigana=w[22]),T[0]&8388608&&(R.furiganaStyle=w[23]),T[0]&16777216&&(R.viewMode=w[24]),T[0]&33554432&&(R.secondDimensionMaxValue=w[25]),T[0]&67108864&&(R.firstDimensionMargin=w[26]),T[0]&134217728&&(R.autoPositionOnResize=w[27]),T[0]&268435456&&(R.avoidPageBreak=w[28]),T[0]&536870912&&(R.pageColumns=w[29]),T[0]&2048&&(R.multiplier=w[11]),!o&&T[0]&128&&(o=!0,R.exploredCharCount=w[7],ue(()=>o=!1)),!i&&T[0]&256&&(i=!0,R.bookCharCount=w[8],ue(()=>i=!1)),!a&&T[0]&32&&(a=!0,R.isBookmarkScreen=w[5],ue(()=>a=!1)),!l&&T[0]&1&&(l=!0,R.bookmarkData=w[0],ue(()=>l=!1)),!f&&T[0]&2&&(f=!0,R.autoScroller=w[1],ue(()=>f=!1)),!s&&T[0]&4&&(s=!0,R.bookmarkManager=w[2],ue(()=>s=!1)),!h&&T[0]&8&&(h=!0,R.pageManager=w[3],ue(()=>h=!1)),r.$set(R),(!M||T[0]&1073741824)&&p!==(p=((he=w[30])!=null?he:"")+"")&&Be(u,p),(!M||T[1]&1)&&y!==(y=((Me=w[31])!=null?Me:"")+"")&&Be(b,y),(!M||T[1]&2)&&V!==(V=((ce=w[32])!=null?ce:"")+"")&&Be(c,V)},i(w){M||(K(e.$$.fragment,w),K(r.$$.fragment,w),M=!0)},o(w){J(e.$$.fragment,w),J(r.$$.fragment,w),M=!1},d(w){ve(e,w),w&&D(n),ve(r,w),w&&D(k),w&&D(u),w&&D(d),w&&D(b),w&&D(C),w&&D(c)}}}function mn(t){let e,n,r,o,i,a=(t[7]/t[8]*100).toFixed(2)+"",l,f;return{c(){e=Z("div"),n=ge(t[7]),r=ge(" / "),o=ge(t[8]),i=ge(" ("),l=ge(a),f=ge("%)"),this.h()},l(s){e=x(s,"DIV",{class:!0});var h=$(e);n=ke(h,t[7]),r=ke(h," / "),o=ke(h,t[8]),i=ke(h," ("),l=ke(h,a),f=ke(h,"%)"),h.forEach(D),this.h()},h(){var s;Y(e,"class","writing-horizontal-tb fixed bottom-2 right-2 z-10 text-xs leading-none"),P(e,"color",(s=t[16])==null?void 0:s.tooltipTextFontColor,!1)},m(s,h){N(s,e,h),oe(e,n),oe(e,r),oe(e,o),oe(e,i),oe(e,l),oe(e,f)},p(s,h){var k;h[0]&128&&Be(n,s[7]),h[0]&256&&Be(o,s[8]),h[0]&384&&a!==(a=(s[7]/s[8]*100).toFixed(2)+"")&&Be(l,a),h[0]&65536&&P(e,"color",(k=s[16])==null?void 0:k.tooltipTextFontColor,!1)},d(s){s&&D(e)}}}function bi(t){var A,O,G;let e,n,r=((A=t[10])!=null?A:"")+"",o,i,a,l,f,s,h,k,p,u,d,y,b;zt.title=e=Zt((G=(O=t[9])==null?void 0:O.title)!=null?G:"");let C=t[4]&&dn(t);const V=[pi,ki],c=[];function M(F,z){return F[12]?0:1}s=M(t),h=c[s]=V[s](t);let S=t[6]&&t[8]&&mn(t);return{c(){n=re(),o=ge(r),i=re(),a=Z("button"),l=re(),C&&C.c(),f=re(),h.c(),k=re(),S&&S.c(),p=re(),u=Z("button"),this.h()},l(F){Yn('[data-svelte="svelte-rnuhm6"]',zt.head).forEach(D),n=ie(F),o=ke(F,r),i=ie(F),a=x(F,"BUTTON",{class:!0}),$(a).forEach(D),l=ie(F),C&&C.l(F),f=ie(F),h.l(F),k=ie(F),S&&S.l(F),p=ie(F),u=x(F,"BUTTON",{class:!0}),$(u).forEach(D),this.h()},h(){Y(a,"class","fixed inset-x-0 top-0 z-10 h-8 w-full"),Y(u,"class","fixed inset-x-0 bottom-0 z-10 h-8 w-full cursor-pointer")},m(F,z){N(F,n,z),N(F,o,z),N(F,i,z),N(F,a,z),N(F,l,z),C&&C.m(F,z),N(F,f,z),c[s].m(F,z),N(F,k,z),S&&S.m(F,z),N(F,p,z),N(F,u,z),d=!0,y||(b=[Ee(window,"keydown",t[44]),Ee(a,"click",t[49]),Ee(u,"click",t[59])],y=!0)},p(F,z){var H,g,B;(!d||z[0]&512)&&e!==(e=Zt((g=(H=F[9])==null?void 0:H.title)!=null?g:""))&&(zt.title=e),(!d||z[0]&1024)&&r!==(r=((B=F[10])!=null?B:"")+"")&&Be(o,r),F[4]?C?(C.p(F,z),z[0]&16&&K(C,1)):(C=dn(F),C.c(),K(C,1),C.m(f.parentNode,f)):C&&(Ze(),J(C,1,1,()=>{C=null}),xe());let U=s;s=M(F),s===U?c[s].p(F,z):(Ze(),J(c[U],1,1,()=>{c[U]=null}),xe(),h=c[s],h?h.p(F,z):(h=c[s]=V[s](F),h.c()),K(h,1),h.m(k.parentNode,k)),F[6]&&F[8]?S?S.p(F,z):(S=mn(F),S.c(),S.m(p.parentNode,p)):S&&(S.d(1),S=null)},i(F){d||(K(C),K(h),d=!0)},o(F){J(C),J(h),d=!1},d(F){F&&D(n),F&&D(o),F&&D(i),F&&D(a),F&&D(l),C&&C.d(F),F&&D(f),c[s].d(F),F&&D(k),S&&S.d(F),F&&D(p),F&&D(u),y=!1,vt(b)}}}const gn="background-color",kn="writing-mode";function Ci(t,e,n){let r,o,i,a,l,f,s,h,k,p,u,d,y,b,C,V,c,M,S,A,O,G,F,z,U;W(t,Ot,_=>n(11,i=_)),W(t,ho,_=>n(15,s=_)),W(t,mo,_=>n(18,p=_)),W(t,go,_=>n(19,u=_)),W(t,ko,_=>n(20,d=_)),W(t,po,_=>n(21,y=_)),W(t,bo,_=>n(22,b=_)),W(t,Co,_=>n(23,C=_)),W(t,_o,_=>n(24,V=_)),W(t,wo,_=>n(25,c=_)),W(t,So,_=>n(26,M=_)),W(t,vo,_=>n(27,S=_)),W(t,yo,_=>n(28,A=_)),W(t,Mo,_=>n(29,O=_));const H=_t(()=>ci($n)).pipe(me(_=>Number(_.url.searchParams.get("id"))),Nt({refCount:!0,bufferSize:1})),g=H.pipe(kt(_=>lt.getData(_)),Gt());W(t,g,_=>n(9,r=_));const B=g.pipe(Ve(_=>{_||fo("/manage")}),Ye());W(t,B,_=>n(33,U=_));let I=Promise.resolve(void 0);const q=g.pipe(Ve(_=>{!_||n(0,I=lt.getBookmark(_.id))}),Ye());W(t,q,_=>n(30,G=_));const L=g.pipe(kt(_=>_?fi(_,".book-content",document):Xt),Nt({refCount:!0,bufferSize:1}));W(t,L,_=>n(12,a=_));const X=_t(()=>He(visualViewport,"resize")).pipe(Gt()),ae=X.pipe(Lt(0),me(()=>visualViewport.width),ft());W(t,ae,_=>n(13,l=_));const te=X.pipe(Lt(0),me(()=>visualViewport.height),ft());W(t,te,_=>n(14,f=_));const w=so.pipe(me(_=>Ao.get(_)),yt(_=>!!_));W(t,w,_=>n(16,h=_));const T=w.pipe(me(_=>_.backgroundColor));W(t,T,_=>n(17,k=_));const fe=T.pipe(cn(()=>document.body,(_,Te)=>Te.style.setProperty(gn,_),_=>_.style.removeProperty(gn)),Ye(),ft());W(t,fe,_=>n(31,F=_));const R=uo.pipe(cn(()=>document.documentElement,(_,Te)=>Te.style.setProperty(kn,_),_=>_.style.removeProperty(kn)),Ye(),ft());W(t,R,_=>n(32,z=_));let le,Q,de;function pe(_){!hi(_,co.getValue(),he,Me,Nn=>Ot.next(Ot.getValue()+Nn),le,de)||(document.activeElement instanceof HTMLElement&&document.activeElement.blur(),_.preventDefault())}function be(){let _;return H.subscribe(Te=>_=Te).unsubscribe(),_}async function he(){const _=be();if(!_||!Q)return;const Te=Q.formatBookmarkData(_);await lt.putBookmark(Te),n(0,I=Promise.resolve(Te))}async function Me(){const _=await I;!_||!Q||Q.scrollToBookmark(_)}let ce=!0,Fe=!1;const Ae=jt(2500).pipe(Ve(()=>n(4,ce=!1)),Ye());W(t,Ae,_=>n(10,o=_));function De(){lt.deleteLastItem(),he()}function E(){if(!gt.fullscreenElement){gt.requestFullscreen(document.documentElement);return}gt.exitFullscreen()}let ye=!0,ze=0,v=0;const ne=()=>n(4,ce=!0);function Oe(_){Fe=_,n(5,Fe)}const je=()=>n(4,ce=!1);function Et(_){ze=_,n(7,ze)}function Bt(_){v=_,n(8,v)}function Dt(_){Fe=_,n(5,Fe)}function Tt(_){I=_,n(0,I)}function m(_){le=_,n(1,le)}function It(_){Q=_,n(2,Q)}function At(_){de=_,n(3,de)}return[I,le,Q,de,ce,Fe,ye,ze,v,r,o,i,a,l,f,s,h,k,p,u,d,y,b,C,V,c,M,S,A,O,G,F,z,U,g,B,q,L,ae,te,w,T,fe,R,pe,he,Ae,De,E,ne,Oe,je,Et,Bt,Dt,Tt,m,It,At,()=>n(6,ye=!ye)]}class Di extends qe{constructor(e){super();Xe(this,e,Ci,bi,We,{},null,[-1,-1,-1])}}export{Di as default};
