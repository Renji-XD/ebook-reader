import{S as Oe,i as Ve,n as Se,j as R,s as U,q as le,k as S,l as D,c as z,f as u,r as oe,m as h,p as Et,a as O,G as w,N as G,d as V,g as de,t as L,b as pe,u as ye,R as ie,_ as sr,w as Y,x as Z,y as Q,B as Ie,z as x,ag as Bt,a8 as $,aa as Xe,a1 as Ce,Y as xe,af as kt,a2 as bt,I as Yt,K as Zt,U as Qt,a6 as be,a7 as we,a5 as Fe,D as J,L as ge,$ as ve,ah as ke,e as Je,Z as ir,o as ar,ai as It,ab as ht,ac as _t,F as cr,T as fr,A as ur}from"../../../chunks/index-876111f7.js";import{f as yt,g as dr}from"../../../chunks/format-page-title-91f1c985.js";import{F as Ee,q as pr,r as hr,s as _r,t as mr,u as gr,v as vr,w as kr,x as br,y as wr,z as Er,A as Br}from"../../../chunks/fa-26600f17.js";import{a as Ir,c as yr,t as Dr}from"../../../chunks/index-cfdc196c.js";import{P as Ye,m as re,M as Dt,r as Cr}from"../../../chunks/merged-header-icon-fd5992a9.js";import{f as De,Y as Rr,ai as Ze,aC as Qe,aD as xt,aE as er,aF as tr,c as Sr,g as wt,ag as mt,aG as Tr,a4 as j,i as Pr,aH as Le,aI as Ct,a3 as Te,aJ as Ge,aK as te,X as Or,aL as rr,U as Pe,aM as Vr,W as Mr,aN as Ar,aO as gt,aP as vt,aQ as $e,aR as Rt,aS as St,j as Ue,m as ut,T as Tt,z as Lr,a9 as Nr,a as Re,M as We,p as $r,aT as Ur,aa as Pt,aU as zr,ah as Fr,aV as Gr}from"../../../chunks/store-980e8526.js";import{v as lr,a as Ot,m as ze,p as jr}from"../../../chunks/error-handler-df8dffd6.js";function Vt(l){let e,t;return e=new Ee({props:{class:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2",icon:Ir}}),{c(){Y(e.$$.fragment)},l(r){Z(e.$$.fragment,r)},m(r,n){Q(e,r,n),t=!0},p:Ie,i(r){t||(V(e.$$.fragment,r),t=!0)},o(r){L(e.$$.fragment,r),t=!1},d(r){x(e,r)}}}function Mt(l){let e,t,r,n;return{c(){e=R("img"),this.h()},l(a){e=S(a,"IMG",{decoding:!0,loading:!0,referrerpolicy:!0,class:!0,src:!0,alt:!0}),this.h()},h(){h(e,"decoding","async"),h(e,"loading","lazy"),h(e,"referrerpolicy","no-referrer"),h(e,"class","relative h-full w-full object-cover transition delay-150 duration-700 ease-out"),Bt(e.src,t=l[7](l[0]))||h(e,"src",t),h(e,"alt",l[5]),$(e,"blur",!l[6])},m(a,i){O(a,e,i),l[10](e),r||(n=G(e,"load",l[11]),r=!0)},p(a,i){i&1&&!Bt(e.src,t=a[7](a[0]))&&h(e,"src",t),i&32&&h(e,"alt",a[5]),i&64&&$(e,"blur",!a[6])},d(a){a&&u(e),l[10](null),r=!1,n()}}}function Hr(l){let e,t,r,n,a,i,s,o,c,f,g,_,p=`${l[2]*100}%`,k,C,y,E=!l[6]&&Vt(),d=l[0]&&Mt(l);return{c(){e=R("div"),t=R("div"),r=R("div"),E&&E.c(),n=U(),d&&d.c(),a=U(),i=R("div"),s=R("div"),o=R("span"),c=le(l[1]),f=U(),g=R("div"),_=R("div"),this.h()},l(m){e=S(m,"DIV",{class:!0,role:!0});var P=D(e);t=S(P,"DIV",{class:!0});var I=D(t);r=S(I,"DIV",{class:!0});var b=D(r);E&&E.l(b),n=z(b),d&&d.l(b),b.forEach(u),a=z(I),i=S(I,"DIV",{class:!0});var v=D(i);s=S(v,"DIV",{class:!0});var M=D(s);o=S(M,"SPAN",{class:!0});var X=D(o);c=oe(X,l[1]),X.forEach(u),M.forEach(u),f=z(v),g=S(v,"DIV",{class:!0});var W=D(g);_=S(W,"DIV",{class:!0}),D(_).forEach(u),W.forEach(u),v.forEach(u),I.forEach(u),P.forEach(u),this.h()},h(){h(r,"class","h-full w-full text-5xl sm:text-7xl"),h(o,"class","line-clamp-3"),h(s,"class","sm:h-21 h-16 bg-gray-800 bg-opacity-80 p-0.5 px-1.5 text-justify text-sm text-white sm:p-1.5 sm:text-base"),h(_,"class","h-full rounded bg-gradient-to-b from-red-600 to-red-900"),Et(_,"width",p),h(g,"class","h-2.5 bg-gray-400 bg-opacity-80"),h(i,"class","absolute inset-x-0 bottom-0"),h(t,"class","inline"),h(e,"class","aspect-w-2 aspect-h-3 relative cursor-pointer"),h(e,"role","button")},m(m,P){O(m,e,P),w(e,t),w(t,r),E&&E.m(r,null),w(r,n),d&&d.m(r,null),w(t,a),w(t,i),w(i,s),w(s,o),w(o,c),w(i,f),w(i,g),w(g,_),k=!0,C||(y=[G(e,"click",l[8]),G(e,"keyup",l[9])],C=!0)},p(m,[P]){m[6]?E&&(de(),L(E,1,1,()=>{E=null}),pe()):E?(E.p(m,P),P&64&&V(E,1)):(E=Vt(),E.c(),V(E,1),E.m(r,n)),m[0]?d?d.p(m,P):(d=Mt(m),d.c(),d.m(r,null)):d&&(d.d(1),d=null),(!k||P&2)&&ye(c,m[1]),P&4&&p!==(p=`${m[2]*100}%`)&&Et(_,"width",p)},i(m){k||(V(E),k=!0)},o(m){L(E),k=!1},d(m){m&&u(e),E&&E.d(),d&&d.d(),C=!1,ie(y)}}}function qr(l,e,t){let r,n,{imagePath:a}=e,{title:i}=e,{progress:s}=e,o="";sr(()=>{o&&URL.revokeObjectURL(o)});function c(d){return o&&(URL.revokeObjectURL(o),o=""),typeof d!="string"?(o=URL.createObjectURL(d),o):d}function f(){let d,m;const P=I=>d?d instanceof Blob&&I instanceof Blob?d.type===I.type&&d.size===I.size:typeof d!="object"||typeof I!="object"?d===I:!1:!1;return I=>(P(I)||(d=I,m=c(I)),m)}const g=f();let _,p=!0;function k(d){Xe.call(this,l,d)}function C(d){Xe.call(this,l,d)}function y(d){Ce[d?"unshift":"push"](()=>{_=d,t(3,_)})}const E=()=>t(4,p=!1);return l.$$set=d=>{"imagePath"in d&&t(0,a=d.imagePath),"title"in d&&t(1,i=d.title),"progress"in d&&t(2,s=d.progress)},l.$$.update=()=>{l.$$.dirty&24&&t(6,r=(_==null?void 0:_.complete)&&!p),l.$$.dirty&2&&t(5,n=`${i}_cover`)},[a,i,s,_,p,n,r,g,k,C,y,E]}class Wr extends Oe{constructor(e){super(),Ve(this,e,qr,Hr,Se,{imagePath:0,title:1,progress:2})}}function At(l,e,t){const r=l.slice();return r[11]=e[t],r}function Lt(l){let e,t,r,n,a;t=new Ee({props:{class:"absolute left-2 top-2 flex text-xl text-white",icon:pr}});function i(){return l[7](l[11])}return{c(){e=R("div"),Y(t.$$.fragment),this.h()},l(s){e=S(s,"DIV",{class:!0});var o=D(e);Z(t.$$.fragment,o),o.forEach(u),this.h()},h(){h(e,"class","absolute inset-0 cursor-pointer bg-gray-700 bg-opacity-20")},m(s,o){O(s,e,o),Q(t,e,null),r=!0,n||(a=[G(e,"click",i),G(e,"keyup",De)],n=!0)},p(s,o){l=s},i(s){r||(V(t.$$.fragment,s),r=!0)},o(s){L(t.$$.fragment,s),r=!1},d(s){s&&u(e),x(t),n=!1,ie(a)}}}function Nt(l){let e,t,r;return t=new Ye({props:{placement:"right",fallbackPlacements:["bottom"],yOffset:5,$$slots:{content:[Xr],icon:[Kr]},$$scope:{ctx:l}}}),{c(){e=R("div"),Y(t.$$.fragment),this.h()},l(n){e=S(n,"DIV",{class:!0});var a=D(e);Z(t.$$.fragment,a),a.forEach(u),this.h()},h(){h(e,"class","absolute top-10 left-2")},m(n,a){O(n,e,a),Q(t,e,null),r=!0},p(n,a){const i={};a&16385&&(i.$$scope={dirty:a,ctx:n}),t.$set(i)},i(n){r||(V(t.$$.fragment,n),r=!0)},o(n){L(t.$$.fragment,n),r=!1},d(n){n&&u(e),x(t)}}}function Kr(l){let e,t;return e=new Ee({props:{slot:"icon",class:"mdc-elevation--z2 hover:mdc-elevation--z8 mdc-elevation-transition left-2 top-10 rounded-full bg-blue-400 text-xl text-white",icon:hr}}),{c(){Y(e.$$.fragment)},l(r){Z(e.$$.fragment,r)},m(r,n){Q(e,r,n),t=!0},p:Ie,i(r){t||(V(e.$$.fragment,r),t=!0)},o(r){L(e.$$.fragment,r),t=!1},d(r){x(e,r)}}}function Xr(l){let e,t,r,n,a,i=(l[11].characters||"No Data")+"",s,o,c,f,g,_,p=Ae(l[11].lastBookOpen)+"",k,C,y,E,d,m,P=Ae(l[11].lastBookmarkModified)+"",I,b,v,M,X,W,ee=Ae(l[11].lastBookModified)+"",A;return{c(){e=R("div"),t=R("div"),r=le("Characters:"),n=U(),a=R("div"),s=le(i),o=U(),c=R("div"),f=le("Last Read:"),g=U(),_=R("div"),k=le(p),C=U(),y=R("div"),E=le("Bookmarked:"),d=U(),m=R("div"),I=le(P),b=U(),v=R("div"),M=le("Last Update:"),X=U(),W=R("div"),A=le(ee),this.h()},l(N){e=S(N,"DIV",{class:!0,slot:!0});var F=D(e);t=S(F,"DIV",{});var ue=D(t);r=oe(ue,"Characters:"),ue.forEach(u),n=z(F),a=S(F,"DIV",{class:!0});var he=D(a);s=oe(he,i),he.forEach(u),o=z(F),c=S(F,"DIV",{class:!0});var _e=D(c);f=oe(_e,"Last Read:"),_e.forEach(u),g=z(F),_=S(F,"DIV",{class:!0});var Be=D(_);k=oe(Be,p),Be.forEach(u),C=z(F),y=S(F,"DIV",{class:!0});var se=D(y);E=oe(se,"Bookmarked:"),se.forEach(u),d=z(F),m=S(F,"DIV",{class:!0});var me=D(m);I=oe(me,P),me.forEach(u),b=z(F),v=S(F,"DIV",{class:!0});var fe=D(v);M=oe(fe,"Last Update:"),fe.forEach(u),X=z(F),W=S(F,"DIV",{class:!0});var Me=D(W);A=oe(Me,ee),Me.forEach(u),F.forEach(u),this.h()},h(){h(a,"class","w-40"),h(c,"class","mt-4"),h(_,"class","w-40"),h(y,"class","mt-4"),h(m,"class","w-40"),h(v,"class","mt-4"),h(W,"class","w-40"),h(e,"class","p-4"),h(e,"slot","content")},m(N,F){O(N,e,F),w(e,t),w(t,r),w(e,n),w(e,a),w(a,s),w(e,o),w(e,c),w(c,f),w(e,g),w(e,_),w(_,k),w(e,C),w(e,y),w(y,E),w(e,d),w(e,m),w(m,I),w(e,b),w(e,v),w(v,M),w(e,X),w(e,W),w(W,A)},p(N,F){F&1&&i!==(i=(N[11].characters||"No Data")+"")&&ye(s,i),F&1&&p!==(p=Ae(N[11].lastBookOpen)+"")&&ye(k,p),F&1&&P!==(P=Ae(N[11].lastBookmarkModified)+"")&&ye(I,P),F&1&&ee!==(ee=Ae(N[11].lastBookModified)+"")&&ye(A,ee)},d(N){N&&u(e)}}}function $t(l){let e,t,r,n,a;function i(){return l[8](l[11])}return{c(){e=R("div"),t=be("svg"),r=be("path"),this.h()},l(s){e=S(s,"DIV",{class:!0});var o=D(e);t=we(o,"svg",{role:!0,class:!0,xmlns:!0,viewBox:!0});var c=D(t);r=we(c,"path",{class:!0,d:!0}),D(r).forEach(u),c.forEach(u),o.forEach(u),this.h()},h(){h(r,"class","fill-current text-white"),h(r,"d","M369.6 313.1c4.7 4.7 4.7 12.3 0 17L330 369.6c-4.7 4.7-12.3 4.7-17 0L248 304l-65.1 65.6c-4.7 4.7-12.3 4.7-17 0L126.4 330c-4.7-4.7-4.7-12.3 0-17l65.6-65-65.6-65.1c-4.7-4.7-4.7-12.3 0-17l39.6-39.6c4.7-4.7 12.3-4.7 17 0l65 65.7 65.1-65.6c4.7-4.7 12.3-4.7 17 0l39.6 39.6c4.7 4.7 4.7 12.3 0 17L304 248l65.6 65.1z"),h(t,"role","img"),h(t,"class","w-full"),h(t,"xmlns","http://www.w3.org/2000/svg"),h(t,"viewBox","0 0 504 504"),h(e,"class","mdc-elevation--z2 hover:mdc-elevation--z8 mdc-elevation-transition absolute -top-2 -right-2 h-6 w-6 cursor-pointer rounded-full bg-red-400")},m(s,o){O(s,e,o),w(e,t),w(t,r),n||(a=[G(e,"click",i),G(e,"keyup",De)],n=!0)},p(s,o){l=s},d(s){s&&u(e),n=!1,ie(a)}}}function Ut(l,e){let t,r,n,a,i=e[2].has(e[11].id),s,o=e[2].has(e[11].id),c,f,g,_,p;const k=[e[11]];function C(){return e[6](e[11])}let y={};for(let I=0;I<k.length;I+=1)y=Yt(y,k[I]);n=new Wr({props:y}),n.$on("click",C);let E=i&&Lt(e),d=o&&Nt(e),m=e[11].id===e[3]&&$t(e);function P(){return e[9](e[11])}return{key:l,first:null,c(){t=R("div"),r=R("div"),Y(n.$$.fragment),a=U(),E&&E.c(),s=U(),d&&d.c(),c=U(),m&&m.c(),f=U(),this.h()},l(I){t=S(I,"DIV",{class:!0});var b=D(t);r=S(b,"DIV",{class:!0});var v=D(r);Z(n.$$.fragment,v),a=z(v),E&&E.l(v),v.forEach(u),s=z(b),d&&d.l(b),c=z(b),m&&m.l(b),f=z(b),b.forEach(u),this.h()},h(){h(r,"class","mdc-elevation--z1 hover:mdc-elevation--z8 mdc-elevation-transition relative overflow-hidden"),$(r,"rounded-tl-xl",e[11].id===e[1]),$(r,"mdc-elevation--z4",e[2].has(e[11].id)||e[11].id===e[1]),h(t,"class","relative"),$(t,"opacity-60",e[11].isPlaceholder),this.first=t},m(I,b){O(I,t,b),w(t,r),Q(n,r,null),w(r,a),E&&E.m(r,null),w(t,s),d&&d.m(t,null),w(t,c),m&&m.m(t,null),w(t,f),g=!0,_||(p=[G(t,"mouseenter",P),G(t,"mouseleave",e[10])],_=!0)},p(I,b){e=I;const v=b&1?Zt(k,[Qt(e[11])]):{};n.$set(v),b&5&&(i=e[2].has(e[11].id)),i?E?(E.p(e,b),b&5&&V(E,1)):(E=Lt(e),E.c(),V(E,1),E.m(r,null)):E&&(de(),L(E,1,1,()=>{E=null}),pe()),(!g||b&3)&&$(r,"rounded-tl-xl",e[11].id===e[1]),(!g||b&7)&&$(r,"mdc-elevation--z4",e[2].has(e[11].id)||e[11].id===e[1]),b&5&&(o=e[2].has(e[11].id)),o?d?(d.p(e,b),b&5&&V(d,1)):(d=Nt(e),d.c(),V(d,1),d.m(t,c)):d&&(de(),L(d,1,1,()=>{d=null}),pe()),e[11].id===e[3]?m?m.p(e,b):(m=$t(e),m.c(),m.m(t,f)):m&&(m.d(1),m=null),(!g||b&1)&&$(t,"opacity-60",e[11].isPlaceholder)},i(I){g||(V(n.$$.fragment,I),V(E),V(d),g=!0)},o(I){L(n.$$.fragment,I),L(E),L(d),g=!1},d(I){I&&u(t),x(n),E&&E.d(),d&&d.d(),m&&m.d(),_=!1,ie(p)}}}function Jr(l){let e,t=[],r=new Map,n,a=l[0];const i=s=>s[11].id;for(let s=0;s<a.length;s+=1){let o=At(l,a,s),c=i(o);r.set(c,t[s]=Ut(c,o))}return{c(){e=R("div");for(let s=0;s<t.length;s+=1)t[s].c();this.h()},l(s){e=S(s,"DIV",{class:!0});var o=D(e);for(let c=0;c<t.length;c+=1)t[c].l(o);o.forEach(u),this.h()},h(){h(e,"class","grid grid-cols-3 justify-between gap-5 pb-4 md:grid-cols-4 lg:grid-cols-5")},m(s,o){O(s,e,o);for(let c=0;c<t.length;c+=1)t[c].m(e,null);n=!0},p(s,[o]){o&63&&(a=s[0],de(),t=xe(t,o,i,1,s,a,r,e,kt,Ut,null,At),pe())},i(s){if(!n){for(let o=0;o<a.length;o+=1)V(t[o]);n=!0}},o(s){for(let o=0;o<t.length;o+=1)L(t[o]);n=!1},d(s){s&&u(e);for(let o=0;o<t.length;o+=1)t[o].d()}}}function Ae(l){return l?new Date(l).toLocaleString():"No Data"}function Yr(l,e,t){let{bookCards:r=[]}=e,{currentBookId:n}=e,{selectedBookIds:a}=e;const i=bt();let s;function o(k){i("bookClick",{id:k})}const c=k=>o(k.id),f=k=>o(k.id),g=k=>i("removeBookClick",{id:k.id}),_=k=>t(3,s=k.id),p=()=>t(3,s=void 0);return l.$$set=k=>{"bookCards"in k&&t(0,r=k.bookCards),"currentBookId"in k&&t(1,n=k.currentBookId),"selectedBookIds"in k&&t(2,a=k.selectedBookIds)},[r,n,a,s,i,o,c,f,g,_,p]}class Zr extends Oe{constructor(e){super(),Ve(this,e,Yr,Jr,Se,{bookCards:0,currentBookId:1,selectedBookIds:2})}}function Qr(l){l.setAttribute("webkitdirectory","")}function Ke(l,e){const t=()=>{var r;(r=l.files)!=null&&r.length&&(e(l.files),l.value="")};return l.addEventListener("change",t),{destroy(){l.removeEventListener("change",t)}}}function zt(l,e,t){const r=l.slice();r[49]=e[t];const n=r[16][r[8]].property===r[49].property;r[50]=n;const a=r[50]&&r[16][r[8]].direction===Ge.ASC;return r[51]=a,r}function Ft(l,e,t){const r=l.slice();return r[54]=e[t],r}function xr(l){let e,t,r,n,a,i,s,o,c,f;return t=new Ye({props:{contentText:l[4],contentStyles:"padding: 0.75rem",eventType:"pointer",$$slots:{default:[tl]},$$scope:{ctx:l}}}),{c(){e=R("div"),Y(t.$$.fragment),r=U(),n=R("progress"),a=U(),i=R("div"),s=le(l[7]),this.h()},l(g){e=S(g,"DIV",{class:!0});var _=D(e);Z(t.$$.fragment,_),r=z(_),n=S(_,"PROGRESS",{class:!0,max:!0}),D(n).forEach(u),a=z(_),i=S(_,"DIV",{class:!0});var p=D(i);s=oe(p,l[7]),p.forEach(u),_.forEach(u),this.h()},h(){h(n,"class","mx-4 w-full"),n.value=l[5],h(n,"max",l[6]),h(i,"class","ml-4 min-w-fit"),h(e,"class","mx-auto flex h-full transform-gpu items-center justify-center px-4 md:px-8 lg:max-w-4xl xl:max-w-none 2xl:max-w-6xl")},m(g,_){O(g,e,_),Q(t,e,null),w(e,r),w(e,n),w(e,a),w(e,i),w(i,s),f=!0},p(g,_){l=g;const p={};_[0]&16&&(p.contentText=l[4]),_[1]&67108864&&(p.$$scope={dirty:_,ctx:l}),t.$set(p),(!f||_[0]&32)&&(n.value=l[5]),(!f||_[0]&64)&&h(n,"max",l[6]),(!f||_[0]&128)&&ye(s,l[7])},i(g){f||(V(t.$$.fragment,g),ge(()=>{c&&c.end(1),o=ve(e,te,l[21]),o.start()}),f=!0)},o(g){L(t.$$.fragment,g),o&&o.invalidate(),c=ke(e,te,l[22]),f=!1},d(g){g&&u(e),x(t),g&&c&&c.end()}}}function el(l){let e,t,r,n,a,i,s,o,c,f,g;const _=[ll,rl],p=[];function k(P,I){return P[2]===0?0:1}t=k(l),r=p[t]=_[t](l);const C=[nl,ol],y=[];function E(P,I){return P[0]?1:0}i=E(l),s=y[i]=C[i](l);let d=!l[0]&&jt(l),m=l[2]>0&&Kt(l);return{c(){e=R("div"),r.c(),n=U(),a=R("div"),s.c(),o=U(),c=R("div"),d&&d.c(),f=U(),m&&m.c(),this.h()},l(P){e=S(P,"DIV",{class:!0});var I=D(e);r.l(I),n=z(I),a=S(I,"DIV",{class:!0});var b=D(a);s.l(b),b.forEach(u),o=z(I),c=S(I,"DIV",{class:!0});var v=D(c);d&&d.l(v),f=z(v),m&&m.l(v),v.forEach(u),I.forEach(u),this.h()},h(){h(a,"class","absolute left-1/2 h-full -translate-x-1/2 transform-gpu"),h(c,"class","flex transform-gpu "+Or),h(e,"class","flex h-full justify-between "+rr)},m(P,I){O(P,e,I),p[t].m(e,null),w(e,n),w(e,a),y[i].m(a,null),w(e,o),w(e,c),d&&d.m(c,null),w(c,f),m&&m.m(c,null),g=!0},p(P,I){let b=t;t=k(P),t===b?p[t].p(P,I):(de(),L(p[b],1,1,()=>{p[b]=null}),pe(),r=p[t],r?r.p(P,I):(r=p[t]=_[t](P),r.c()),V(r,1),r.m(e,n));let v=i;i=E(P),i===v?y[i].p(P,I):(de(),L(y[v],1,1,()=>{y[v]=null}),pe(),s=y[i],s?s.p(P,I):(s=y[i]=C[i](P),s.c()),V(s,1),s.m(a,null)),P[0]?d&&(de(),L(d,1,1,()=>{d=null}),pe()):d?(d.p(P,I),I[0]&1&&V(d,1)):(d=jt(P),d.c(),V(d,1),d.m(c,f)),P[2]>0?m?(m.p(P,I),I[0]&4&&V(m,1)):(m=Kt(P),m.c(),V(m,1),m.m(c,null)):m&&(de(),L(m,1,1,()=>{m=null}),pe())},i(P){g||(V(r),V(s),V(d),V(m),g=!0)},o(P){L(r),L(s),L(d),L(m),g=!1},d(P){P&&u(e),p[t].d(),y[i].d(),d&&d.d(),m&&m.d()}}}function tl(l){let e,t,r,n,a;return t=new Ee({props:{icon:_r,class:"cursor-pointer"}}),{c(){e=R("div"),Y(t.$$.fragment)},l(i){e=S(i,"DIV",{});var s=D(e);Z(t.$$.fragment,s),s.forEach(u)},m(i,s){O(i,e,s),Q(t,e,null),r=!0,n||(a=[G(e,"click",l[48]),G(e,"keyup",De)],n=!0)},p:Ie,i(i){r||(V(t.$$.fragment,i),r=!0)},o(i){L(t.$$.fragment,i),r=!1},d(i){i&&u(e),x(t),n=!1,ie(a)}}}function rl(l){let e,t,r,n,a,i,s,o,c,f,g,_,p;return r=new Ee({props:{icon:vr}}),{c(){e=R("div"),t=R("div"),Y(r.$$.fragment),i=U(),s=R("span"),o=le(l[2]),this.h()},l(k){e=S(k,"DIV",{class:!0});var C=D(e);t=S(C,"DIV",{class:!0});var y=D(t);Z(r.$$.fragment,y),y.forEach(u),i=z(C),s=S(C,"SPAN",{class:!0});var E=D(s);o=oe(E,l[2]),E.forEach(u),C.forEach(u),this.h()},h(){h(t,"class","flex h-full items-center text-2xl xl:text-xl "+Vr+" cursor-pointer"),h(s,"class","translate-x-2 transform-gpu"),h(e,"class","flex h-full transform-gpu items-center "+Mr+" text-xl font-medium")},m(k,C){O(k,e,C),w(e,t),Q(r,t,null),w(e,i),w(e,s),w(s,o),g=!0,_||(p=[G(t,"click",l[37]),G(t,"keyup",De)],_=!0)},p(k,C){l=k,(!g||C[0]&4)&&ye(o,l[2])},i(k){g||(V(r.$$.fragment,k),ge(()=>{a&&a.end(1),n=ve(t,te,l[21]),n.start()}),ge(()=>{f&&f.end(1),c=ve(s,te,l[21]),c.start()}),g=!0)},o(k){L(r.$$.fragment,k),n&&n.invalidate(),a=ke(t,te,l[22]),c&&c.invalidate(),f=ke(s,te,l[22]),g=!1},d(k){k&&u(e),x(r),k&&a&&a.end(),k&&f&&f.end(),_=!1,ie(p)}}}function ll(l){let e,t,r,n,a,i,s,o;return{c(){e=R("div"),t=be("svg"),r=be("path"),this.h()},l(c){e=S(c,"DIV",{class:!0});var f=D(e);t=we(f,"svg",{viewBox:!0,xmlns:!0,class:!0});var g=D(t);r=we(g,"path",{class:!0,d:!0}),D(r).forEach(u),g.forEach(u),f.forEach(u),this.h()},h(){h(r,"class","fill-current"),h(r,"d","M20,4v12H8V4H20 M20,2H8C6.9,2,6,2.9,6,4v12c0,1.1,0.9,2,2,2h12c1.1,0,2-0.9,2-2V4C22,2.9,21.1,2,20,2L20,2z M12.47,14 L9,10.5l1.4-1.41l2.07,2.08L17.6,6L19,7.41L12.47,14z M4,6H2v14c0,1.1,0.9,2,2,2h14v-2H4V6z"),h(t,"viewBox","0 0 24 24"),h(t,"xmlns","http://www.w3.org/2000/svg"),h(t,"class",Pe),$(t,"opacity-100",l[0]),$(t,"opacity-60",!l[0]),h(e,"class","transform-gpu "+pl)},m(c,f){O(c,e,f),w(e,t),w(t,r),i=!0,s||(o=[G(t,"click",l[36]),G(t,"keyup",De)],s=!0)},p(c,f){l=c,(!i||f[0]&1)&&$(t,"opacity-100",l[0]),(!i||f[0]&1)&&$(t,"opacity-60",!l[0])},i(c){i||(ge(()=>{a&&a.end(1),n=ve(e,te,l[21]),n.start()}),i=!0)},o(c){n&&n.invalidate(),a=ke(e,te,l[22]),i=!1},d(c){c&&u(e),c&&a&&a.end(),s=!1,ie(o)}}}function ol(l){let e,t,r,n,a,i,s;return{c(){e=be("svg"),t=be("path"),this.h()},l(o){e=we(o,"svg",{xmlns:!0,viewBox:!0,class:!0});var c=D(e);t=we(c,"path",{class:!0,d:!0}),D(t).forEach(u),c.forEach(u),this.h()},h(){h(t,"class","fill-current"),h(t,"d","M18 7l-1.41-1.41-6.34 6.34 1.41 1.41L18 7zm4.24-1.41L11.66 16.17 7.48 12l-1.41 1.41L11.66 19l12-12-1.42-1.41zM.41 13.41L6 19l1.41-1.41L1.83 12 .41 13.41z"),h(e,"xmlns","http://www.w3.org/2000/svg"),h(e,"viewBox","0 0 24 24"),h(e,"class",Pe)},m(o,c){O(o,e,c),w(e,t),a=!0,i||(s=[G(e,"click",l[39]),G(e,"keyup",De)],i=!0)},p(o,c){l=o},i(o){a||(ge(()=>{n&&n.end(1),r=ve(e,te,l[21]),r.start()}),a=!0)},o(o){r&&r.invalidate(),n=ke(e,te,l[22]),a=!1},d(o){o&&u(e),o&&n&&n.end(),i=!1,ie(s)}}}function nl(l){let e,t,r=l[1]&&Gt(l);return{c(){r&&r.c(),e=Je()},l(n){r&&r.l(n),e=Je()},m(n,a){r&&r.m(n,a),O(n,e,a),t=!0},p(n,a){n[1]?r?(r.p(n,a),a[0]&2&&V(r,1)):(r=Gt(n),r.c(),V(r,1),r.m(e.parentNode,e)):r&&(de(),L(r,1,1,()=>{r=null}),pe())},i(n){t||(V(r),t=!0)},o(n){L(r),t=!1},d(n){r&&r.d(n),n&&u(e)}}}function Gt(l){let e,t,r,n,a,i,s;return{c(){e=be("svg"),t=be("path"),this.h()},l(o){e=we(o,"svg",{xmlns:!0,viewBox:!0,class:!0});var c=D(e);t=we(c,"path",{class:!0,d:!0}),D(t).forEach(u),c.forEach(u),this.h()},h(){h(t,"class","fill-current"),h(t,"d","M21 5c-1.11-.35-2.33-.5-3.5-.5-1.95 0-4.05.4-5.5 1.5-1.45-1.1-3.55-1.5-5.5-1.5S2.45 4.9 1 6v14.65c0 .25.25.5.5.5.1 0 .15-.05.25-.05C3.1 20.45 5.05 20 6.5 20c1.95 0 4.05.4 5.5 1.5 1.35-.85 3.8-1.5 5.5-1.5 1.65 0 3.35.3 4.75 1.05.1.05.15.05.25.05.25 0 .5-.25.5-.5V6c-.6-.45-1.25-.75-2-1zm0 13.5c-1.1-.35-2.3-.5-3.5-.5-1.7 0-4.15.65-5.5 1.5V8c1.35-.85 3.8-1.5 5.5-1.5 1.2 0 2.4.15 3.5.5v11.5zm-3.5-8c.88 0 1.73.09 2.5.26V9.24c-.79-.15-1.64-.24-2.5-.24-1.7 0-3.24.29-4.5.83v1.66c1.13-.64 2.7-.99 4.5-.99zM13 12.49v1.66c1.13-.64 2.7-.99 4.5-.99.88 0 1.73.09 2.5.26V11.9c-.79-.15-1.64-.24-2.5-.24-1.7 0-3.24.3-4.5.83zm4.5 1.84c-1.7 0-3.24.29-4.5.83v1.66c1.13-.64 2.7-.99 4.5-.99.88 0 1.73.09 2.5.26v-1.52c-.79-.16-1.64-.24-2.5-.24z"),h(e,"xmlns","http://www.w3.org/2000/svg"),h(e,"viewBox","0 0 24 24"),h(e,"class",Pe)},m(o,c){O(o,e,c),w(e,t),a=!0,i||(s=[G(e,"click",l[38]),G(e,"keyup",De)],i=!0)},p(o,c){l=o},i(o){a||(ge(()=>{n&&n.end(1),r=ve(e,te,l[21]),r.start()}),a=!0)},o(o){r&&r.invalidate(),n=ke(e,te,l[22]),a=!1},d(o){o&&u(e),o&&n&&n.end(),i=!1,ie(s)}}}function jt(l){let e,t,r,n,a,i,s,o,c,f,g,_,p,k,C,y,E,d,m,P;t=new Dt({props:{items:l[23],mergeTo:re.FILE_IMPORT}}),t.$on("action",l[25]);let I={placement:"bottom",fallbackPlacements:["bottom-end","bottom-start"],yOffset:0,$$slots:{content:[il],icon:[sl]},$$scope:{ctx:l}};s=new Ye({props:I}),l[41](s);let b={placement:"bottom",fallbackPlacements:["bottom-end","bottom-start"],yOffset:0,$$slots:{content:[ul],icon:[fl]},$$scope:{ctx:l}};return _=new Ye({props:b}),l[44](_),E=new Dt({props:{items:l[14]?[re.MANAGE,re.DOMAIN_HINT,re.BUG_REPORT,re.SETTINGS]:[re.MANAGE,re.BUG_REPORT,re.SETTINGS]}}),E.$on("action",l[45]),{c(){e=R("div"),Y(t.$$.fragment),a=U(),i=R("div"),Y(s.$$.fragment),f=U(),g=R("div"),Y(_.$$.fragment),C=U(),y=R("div"),Y(E.$$.fragment),this.h()},l(v){e=S(v,"DIV",{class:!0});var M=D(e);Z(t.$$.fragment,M),M.forEach(u),a=z(v),i=S(v,"DIV",{class:!0});var X=D(i);Z(s.$$.fragment,X),X.forEach(u),f=z(v),g=S(v,"DIV",{class:!0});var W=D(g);Z(_.$$.fragment,W),W.forEach(u),C=z(v),y=S(v,"DIV",{class:!0});var ee=D(y);Z(E.$$.fragment,ee),ee.forEach(u),this.h()},h(){h(e,"class","relative transform-gpu"),h(i,"class","relative transform-gpu"),h(g,"class","relative transform-gpu"),h(y,"class","relative transform-gpu")},m(v,M){O(v,e,M),Q(t,e,null),O(v,a,M),O(v,i,M),Q(s,i,null),O(v,f,M),O(v,g,M),Q(_,g,null),O(v,C,M),O(v,y,M),Q(E,y,null),P=!0},p(v,M){l=v;const X={};M[0]&921856|M[1]&67108864&&(X.$$scope={dirty:M,ctx:l}),s.$set(X);const W={};M[0]&98560|M[1]&67108864&&(W.$$scope={dirty:M,ctx:l}),_.$set(W);const ee={};M[0]&16384&&(ee.items=l[14]?[re.MANAGE,re.DOMAIN_HINT,re.BUG_REPORT,re.SETTINGS]:[re.MANAGE,re.BUG_REPORT,re.SETTINGS]),E.$set(ee)},i(v){P||(V(t.$$.fragment,v),ge(()=>{n&&n.end(1),r=ve(e,te,l[21]),r.start()}),V(s.$$.fragment,v),ge(()=>{c&&c.end(1),o=ve(i,te,l[21]),o.start()}),V(_.$$.fragment,v),ge(()=>{k&&k.end(1),p=ve(g,te,l[21]),p.start()}),V(E.$$.fragment,v),ge(()=>{m&&m.end(1),d=ve(y,te,l[21]),d.start()}),P=!0)},o(v){L(t.$$.fragment,v),r&&r.invalidate(),n=ke(e,te,l[22]),L(s.$$.fragment,v),o&&o.invalidate(),c=ke(i,te,l[22]),L(_.$$.fragment,v),p&&p.invalidate(),k=ke(g,te,l[22]),L(E.$$.fragment,v),d&&d.invalidate(),m=ke(y,te,l[22]),P=!1},d(v){v&&u(e),x(t),v&&n&&n.end(),v&&u(a),v&&u(i),l[41](null),x(s),v&&c&&c.end(),v&&u(f),v&&u(g),l[44](null),x(_),v&&k&&k.end(),v&&u(C),v&&u(y),x(E),v&&m&&m.end()}}}function Ht(l){let e,t,r,n;return{c(){e=be("svg"),t=be("path"),this.h()},l(a){e=we(a,"svg",{class:!0,xmlns:!0,viewBox:!0});var i=D(e);t=we(i,"path",{class:!0,d:!0}),D(t).forEach(u),i.forEach(u),this.h()},h(){h(t,"class","fill-current"),h(t,"d",r=l[19].d),h(e,"class",Pe),h(e,"xmlns","http://www.w3.org/2000/svg"),h(e,"viewBox",n=l[19].viewBox)},m(a,i){O(a,e,i),w(e,t)},p(a,i){i[0]&524288&&r!==(r=a[19].d)&&h(t,"d",r),i[0]&524288&&n!==(n=a[19].viewBox)&&h(e,"viewBox",n)},d(a){a&&u(e)}}}function sl(l){let e,t=l[19],r=Ht(l);return{c(){e=R("div"),r.c(),this.h()},l(n){e=S(n,"DIV",{slot:!0});var a=D(e);r.l(a),a.forEach(u),this.h()},h(){h(e,"slot","icon")},m(n,a){O(n,e,a),r.m(e,null)},p(n,a){a[0]&524288&&Se(t,t=n[19])?(r.d(1),r=Ht(n),r.c(),r.m(e,null)):r.p(n,a)},d(n){n&&u(e),r.d(n)}}}function qt(l,e){let t,r=e[54].label+"",n,a,i,s;function o(){return e[40](e[54])}return{key:l,first:null,c(){t=R("div"),n=le(r),a=U(),this.h()},l(c){t=S(c,"DIV",{role:!0,class:!0});var f=D(t);n=oe(f,r),a=z(f),f.forEach(u),this.h()},h(){h(t,"role","button"),h(t,"class","cursor-pointer px-4 py-2 text-sm hover:bg-white hover:text-gray-700"),$(t,"hover:bg-white",!e[54].requiresConnectivity||e[17]),$(t,"hover:text-gray-700",!e[54].requiresConnectivity||e[17]),$(t,"cursor-not-allowed",e[54].requiresConnectivity&&!e[17]),$(t,"text-gray-500",e[54].requiresConnectivity&&!e[17]),this.first=t},m(c,f){O(c,t,f),w(t,n),w(t,a),i||(s=[G(t,"click",o),G(t,"keyup",De)],i=!0)},p(c,f){e=c,f[0]&16908288&&$(t,"hover:bg-white",!e[54].requiresConnectivity||e[17]),f[0]&16908288&&$(t,"hover:text-gray-700",!e[54].requiresConnectivity||e[17]),f[0]&16908288&&$(t,"cursor-not-allowed",e[54].requiresConnectivity&&!e[17]),f[0]&16908288&&$(t,"text-gray-500",e[54].requiresConnectivity&&!e[17])},d(c){c&&u(t),i=!1,ie(s)}}}function il(l){let e,t=[],r=new Map,n=l[24];const a=i=>i[54].key;for(let i=0;i<n.length;i+=1){let s=Ft(l,n,i),o=a(s);r.set(o,t[i]=qt(o,s))}return{c(){e=R("div");for(let i=0;i<t.length;i+=1)t[i].c();this.h()},l(i){e=S(i,"DIV",{class:!0,slot:!0});var s=D(e);for(let o=0;o<t.length;o+=1)t[o].l(s);s.forEach(u),this.h()},h(){h(e,"class","w-28 bg-gray-700"),h(e,"slot","content")},m(i,s){O(i,e,s);for(let o=0;o<t.length;o+=1)t[o].m(e,null)},p(i,s){s[0]&17174784&&(n=i[24],t=xe(t,s,a,1,i,n,r,e,ir,qt,null,Ft))},d(i){i&&u(e);for(let s=0;s<t.length;s+=1)t[s].d()}}}function al(l){let e,t;return e=new Ee({props:{icon:wr}}),{c(){Y(e.$$.fragment)},l(r){Z(e.$$.fragment,r)},m(r,n){Q(e,r,n),t=!0},p:Ie,i(r){t||(V(e.$$.fragment,r),t=!0)},o(r){L(e.$$.fragment,r),t=!1},d(r){x(e,r)}}}function cl(l){let e,t;return e=new Ee({props:{icon:Er}}),{c(){Y(e.$$.fragment)},l(r){Z(e.$$.fragment,r)},m(r,n){Q(e,r,n),t=!0},p:Ie,i(r){t||(V(e.$$.fragment,r),t=!0)},o(r){L(e.$$.fragment,r),t=!1},d(r){x(e,r)}}}function fl(l){let e,t,r,n;const a=[cl,al],i=[];function s(o,c){return o[16][o[8]].direction===Ge.ASC?0:1}return t=s(l),r=i[t]=a[t](l),{c(){e=R("div"),r.c(),this.h()},l(o){e=S(o,"DIV",{slot:!0,class:!0});var c=D(e);r.l(c),c.forEach(u),this.h()},h(){h(e,"slot","icon"),h(e,"class",Pe)},m(o,c){O(o,e,c),i[t].m(e,null),n=!0},p(o,c){let f=t;t=s(o),t===f?i[t].p(o,c):(de(),L(i[f],1,1,()=>{i[f]=null}),pe(),r=i[t],r?r.p(o,c):(r=i[t]=a[t](o),r.c()),V(r,1),r.m(e,null))},i(o){n||(V(r),n=!0)},o(o){L(r),n=!1},d(o){o&&u(e),i[t].d()}}}function Wt(l,e){let t,r,n,a,i,s=e[49].label+"",o,c,f,g,_,p,k,C;n=new Ee({props:{icon:kr,class:"px-4"}});function y(){return e[42](e[49])}g=new Ee({props:{icon:br,class:"mt-1 px-4"}});function E(){return e[43](e[49])}return{key:l,first:null,c(){t=R("div"),r=R("div"),Y(n.$$.fragment),a=U(),i=R("div"),o=le(s),c=U(),f=R("div"),Y(g.$$.fragment),_=U(),this.h()},l(d){t=S(d,"DIV",{class:!0});var m=D(t);r=S(m,"DIV",{class:!0,role:!0});var P=D(r);Z(n.$$.fragment,P),P.forEach(u),a=z(m),i=S(m,"DIV",{class:!0});var I=D(i);o=oe(I,s),I.forEach(u),c=z(m),f=S(m,"DIV",{class:!0,role:!0});var b=D(f);Z(g.$$.fragment,b),b.forEach(u),_=z(m),m.forEach(u),this.h()},h(){h(r,"class","self-center justify-self-start"),h(r,"role","button"),$(r,"text-red-500",e[51]),$(r,"hover:text-gray-700",e[51]),$(r,"hover:text-red-500",!e[51]),h(i,"class","py-2"),h(f,"class","justify-self-end hover:text-red-500"),h(f,"role","button"),$(f,"text-red-500",e[50]&&!e[51]),$(f,"hover:text-gray-700",e[50]&&!e[51]),$(f,"hover:text-red-500",!e[50]||e[51]),h(t,"class","grid cursor-default grid-cols-[auto_auto_auto] text-sm hover:bg-white hover:text-gray-700"),$(t,"bg-white",e[50]),$(t,"text-gray-700",e[50]),$(t,"hover:opacity-70",e[50]),this.first=t},m(d,m){O(d,t,m),w(t,r),Q(n,r,null),w(t,a),w(t,i),w(i,o),w(t,c),w(t,f),Q(g,f,null),w(t,_),p=!0,k||(C=[G(r,"click",y),G(r,"keyup",hl),G(f,"click",E),G(f,"keyup",_l)],k=!0)},p(d,m){e=d,(!p||m[0]&98560)&&$(r,"text-red-500",e[51]),(!p||m[0]&98560)&&$(r,"hover:text-gray-700",e[51]),(!p||m[0]&98560)&&$(r,"hover:text-red-500",!e[51]),(!p||m[0]&32768)&&s!==(s=e[49].label+"")&&ye(o,s),(!p||m[0]&98560)&&$(f,"text-red-500",e[50]&&!e[51]),(!p||m[0]&98560)&&$(f,"hover:text-gray-700",e[50]&&!e[51]),(!p||m[0]&98560)&&$(f,"hover:text-red-500",!e[50]||e[51]),(!p||m[0]&98560)&&$(t,"bg-white",e[50]),(!p||m[0]&98560)&&$(t,"text-gray-700",e[50]),(!p||m[0]&98560)&&$(t,"hover:opacity-70",e[50])},i(d){p||(V(n.$$.fragment,d),V(g.$$.fragment,d),p=!0)},o(d){L(n.$$.fragment,d),L(g.$$.fragment,d),p=!1},d(d){d&&u(t),x(n),x(g),k=!1,ie(C)}}}function ul(l){let e,t=[],r=new Map,n,a=l[15];const i=s=>s[49].property;for(let s=0;s<a.length;s+=1){let o=zt(l,a,s),c=i(o);r.set(c,t[s]=Wt(c,o))}return{c(){e=R("div");for(let s=0;s<t.length;s+=1)t[s].c();this.h()},l(s){e=S(s,"DIV",{class:!0,slot:!0});var o=D(e);for(let c=0;c<t.length;c+=1)t[c].l(o);o.forEach(u),this.h()},h(){h(e,"class","w-44 bg-gray-700"),h(e,"slot","content")},m(s,o){O(s,e,o);for(let c=0;c<t.length;c+=1)t[c].m(e,null);n=!0},p(s,o){o[0]&268534016&&(a=s[15],de(),t=xe(t,o,i,1,s,a,r,e,kt,Wt,null,zt),pe())},i(s){if(!n){for(let o=0;o<a.length;o+=1)V(t[o]);n=!0}},o(s){for(let o=0;o<t.length;o+=1)L(t[o]);n=!1},d(s){s&&u(e);for(let o=0;o<t.length;o+=1)t[o].d()}}}function Kt(l){let e,t,r,n,a,i,s,o,c,f,g,_;return t=new Ee({props:{icon:mr}}),s=new Ee({props:{icon:gr}}),{c(){e=R("div"),Y(t.$$.fragment),a=U(),i=R("div"),Y(s.$$.fragment),this.h()},l(p){e=S(p,"DIV",{class:!0});var k=D(e);Z(t.$$.fragment,k),k.forEach(u),a=z(p),i=S(p,"DIV",{class:!0});var C=D(i);Z(s.$$.fragment,C),C.forEach(u),this.h()},h(){h(e,"class","transform-gpu "+Pe),h(i,"class","transform-gpu "+Pe)},m(p,k){O(p,e,k),Q(t,e,null),O(p,a,k),O(p,i,k),Q(s,i,null),f=!0,g||(_=[G(e,"click",l[46]),G(e,"keyup",De),G(i,"click",l[47]),G(i,"keyup",De)],g=!0)},p(p,k){l=p},i(p){f||(V(t.$$.fragment,p),ge(()=>{n&&n.end(1),r=ve(e,te,l[21]),r.start()}),V(s.$$.fragment,p),ge(()=>{c&&c.end(1),o=ve(i,te,l[21]),o.start()}),f=!0)},o(p){L(t.$$.fragment,p),r&&r.invalidate(),n=ke(e,te,l[22]),L(s.$$.fragment,p),o&&o.invalidate(),c=ke(i,te,l[22]),f=!1},d(p){p&&u(e),x(t),p&&n&&n.end(),p&&u(a),p&&u(i),x(s),p&&c&&c.end(),g=!1,ie(_)}}}function dl(l){let e,t,r,n,a,i,s,o,c,f,g,_;const p=[el,xr],k=[];function C(y,E){return y[6]?1:0}return o=C(l),c=k[o]=p[o](l),{c(){e=R("input"),t=U(),r=R("input"),n=U(),a=R("input"),i=U(),s=R("div"),c.c(),this.h()},l(y){e=S(y,"INPUT",{type:!0,accept:!0}),t=z(y),r=S(y,"INPUT",{type:!0}),n=z(y),a=S(y,"INPUT",{type:!0,accept:!0}),i=z(y),s=S(y,"DIV",{class:!0});var E=D(s);c.l(E),E.forEach(u),this.h()},h(){e.hidden=!0,e.multiple=!0,h(e,"type","file"),h(e,"accept",".htmlz,.epub"),r.hidden=!0,r.multiple=!0,h(r,"type","file"),a.hidden=!0,h(a,"type","file"),h(a,"accept",".zip"),h(s,"class",Rr)},m(y,E){O(y,e,E),l[33](e),O(y,t,E),O(y,r,E),l[34](r),O(y,n,E),O(y,a,E),l[35](a),O(y,i,E),O(y,s,E),k[o].m(s,null),f=!0,g||(_=[Fe(Ke.call(null,e,l[26])),Fe(Qr.call(null,r)),Fe(Ke.call(null,r,l[26])),Fe(Ke.call(null,a,l[27]))],g=!0)},p(y,E){let d=o;o=C(y),o===d?k[o].p(y,E):(de(),L(k[d],1,1,()=>{k[d]=null}),pe(),c=k[o],c?c.p(y,E):(c=k[o]=p[o](y),c.c()),V(c,1),c.m(s,null))},i(y){f||(V(c),f=!0)},o(y){L(c),f=!1},d(y){y&&u(e),l[33](null),y&&u(t),y&&u(r),l[34](null),y&&u(n),y&&u(a),l[35](null),y&&u(i),y&&u(s),k[o].d(),g=!1,ie(_)}}}const pl="-translate-x-3 xl:-translate-x-2.5",hl=()=>{},_l=()=>{};function ml(l,e,t){let r,n,a,i,s,o,c,f,g,_;J(l,Ze,T=>t(8,n=T)),J(l,Qe,T=>t(16,a=T)),J(l,xt,T=>t(29,i=T)),J(l,er,T=>t(30,s=T)),J(l,tr,T=>t(31,o=T)),J(l,Sr,T=>t(32,c=T)),J(l,wt,T=>t(17,f=T)),J(l,mt,T=>t(18,g=T)),J(l,Tr,T=>t(19,_=T));let{hasBookOpened:p}=e,{selectMode:k}=e,{selectedCount:C}=e,{hasBooks:y}=e,{cancelTooltip:E}=e,{replicationProgress:d}=e,{replicationToProgress:m}=e,{replicationProgressRemaining:P}=e;const I=bt(),b={delay:150,duration:150,easing:Ct},v={duration:150,easing:Ct},M=[re.FILE_IMPORT],X=[{label:"Browser",key:j.BROWSER,requiresConnectivity:!1}];let W,ee,A,N,F,ue=!1;function he(T){switch(T.detail){case re.FOLDER_IMPORT.label:ee.click();break;case re.BACKUP_IMPORT.label:A.click();break;default:W.click();break}}function _e(T){I("filesChange",T)}function Be(T){I("importBackup",T[0])}function se(T,qe){const{property:ft,direction:B}=a[n];(ft!==T||B!==qe)&&Qe.next({...a,[n]:{property:T,direction:qe}}),F.toggleOpen()}function me(T){Ce[T?"unshift":"push"](()=>{W=T,t(9,W)})}function fe(T){Ce[T?"unshift":"push"](()=>{ee=T,t(10,ee)})}function Me(T){Ce[T?"unshift":"push"](()=>{A=T,t(11,A)})}const et=()=>t(0,k=y&&!k),Ne=()=>t(0,k=!k),je=()=>I("backToBookClick"),tt=()=>I("selectAllClick"),rt=async T=>{T.requiresConnectivity&&!f||(T.key!==n&&(g||Te(window,T.key).clearData(),Ze.next(T.key)),N.toggleOpen())};function lt(T){Ce[T?"unshift":"push"](()=>{N=T,t(12,N)})}const ot=T=>{se(T.property,Ge.ASC)},He=T=>{se(T.property,Ge.DESC)};function nt(T){Ce[T?"unshift":"push"](()=>{F=T,t(13,F)})}const st=({detail:T})=>{T===re.BUG_REPORT.label&&I("bugReportClick"),T===re.DOMAIN_HINT.label&&I("domainHintClick")},it=()=>I("replicateData"),at=()=>I("removeClick"),ct=()=>I("cancelReplication");return l.$$set=T=>{"hasBookOpened"in T&&t(1,p=T.hasBookOpened),"selectMode"in T&&t(0,k=T.selectMode),"selectedCount"in T&&t(2,C=T.selectedCount),"hasBooks"in T&&t(3,y=T.hasBooks),"cancelTooltip"in T&&t(4,E=T.cancelTooltip),"replicationProgress"in T&&t(5,d=T.replicationProgress),"replicationToProgress"in T&&t(6,m=T.replicationToProgress),"replicationProgressRemaining"in T&&t(7,P=T.replicationProgressRemaining)},l.$$.update=()=>{l.$$.dirty[0]&1610612736|l.$$.dirty[1]&3&&(t(14,ue=Pr(window)),M.push(...c?[re.BACKUP_IMPORT]:[re.FOLDER_IMPORT,re.BACKUP_IMPORT]),X.push(...Le(j.GDRIVE,o,window)?[{label:"GDrive",key:j.GDRIVE,requiresConnectivity:!0}]:[],...Le(j.ONEDRIVE,s,window)?[{label:"OneDrive",key:j.ONEDRIVE,requiresConnectivity:!0}]:[],...Le(j.FS,i,window)?[{label:"Filesystem",key:j.FS,requiresConnectivity:!1}]:[])),l.$$.dirty[0]&256&&t(15,r=[...n===j.BROWSER?[{property:"id",label:"Added (id)"}]:[],{property:"title",label:"Title"},{property:"characters",label:"Characters"},{property:"lastBookModified",label:"Last Update"},{property:"lastBookOpen",label:"Last Read"},{property:"progress",label:"Progress"},{property:"lastBookmarkModified",label:"Bookmarked"}])},[k,p,C,y,E,d,m,P,n,W,ee,A,N,F,ue,r,a,f,g,_,I,b,v,M,X,he,_e,Be,se,i,s,o,c,me,fe,Me,et,Ne,je,tt,rt,lt,ot,He,nt,st,it,at,ct]}class gl extends Oe{constructor(e){super(),Ve(this,e,ml,dl,Se,{hasBookOpened:1,selectMode:0,selectedCount:2,hasBooks:3,cancelTooltip:4,replicationProgress:5,replicationToProgress:6,replicationProgressRemaining:7},null,[-1,-1])}}function vl(l){let e,t,r,n,a,i,s,o;return{c(){e=R("div"),t=be("svg"),r=be("path"),n=U(),a=R("div"),i=le(l[4]),this.h()},l(c){e=S(c,"DIV",{class:!0});var f=D(e);t=we(f,"svg",{class:!0,xmlns:!0,viewBox:!0});var g=D(t);r=we(g,"path",{class:!0,d:!0}),D(r).forEach(u),g.forEach(u),n=z(f),a=S(f,"DIV",{class:!0});var _=D(a);i=oe(_,l[4]),_.forEach(u),f.forEach(u),this.h()},h(){h(r,"class","fill-current"),h(r,"d",l[2]),h(t,"class","inline-block h-8 w-8 md:h-14 md:w-14 lg:h-20 lg:w-20"),h(t,"xmlns","http://www.w3.org/2000/svg"),h(t,"viewBox",l[3]),h(a,"class","mt-2"),h(e,"class","cursor-pointer border border-transparent py-4 text-center hover:border hover:border-current"),$(e,"border-current",l[0]),$(e,"opacity-5",l[1]),$(e,"cursor-not-allowed",l[1]),$(e,"hover:border-transparent",l[1])},m(c,f){O(c,e,f),w(e,t),w(t,r),w(e,n),w(e,a),w(a,i),s||(o=[G(e,"click",l[5]),G(e,"keyup",l[6])],s=!0)},p(c,[f]){f&4&&h(r,"d",c[2]),f&8&&h(t,"viewBox",c[3]),f&16&&ye(i,c[4]),f&1&&$(e,"border-current",c[0]),f&2&&$(e,"opacity-5",c[1]),f&2&&$(e,"cursor-not-allowed",c[1]),f&2&&$(e,"hover:border-transparent",c[1])},i:Ie,o:Ie,d(c){c&&u(e),s=!1,ie(o)}}}function kl(l,e,t){let{selected:r}=e,{disabled:n}=e,{d:a}=e,{viewBox:i}=e,{label:s}=e;function o(f){Xe.call(this,l,f)}function c(f){Xe.call(this,l,f)}return l.$$set=f=>{"selected"in f&&t(0,r=f.selected),"disabled"in f&&t(1,n=f.disabled),"d"in f&&t(2,a=f.d),"viewBox"in f&&t(3,i=f.viewBox),"label"in f&&t(4,s=f.label)},[r,n,a,i,s,o,c]}class bl extends Oe{constructor(e){super(),Ve(this,e,kl,vl,Se,{selected:0,disabled:1,d:2,viewBox:3,label:4})}}function Xt(l,e,t){const r=l.slice();r[9]=e[t];const n=r[4](r[9].source)&&!r[3];return r[10]=n,r}function Jt(l,e){let t,r,n;const a=[e[9],{disabled:e[10]},{selected:e[9].source===e[0]}];function i(){return e[5](e[10],e[9])}let s={};for(let o=0;o<a.length;o+=1)s=Yt(s,a[o]);return r=new bl({props:s}),r.$on("click",i),{key:l,first:null,c(){t=Je(),Y(r.$$.fragment),this.h()},l(o){t=Je(),Z(r.$$.fragment,o),this.h()},h(){this.first=t},m(o,c){O(o,t,c),Q(r,o,c),n=!0},p(o,c){e=o;const f=c&29?Zt(a,[c&4&&Qt(e[9]),c&28&&{disabled:e[10]},c&5&&{selected:e[9].source===e[0]}]):{};r.$set(f)},i(o){n||(V(r.$$.fragment,o),n=!0)},o(o){L(r.$$.fragment,o),n=!1},d(o){o&&u(t),x(r,o)}}}function wl(l){let e,t,r,n,a=[],i=new Map,s,o,c,f,g,_,p,k,C,y,E,d,m,P,I,b,v,M,X,W=l[2];const ee=A=>A[9].source;for(let A=0;A<W.length;A+=1){let N=Xt(l,W,A),F=ee(N);i.set(F,a[A]=Jt(F,N))}return{c(){e=R("h2"),t=le("Export Target"),r=U(),n=R("div");for(let A=0;A<a.length;A+=1)a[A].c();s=U(),o=R("h2"),c=le("Export Content"),f=U(),g=R("div"),_=R("div"),p=R("input"),k=U(),C=R("label"),y=le("Book Data"),E=U(),d=R("div"),m=R("input"),P=U(),I=R("label"),b=le("Bookmark"),this.h()},l(A){e=S(A,"H2",{class:!0});var N=D(e);t=oe(N,"Export Target"),N.forEach(u),r=z(A),n=S(A,"DIV",{class:!0});var F=D(n);for(let fe=0;fe<a.length;fe+=1)a[fe].l(F);F.forEach(u),s=z(A),o=S(A,"H2",{class:!0});var ue=D(o);c=oe(ue,"Export Content"),ue.forEach(u),f=z(A),g=S(A,"DIV",{class:!0});var he=D(g);_=S(he,"DIV",{class:!0});var _e=D(_);p=S(_e,"INPUT",{type:!0,id:!0,name:!0}),k=z(_e),C=S(_e,"LABEL",{for:!0});var Be=D(C);y=oe(Be,"Book Data"),Be.forEach(u),_e.forEach(u),E=z(he),d=S(he,"DIV",{});var se=D(d);m=S(se,"INPUT",{type:!0,id:!0,name:!0}),P=z(se),I=S(se,"LABEL",{for:!0});var me=D(I);b=oe(me,"Bookmark"),me.forEach(u),se.forEach(u),he.forEach(u),this.h()},h(){h(e,"class","mb-4 text-xl font-medium"),h(n,"class","mb-4 grid grid-cols-2 gap-8"),h(o,"class","mb-2 text-xl font-medium"),h(p,"type","checkbox"),h(p,"id","bookdata"),h(p,"name","data"),p.__value="data",p.value=p.__value,l[7][0].push(p),h(C,"for","bookdata"),h(_,"class","mr-4"),h(m,"type","checkbox"),h(m,"id","bookprogress"),h(m,"name","bookmark"),m.__value="bookmark",m.value=m.__value,l[7][0].push(m),h(I,"for","bookprogress"),h(g,"class","grid grid-cols-2 gap-4 md:grid-cols-4")},m(A,N){O(A,e,N),w(e,t),O(A,r,N),O(A,n,N);for(let F=0;F<a.length;F+=1)a[F].m(n,null);O(A,s,N),O(A,o,N),w(o,c),O(A,f,N),O(A,g,N),w(g,_),w(_,p),p.checked=~l[1].indexOf(p.__value),w(_,k),w(_,C),w(C,y),w(g,E),w(g,d),w(d,m),m.checked=~l[1].indexOf(m.__value),w(d,P),w(d,I),w(I,b),v=!0,M||(X=[G(p,"change",l[6]),G(m,"change",l[8])],M=!0)},p(A,[N]){N&29&&(W=A[2],de(),a=xe(a,N,ee,1,A,W,i,n,kt,Jt,null,Xt),pe()),N&2&&(p.checked=~A[1].indexOf(p.__value)),N&2&&(m.checked=~A[1].indexOf(m.__value))},i(A){if(!v){for(let N=0;N<W.length;N+=1)V(a[N]);v=!0}},o(A){for(let N=0;N<a.length;N+=1)L(a[N]);v=!1},d(A){A&&u(e),A&&u(r),A&&u(n);for(let N=0;N<a.length;N+=1)a[N].d();A&&u(s),A&&u(o),A&&u(f),A&&u(g),l[7][0].splice(l[7][0].indexOf(p),1),l[7][0].splice(l[7][0].indexOf(m),1),M=!1,ie(X)}}}function El(l,e,t){let r;J(l,wt,_=>t(3,r=_));let{icons:n}=e,{target:a}=e,{dataToReplicate:i}=e;function s(_){return _===j.GDRIVE||_===j.ONEDRIVE}ar(()=>{n.find(_=>_.source===a)||t(0,a=j.BACKUP)});const o=[[]],c=(_,p)=>{_||t(0,a=p.source)};function f(){i=It(o[0],this.__value,this.checked),t(1,i)}function g(){i=It(o[0],this.__value,this.checked),t(1,i)}return l.$$set=_=>{"icons"in _&&t(2,n=_.icons),"target"in _&&t(0,a=_.target),"dataToReplicate"in _&&t(1,i=_.dataToReplicate)},l.$$.update=()=>{l.$$.dirty&13&&!r&&s(a)&&t(0,a=n.find(_=>_.source===j.BACKUP)?j.BACKUP:j.BROWSER)},[a,i,n,r,s,c,f,o,g]}class Bl extends Oe{constructor(e){super(),Ve(this,e,El,wl,Se,{icons:2,target:0,dataToReplicate:1})}}function Il(l){let e,t,r,n;function a(o){l[10](o)}function i(o){l[11](o)}let s={icons:l[0]};return l[2]!==void 0&&(s.target=l[2]),l[1]!==void 0&&(s.dataToReplicate=l[1]),e=new Bl({props:s}),Ce.push(()=>ht(e,"target",a)),Ce.push(()=>ht(e,"dataToReplicate",i)),{c(){Y(e.$$.fragment)},l(o){Z(e.$$.fragment,o)},m(o,c){Q(e,o,c),n=!0},p(o,c){const f={};c&1&&(f.icons=o[0]),!t&&c&4&&(t=!0,f.target=o[2],_t(()=>t=!1)),!r&&c&2&&(r=!0,f.dataToReplicate=o[1],_t(()=>r=!1)),e.$set(f)},i(o){n||(V(e.$$.fragment,o),n=!0)},o(o){L(e.$$.fragment,o),n=!1},d(o){x(e,o)}}}function yl(l){let e,t,r,n,a,i,s,o,c,f,g,_;return n=new Rt({}),o=new Rt({}),{c(){e=R("div"),t=R("button"),r=le(`Cancel
      `),Y(n.$$.fragment),a=U(),i=R("button"),s=le(`Start
      `),Y(o.$$.fragment),this.h()},l(p){e=S(p,"DIV",{class:!0,slot:!0});var k=D(e);t=S(k,"BUTTON",{class:!0});var C=D(t);r=oe(C,`Cancel
      `),Z(n.$$.fragment,C),C.forEach(u),a=z(k),i=S(k,"BUTTON",{class:!0});var y=D(i);s=oe(y,`Start
      `),Z(o.$$.fragment,y),y.forEach(u),k.forEach(u),this.h()},h(){h(t,"class",St),h(i,"class",St),i.disabled=c=!l[1].length,$(i,"cursor-not-allowed",!l[1].length),h(e,"class","flex grow justify-between"),h(e,"slot","footer")},m(p,k){O(p,e,k),w(e,t),w(t,r),Q(n,t,null),w(e,a),w(e,i),w(i,s),Q(o,i,null),f=!0,g||(_=[G(t,"click",l[9]),G(i,"click",l[4])],g=!0)},p(p,k){(!f||k&2&&c!==(c=!p[1].length))&&(i.disabled=c),(!f||k&2)&&$(i,"cursor-not-allowed",!p[1].length)},i(p){f||(V(n.$$.fragment,p),V(o.$$.fragment,p),f=!0)},o(p){L(n.$$.fragment,p),L(o.$$.fragment,p),f=!1},d(p){p&&u(e),x(n),x(o),g=!1,ie(_)}}}function Dl(l){let e,t;return e=new Ar({props:{$$slots:{footer:[yl],content:[Il]},$$scope:{ctx:l}}}),{c(){Y(e.$$.fragment)},l(r){Z(e.$$.fragment,r)},m(r,n){Q(e,r,n),t=!0},p(r,[n]){const a={};n&4103&&(a.$$scope={dirty:n,ctx:r}),e.$set(a)},i(r){t||(V(e.$$.fragment,r),t=!0)},o(r){L(e.$$.fragment,r),t=!1},d(r){x(e,r)}}}function Cl(l,e,t){let r,n,a,i,s,o;J(l,Ze,C=>t(5,r=C)),J(l,xt,C=>t(6,n=C)),J(l,er,C=>t(7,a=C)),J(l,tr,C=>t(8,i=C)),J(l,gt,C=>t(1,s=C)),J(l,vt,C=>t(2,o=C));let c=[{...$e(j.BACKUP),source:j.BACKUP,label:"Zip File"},{...$e(j.BROWSER),source:j.BROWSER,label:"Browser DB"}];const f=bt();function g(){lr.next(),f("close")}const _=()=>f("close");function p(C){o=C,vt.set(o)}function k(C){s=C,gt.set(s)}return l.$$.update=()=>{l.$$.dirty&481&&t(0,c=[...c,...Le(j.GDRIVE,i,window)?[{...$e(j.GDRIVE),source:j.GDRIVE,label:"GDrive"}]:[],...Le(j.ONEDRIVE,a,window)?[{...$e(j.ONEDRIVE),source:j.ONEDRIVE,label:"OneDrive"}]:[],...Le(j.FS,n,window)?[{...$e(j.FS),source:j.FS,label:"Filesystem"}]:[]].filter(C=>C.source!==r))},[c,s,o,f,g,r,n,a,i,_,p,k]}class Rl extends Oe{constructor(e){super(),Ve(this,e,Cl,Dl,Se,{})}}function dt(l,e){const t=new Set(l);return e(t),t}async function or(l){if(Sl(l)){const t=l.createReader(),r=await nr(t);return(await Promise.all(r.map(a=>or(a)))).flat()}return[await new Promise((t,r)=>{l.file(t,r)})]}async function nr(l){const e=await new Promise((r,n)=>{l.readEntries(r,n)});if(!e.length)return[];const t=await nr(l);return e.concat(t)}function Sl(l){return l.isDirectory}async function Tl(l){var r;if(!((r=l.dataTransfer)!=null&&r.items))return[];const e=Array.from(l.dataTransfer.items).filter(n=>n.kind==="file").map(n=>n.webkitGetAsEntry()).filter(n=>!!n);return e.length?(await Promise.all(e.map(n=>or(n)))).flat():[]}function Pl(l,e){return new Map(l.map(t=>[t[e],t]))}const{document:pt}=fr;function Ol(l){let e,t,r,n,a,i,s,o,c;return r=new Ee({props:{icon:Br,style:"width: 100%; height: auto"}}),{c(){e=R("div"),t=R("div"),Y(r.$$.fragment),n=U(),a=R("label"),i=R("input"),this.h()},l(f){e=S(f,"DIV",{class:!0});var g=D(e);t=S(g,"DIV",{class:!0});var _=D(t);Z(r.$$.fragment,_),_.forEach(u),g.forEach(u),n=z(f),a=S(f,"LABEL",{class:!0});var p=D(a);i=S(p,"INPUT",{type:!0,accept:!0}),p.forEach(u),this.h()},h(){h(t,"class","flex w-3/6 justify-center xl:w-3/12"),h(e,"class","flex justify-center pt-44 text-gray-400 text-opacity-40"),h(i,"type","file"),h(i,"accept",".htmlz,.epub"),i.multiple=!0,i.hidden=!0,h(a,"class","fixed inset-0 z-0")},m(f,g){O(f,e,g),w(e,t),Q(r,t,null),O(f,n,g),O(f,a,g),w(a,i),s=!0,o||(c=Fe(Ke.call(null,i,l[16])),o=!0)},p:Ie,i(f){s||(V(r.$$.fragment,f),s=!0)},o(f){L(r.$$.fragment,f),s=!1},d(f){f&&u(e),x(r),f&&u(n),f&&u(a),o=!1,c()}}}function Vl(l){let e,t;return e=new Zr({props:{currentBookId:l[9],selectedBookIds:l[1],bookCards:l[8]}}),e.$on("bookClick",l[30]),e.$on("removeBookClick",l[31]),{c(){Y(e.$$.fragment)},l(r){Z(e.$$.fragment,r)},m(r,n){Q(e,r,n),t=!0},p(r,n){const a={};n[0]&512&&(a.currentBookId=r[9]),n[0]&2&&(a.selectedBookIds=r[1]),n[0]&256&&(a.bookCards=r[8]),e.$set(a)},i(r){t||(V(e.$$.fragment,r),t=!0)},o(r){L(e.$$.fragment,r),t=!1},d(r){x(e,r)}}}function Ml(l){let e;return{c(){e=le("Loading...")},l(t){e=oe(t,"Loading...")},m(t,r){O(t,e,r)},p:Ie,i:Ie,o:Ie,d(t){t&&u(e)}}}function Al(l){var I;let e,t,r=(l[10]??"")+"",n,a,i,s,o,c,f,g,_,p,k,C;pt.title=e=yt("Book Manager");function y(b){l[25](b)}let E={hasBookOpened:!!l[9],selectedCount:l[1].size,hasBooks:!!((I=l[8])!=null&&I.length),cancelTooltip:l[4],replicationProgress:l[5],replicationToProgress:l[6],replicationProgressRemaining:l[7]};l[0]!==void 0&&(E.selectMode=l[0]),s=new gl({props:E}),Ce.push(()=>ht(s,"selectMode",y)),s.$on("selectAllClick",l[17]),s.$on("backToBookClick",l[18]),s.$on("removeClick",l[26]),s.$on("filesChange",l[27]),s.$on("domainHintClick",l[21]),s.$on("bugReportClick",l[22]),s.$on("cancelReplication",l[28]),s.$on("replicateData",l[23]),s.$on("importBackup",l[29]);const d=[Ml,Vl,Ol],m=[];function P(b,v){return!b[8]||b[11]?0:b[8].length?1:2}return g=P(l),_=m[g]=d[g](l),{c(){t=U(),n=le(r),a=U(),i=R("div"),Y(s.$$.fragment),c=U(),f=R("div"),_.c(),this.h()},l(b){cr("svelte-1u9ti14",pt.head).forEach(u),t=z(b),n=oe(b,r),a=z(b),i=S(b,"DIV",{class:!0});var M=D(i);Z(s.$$.fragment,M),M.forEach(u),c=z(b),f=S(b,"DIV",{class:!0});var X=D(f);_.l(X),X.forEach(u),this.h()},h(){h(i,"class","elevation-4 fixed inset-x-0 top-0 z-10"),h(f,"class",rr+" h-full pt-16 xl:pt-14")},m(b,v){O(b,t,v),O(b,n,v),O(b,a,v),O(b,i,v),Q(s,i,null),O(b,c,v),O(b,f,v),m[g].m(f,null),p=!0,k||(C=[G(f,"dragenter",$l),G(f,"dragover",Ul),G(f,"dragend",zl),G(f,"drop",Fl),G(f,"drop",l[32])],k=!0)},p(b,v){var W;(!p||v&0)&&e!==(e=yt("Book Manager"))&&(pt.title=e),(!p||v[0]&1024)&&r!==(r=(b[10]??"")+"")&&ye(n,r);const M={};v[0]&512&&(M.hasBookOpened=!!b[9]),v[0]&2&&(M.selectedCount=b[1].size),v[0]&256&&(M.hasBooks=!!((W=b[8])!=null&&W.length)),v[0]&16&&(M.cancelTooltip=b[4]),v[0]&32&&(M.replicationProgress=b[5]),v[0]&64&&(M.replicationToProgress=b[6]),v[0]&128&&(M.replicationProgressRemaining=b[7]),!o&&v[0]&1&&(o=!0,M.selectMode=b[0],_t(()=>o=!1)),s.$set(M);let X=g;g=P(b),g===X?m[g].p(b,v):(de(),L(m[X],1,1,()=>{m[X]=null}),pe(),_=m[g],_?_.p(b,v):(_=m[g]=d[g](b),_.c()),V(_,1),_.m(f,null))},i(b){p||(V(s.$$.fragment,b),V(_),p=!0)},o(b){L(s.$$.fragment,b),L(_),p=!1},d(b){b&&u(t),b&&u(n),b&&u(a),b&&u(i),x(s),b&&u(c),b&&u(f),m[g].d(),k=!1,ie(C)}}}function Ll(l){return l!=null&&l.progress?{progress:typeof l.progress=="string"?+l.progress.slice(0,-1):l.progress,lastBookmarkModified:l.lastBookmarkModified||0}:{progress:0,lastBookmarkModified:0}}function Nl(l){return l&&Number.isFinite(l)?new Date(l*1e3).toISOString().substr(11,8):"??:??:??"}const $l=l=>l.preventDefault(),Ul=l=>l.preventDefault(),zl=l=>l.preventDefault(),Fl=l=>l.preventDefault();function Gl(l,e,t){let r,n,a,i,s,o,c,f,g,_,p,k;J(l,gt,B=>t(36,r=B)),J(l,Fr,B=>t(37,a=B)),J(l,mt,B=>t(38,i=B)),J(l,vt,B=>t(39,s=B)),J(l,Ze,B=>t(40,o=B)),J(l,wt,B=>t(41,f=B)),J(l,Gr,B=>t(42,g=B)),J(l,Qe,B=>t(43,_=B));const C=Ue.listLoading$.pipe(ut(B=>B));J(l,C,B=>t(11,k=B));const y=yr([Ue.dataList$,Ue.bookmarks$,Qe]).pipe(ut(([B,H])=>{const K=_[o],q=K.property==="title";if(o===j.BROWSER){const ae=Pl(H,"dataId");return[...B.filter(ne=>g||!ne.isPlaceholder).map(ne=>({...ne,...Ll(ae.get(ne.id))})).sort((ne,ce)=>N(ne,ce,K,q))]}return[...B.sort((ae,ne)=>N(ae,ne,K,q))]}),Tt());J(l,y,B=>t(8,n=B));const E=Ue.lastItem$.pipe(ut(B=>B==null?void 0:B.dataId),Tt());J(l,E,B=>t(9,c=B));let d=new Set,m=!1,P=new AbortController,I=P.signal,b="",v=0,M=0,X="~ ??:??:??",W=new Ot,ee=0,A;function N(B,H,K,q){const ae=B[K.property]||(q?"":0),ne=H[K.property]||(q?"":0);let ce=0;return K.direction===Ge.ASC?ce=q?B.title.localeCompare(H.title,"ja-JP",{numeric:!0}):+ae-+ne:ce=q?H.title.localeCompare(B.title,"ja-JP",{numeric:!0}):+ne-+ae,ce||(ce=B.title.localeCompare(H.title,"ja-JP",{numeric:!0})),ce}async function F(B){if(!!ue()){if(!m){Re.dialogs$.next([{component:"<div/>",disableCloseOnClick:!0}]);let H=B;try{const K=n.find(ne=>ne.id===B);if(!K)throw new Error("Book title not found");const q=o===j.BROWSER,ae=Te(window,o,"",q,i,a);mt||ae.clearData(!1),ae.startContext({id:q?K.id:0,title:K.title,imagePath:K.imagePath}),H=await ae.prepareBookForReading(),Re.dialogs$.next([])}catch(K){const q=`Error opening book: ${K.message}`;ze.warn(q),Re.dialogs$.next([{component:We,props:{title:"Error",message:q}}]);return}he(H);return}t(1,d=dt(d,H=>{if(H.has(B)){H.delete(B);return}H.add(B)}))}}function ue(){const B=!((o===j.GDRIVE||o===j.ONEDRIVE)&&!f);if(!B&&!M){const H="You have to be online for this operation";ze.warn(H),Re.dialogs$.next([{component:We,props:{title:"Failure",message:H}}])}return!M&&B}function he(B){!B||(Ue.putLastItem(B),_e(B))}async function _e(B){await dr(`${$r}/b?id=${B}`)}async function Be(B){if(!ue())return;t(4,b=`Cancels the current Import
Already imported data will not be deleted`),me();const H=/\.(?:htmlz|epub)$/,K=Array.from(B).filter(ce=>H.test(ce.name)),q="Bookimport failed";if(!K.length){fe(),se(q,"File(s) must be HTMLZ or EPUB","");return}const{error:ae,dataId:ne}=await Ur(document,Te(window,o,"",o===j.BROWSER,i,a),K,I).catch(ce=>({error:ce.message,dataId:0}));fe(),ae?se(q,ae,"Error(s) occurred during bookimport"):o===j.BROWSER&&ne&&he(ne)}function se(B,H,K){const q=ze.errorCount>1;ze.warn(H),Re.dialogs$.next([{component:q?Pt:We,props:{title:B,message:q?K:H}}])}function me(){W=new Ot,jr.pipe(Dr(W)).subscribe(ot),t(7,X="~ ??:??:??"),t(5,v=0),t(6,M=1),A=Date.now(),ze.clearHistory(),t(2,P=new AbortController),t(3,I=P.signal)}function fe(){W.next(),W.complete(),t(6,M=0),t(5,v=0),t(4,b="")}function Me(){const B=n;t(1,d=dt(d,H=>{B.forEach(K=>H.add(K.id))}))}function et(){const B=c;!B||_e(B)}async function Ne(B){if(!ue())return;t(4,b=`Cancels the Deletion
Already deleted data will not be restored`),me();const H=n.length,K=Te(window,o,""),{error:q,deleted:ae}=await K.deleteBookData(n.reduce((ne,ce)=>(B.includes(ce.id)&&ne.push(ce.title),ne),[]),I);fe(),await ur(),ae.length===H?t(0,m=!1):t(1,d=dt(d,ne=>{ae.forEach(ce=>ne.delete(ce))})),q&&se("Deletion failed",q,"Error(s) occurred during deletion")}async function je(B){if(!ue())return;const H="Import failed";if(t(4,b=`Cancels the current Import
Already imported data will not be deleted`),me(),!B.name.endsWith(".zip")){fe(),se(H,"Invalid file - expected zip archive","");return}const K=await zr(Te(window,j.BACKUP,void 0,o===j.BROWSER,i,a),Te(window,o,"",o===j.BROWSER,i,a),B,I).catch(q=>q.message);fe(),K&&se(H,K,"Error(s) occurred during import")}function tt(){Re.dialogs$.next([{component:We,props:{title:"Old Domain",message:"You are currently using the old domain of ッツ Reader - consider switching to https://reader.ttsu.app to prevent issues and to ensure full features"},disableCloseOnClick:!0}])}function rt(){Re.dialogs$.next([{component:Pt,props:{title:"Bug Report",message:"Please include the attached file for your report"}}])}function lt(){Re.dialogs$.next([{component:Rl,disableCloseOnClick:!0}])}function ot(B){if(!I.aborted){if(ee=B.progressBase||ee||0,t(6,M=B.maxProgress||M||0),B.skipStep){const H=Math.ceil(v/ee)*ee-v;t(5,v=Math.floor((v+(H||ee)+Number.EPSILON)*1e3)/1e3)}else if(B.completeStep){const H=Math.ceil(v)-v;t(5,v=Math.floor((v+H+Number.EPSILON)*1e3)/1e3)}else B.progressToAdd&&B.progressToAdd>0&&t(5,v=Math.floor((v+B.progressToAdd+Number.EPSILON)*1e3)/1e3);if(B.progressToAdd){const H=(Date.now()-A)/1e3,K=v/H,q=(M-v)/K;t(7,X=M>v?`~ ${Nl(Math.ceil(q))}`:"~ 00:00:01")}}}const He=lr.pipe(Lr(async()=>{if(!ue())return;t(4,b="Cancels the current export"),me();const B=[o,s].map(q=>Te(window,q,"",s===j.BROWSER,i,a)),H=n.filter(q=>d.has(q.id)),K=await Nr(B[0],B[1],!1,H.map(q=>({title:q.title,imagePath:q.imagePath})),r,I).catch(q=>q.message);fe(),K&&se("Export failed",K,"Error(s) occurred during export")}),Cr());J(l,He,B=>t(10,p=B));function nt(B){m=B,t(0,m)}const st=()=>Ne(Array.from(d)),it=B=>Be(B.detail),at=()=>{I.aborted||(P.abort(),t(7,X="Canceling ..."))},ct=B=>je(B.detail),T=B=>F(B.detail.id),qe=B=>Ne([B.detail.id]),ft=B=>Tl(B).then(Be);return l.$$.update=()=>{l.$$.dirty[0]&1&&(m||t(1,d=new Set))},[m,d,P,I,b,v,M,X,n,c,p,k,C,y,E,F,Be,Me,et,Ne,je,tt,rt,lt,He,nt,st,it,at,ct,T,qe,ft]}class Yl extends Oe{constructor(e){super(),Ve(this,e,Gl,Al,Se,{},null,[-1,-1])}}export{Yl as default};
