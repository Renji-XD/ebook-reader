import{S as ge,i as ve,n as ke,k as R,s as A,r as Q,l as P,m as T,c as S,f as _,u as Y,p as m,q as Fe,a as V,H as E,O as U,d as M,g as J,t as L,b as x,v as _e,X as ft,w as H,x as N,y as $,E as fe,B as K,ad as je,U as ee,$ as ut,Z as me,a2 as dt,ac as ht,T as Ue,C as pt,z as _t,A as mt,V as we,a9 as oe,aa as ne,_ as Ie,W as Te,a5 as ie,a7 as se,ae,e as Pe,af as He,a0 as Se,a1 as ze,G as yt,Y as Mt,D as Vt}from"../../chunks/index-df0cdd8f.js";import{E as Lt,ac as Ne,ad as j,D as Ot,ae as gt,B as De,af as At,C as St,ag as zt,ah as $e,S as re,ai as Ke,aj as We,ak as vt,K as qe,L as Ee,k as Ve,z as Ge,al as Ut,s as Ft,am as jt,Q as Ht,an as Nt,ao as Xe,ap as Ze,aq as $t,M as Kt,ar as Wt,as as qt}from"../../chunks/format-page-title-609e4cb2.js";import{F as he,i as Gt,P as kt,j as Xt,m as de,k as Zt,M as Qe,l as Qt,n as Yt,o as Jt,p as xt}from"../../chunks/merged-header-icon-2e70bebf.js";import{a as el,c as tl,t as Ye}from"../../chunks/index.es-8c17048e.js";import{i as ll}from"../../chunks/utils-f9d0cd9e.js";import{e as rl,d as Le}from"../../chunks/dialog-manager-cce8b3b0.js";import"../../chunks/singletons-a14e46a6.js";import"../../chunks/stores-b20e80ef.js";import"../../chunks/index-31b77272.js";function Je(r){let e,t;return e=new he({props:{class:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2",icon:el}}),{c(){H(e.$$.fragment)},l(l){N(e.$$.fragment,l)},m(l,o){$(e,l,o),t=!0},p:fe,i(l){t||(M(e.$$.fragment,l),t=!0)},o(l){L(e.$$.fragment,l),t=!1},d(l){K(e,l)}}}function xe(r){let e,t,l,o;return{c(){e=R("img"),this.h()},l(s){e=P(s,"IMG",{src:!0,class:!0,alt:!0,decoding:!0}),this.h()},h(){je(e.src,t=r[6](r[0]))||m(e,"src",t),m(e,"class","relative h-full w-full object-cover transition delay-150 duration-700 ease-out"),m(e,"alt",""),m(e,"decoding","async"),ee(e,"blur",!r[5])},m(s,c){V(s,e,c),r[8](e),l||(o=U(e,"load",r[9]),l=!0)},p(s,c){c&1&&!je(e.src,t=s[6](s[0]))&&m(e,"src",t),c&32&&ee(e,"blur",!s[5])},d(s){s&&_(e),r[8](null),l=!1,o()}}}function ol(r){let e,t,l,o,s,c,n,i,a,f,u,p,g=`${r[2]*100}%`,b,C,h,v=!r[5]&&Je(),k=r[0]&&xe(r);return{c(){e=R("div"),t=R("div"),l=R("div"),v&&v.c(),o=A(),k&&k.c(),s=A(),c=R("div"),n=R("div"),i=R("span"),a=Q(r[1]),f=A(),u=R("div"),p=R("div"),this.h()},l(d){e=P(d,"DIV",{class:!0,role:!0});var B=T(e);t=P(B,"DIV",{class:!0});var D=T(t);l=P(D,"DIV",{class:!0});var w=T(l);v&&v.l(w),o=S(w),k&&k.l(w),w.forEach(_),s=S(D),c=P(D,"DIV",{class:!0});var I=T(c);n=P(I,"DIV",{class:!0});var z=T(n);i=P(z,"SPAN",{class:!0});var W=T(i);a=Y(W,r[1]),W.forEach(_),z.forEach(_),f=S(I),u=P(I,"DIV",{class:!0});var Z=T(u);p=P(Z,"DIV",{class:!0}),T(p).forEach(_),Z.forEach(_),I.forEach(_),D.forEach(_),B.forEach(_),this.h()},h(){m(l,"class","h-full w-full text-5xl sm:text-7xl"),m(i,"class","line-clamp-3"),m(n,"class","sm:h-21 h-16 bg-gray-800 bg-opacity-80 p-0.5 px-1.5 text-justify text-sm text-white sm:p-1.5 sm:text-base"),m(p,"class","h-full rounded bg-gradient-to-b from-red-600 to-red-900"),Fe(p,"width",g,!1),m(u,"class","h-2.5 bg-gray-400 bg-opacity-80"),m(c,"class","absolute inset-x-0 bottom-0"),m(t,"class","inline"),m(e,"class","aspect-w-2 aspect-h-3 relative cursor-pointer"),m(e,"role","button")},m(d,B){V(d,e,B),E(e,t),E(t,l),v&&v.m(l,null),E(l,o),k&&k.m(l,null),E(t,s),E(t,c),E(c,n),E(n,i),E(i,a),E(c,f),E(c,u),E(u,p),b=!0,C||(h=U(e,"click",r[7]),C=!0)},p(d,[B]){d[5]?v&&(J(),L(v,1,1,()=>{v=null}),x()):v?(v.p(d,B),B&32&&M(v,1)):(v=Je(),v.c(),M(v,1),v.m(l,o)),d[0]?k?k.p(d,B):(k=xe(d),k.c(),k.m(l,null)):k&&(k.d(1),k=null),(!b||B&2)&&_e(a,d[1]),B&4&&g!==(g=`${d[2]*100}%`)&&Fe(p,"width",g,!1)},i(d){b||(M(v),b=!0)},o(d){L(v),b=!1},d(d){d&&_(e),v&&v.d(),k&&k.d(),C=!1,h()}}}function nl(r,e,t){let l,{imagePath:o}=e,{title:s}=e,{progress:c}=e,n="";ft(()=>{n&&URL.revokeObjectURL(n)});function i(h){return n&&(URL.revokeObjectURL(n),n=""),typeof h!="string"?(n=URL.createObjectURL(h),n):h}function a(){let h,v;const k=d=>h?typeof h!="object"||typeof d!="object"?h===d:h.type===d.type&&h.size===d.size:!1;return d=>(k(d)||(h=d,v=i(d)),v)}const f=a();let u,p=!0;function g(h){ut.call(this,r,h)}function b(h){me[h?"unshift":"push"](()=>{u=h,t(3,u)})}const C=()=>t(4,p=!1);return r.$$set=h=>{"imagePath"in h&&t(0,o=h.imagePath),"title"in h&&t(1,s=h.title),"progress"in h&&t(2,c=h.progress)},r.$$.update=()=>{r.$$.dirty&24&&t(5,l=(u==null?void 0:u.complete)&&!p)},[o,s,c,u,p,l,f,g,b,C]}class il extends ge{constructor(e){super(),ve(this,e,nl,ol,ke,{imagePath:0,title:1,progress:2})}}function et(r,e,t){const l=r.slice();return l[11]=e[t],l}function tt(r){let e,t,l,o,s;t=new he({props:{class:"absolute left-2 top-2 flex text-xl text-white",icon:Gt}});function c(){return r[7](r[11])}return{c(){e=R("div"),H(t.$$.fragment),this.h()},l(n){e=P(n,"DIV",{class:!0});var i=T(e);N(t.$$.fragment,i),i.forEach(_),this.h()},h(){m(e,"class","absolute inset-0 cursor-pointer bg-gray-700 bg-opacity-20")},m(n,i){V(n,e,i),$(t,e,null),l=!0,o||(s=U(e,"click",c),o=!0)},p(n,i){r=n},i(n){l||(M(t.$$.fragment,n),l=!0)},o(n){L(t.$$.fragment,n),l=!1},d(n){n&&_(e),K(t),o=!1,s()}}}function lt(r){let e,t,l;return t=new kt({props:{placement:"right",fallbackPlacements:["bottom"],yOffset:5,$$slots:{content:[al],icon:[sl]},$$scope:{ctx:r}}}),{c(){e=R("div"),H(t.$$.fragment),this.h()},l(o){e=P(o,"DIV",{class:!0});var s=T(e);N(t.$$.fragment,s),s.forEach(_),this.h()},h(){m(e,"class","absolute top-10 left-2")},m(o,s){V(o,e,s),$(t,e,null),l=!0},p(o,s){const c={};s&16385&&(c.$$scope={dirty:s,ctx:o}),t.$set(c)},i(o){l||(M(t.$$.fragment,o),l=!0)},o(o){L(t.$$.fragment,o),l=!1},d(o){o&&_(e),K(t)}}}function sl(r){let e,t;return e=new he({props:{slot:"icon",class:"mdc-elevation--z2 hover:mdc-elevation--z8 mdc-elevation-transition left-2 top-10 rounded-full bg-blue-400 text-xl text-white",icon:Xt}}),{c(){H(e.$$.fragment)},l(l){N(e.$$.fragment,l)},m(l,o){$(e,l,o),t=!0},p:fe,i(l){t||(M(e.$$.fragment,l),t=!0)},o(l){L(e.$$.fragment,l),t=!1},d(l){K(e,l)}}}function al(r){let e,t,l,o,s,c=be(r[11].lastBookOpen)+"",n,i,a,f,u,p,g=be(r[11].lastBookmarkModified)+"",b,C,h,v,k,d,B=be(r[11].lastBookModified)+"",D;return{c(){e=R("div"),t=R("div"),l=Q("Last Read:"),o=A(),s=R("div"),n=Q(c),i=A(),a=R("div"),f=Q("Bookmarked:"),u=A(),p=R("div"),b=Q(g),C=A(),h=R("div"),v=Q("Last Update:"),k=A(),d=R("div"),D=Q(B),this.h()},l(w){e=P(w,"DIV",{class:!0,slot:!0});var I=T(e);t=P(I,"DIV",{});var z=T(t);l=Y(z,"Last Read:"),z.forEach(_),o=S(I),s=P(I,"DIV",{class:!0});var W=T(s);n=Y(W,c),W.forEach(_),i=S(I),a=P(I,"DIV",{class:!0});var Z=T(a);f=Y(Z,"Bookmarked:"),Z.forEach(_),u=S(I),p=P(I,"DIV",{class:!0});var X=T(p);b=Y(X,g),X.forEach(_),C=S(I),h=P(I,"DIV",{class:!0});var ce=T(h);v=Y(ce,"Last Update:"),ce.forEach(_),k=S(I),d=P(I,"DIV",{class:!0});var le=T(d);D=Y(le,B),le.forEach(_),I.forEach(_),this.h()},h(){m(s,"class","w-40"),m(a,"class","mt-4"),m(p,"class","w-40"),m(h,"class","mt-4"),m(d,"class","w-40"),m(e,"class","p-4"),m(e,"slot","content")},m(w,I){V(w,e,I),E(e,t),E(t,l),E(e,o),E(e,s),E(s,n),E(e,i),E(e,a),E(a,f),E(e,u),E(e,p),E(p,b),E(e,C),E(e,h),E(h,v),E(e,k),E(e,d),E(d,D)},p(w,I){I&1&&c!==(c=be(w[11].lastBookOpen)+"")&&_e(n,c),I&1&&g!==(g=be(w[11].lastBookmarkModified)+"")&&_e(b,g),I&1&&B!==(B=be(w[11].lastBookModified)+"")&&_e(D,B)},d(w){w&&_(e)}}}function rt(r){let e,t,l,o,s;function c(){return r[8](r[11])}return{c(){e=R("div"),t=oe("svg"),l=oe("path"),this.h()},l(n){e=P(n,"DIV",{class:!0});var i=T(e);t=ne(i,"svg",{role:!0,class:!0,xmlns:!0,viewBox:!0});var a=T(t);l=ne(a,"path",{class:!0,d:!0}),T(l).forEach(_),a.forEach(_),i.forEach(_),this.h()},h(){m(l,"class","fill-current text-white"),m(l,"d","M369.6 313.1c4.7 4.7 4.7 12.3 0 17L330 369.6c-4.7 4.7-12.3 4.7-17 0L248 304l-65.1 65.6c-4.7 4.7-12.3 4.7-17 0L126.4 330c-4.7-4.7-4.7-12.3 0-17l65.6-65-65.6-65.1c-4.7-4.7-4.7-12.3 0-17l39.6-39.6c4.7-4.7 12.3-4.7 17 0l65 65.7 65.1-65.6c4.7-4.7 12.3-4.7 17 0l39.6 39.6c4.7 4.7 4.7 12.3 0 17L304 248l65.6 65.1z"),m(t,"role","img"),m(t,"class","w-full"),m(t,"xmlns","http://www.w3.org/2000/svg"),m(t,"viewBox","0 0 504 504"),m(e,"class","mdc-elevation--z2 hover:mdc-elevation--z8 mdc-elevation-transition absolute -top-2 -right-2 h-6 w-6 cursor-pointer rounded-full bg-red-400")},m(n,i){V(n,e,i),E(e,t),E(t,l),o||(s=U(e,"click",c),o=!0)},p(n,i){r=n},d(n){n&&_(e),o=!1,s()}}}function ot(r,e){let t,l,o,s,c=e[2].has(e[11].id),n,i=e[2].has(e[11].id),a,f,u,p,g;const b=[e[11]];function C(){return e[6](e[11])}let h={};for(let D=0;D<b.length;D+=1)h=pt(h,b[D]);o=new il({props:h}),o.$on("click",C);let v=c&&tt(e),k=i&&lt(e),d=e[11].id===e[3]&&rt(e);function B(){return e[9](e[11])}return{key:r,first:null,c(){t=R("div"),l=R("div"),H(o.$$.fragment),s=A(),v&&v.c(),n=A(),k&&k.c(),a=A(),d&&d.c(),f=A(),this.h()},l(D){t=P(D,"DIV",{class:!0});var w=T(t);l=P(w,"DIV",{class:!0});var I=T(l);N(o.$$.fragment,I),s=S(I),v&&v.l(I),I.forEach(_),n=S(w),k&&k.l(w),a=S(w),d&&d.l(w),f=S(w),w.forEach(_),this.h()},h(){m(l,"class","mdc-elevation--z1 hover:mdc-elevation--z8 mdc-elevation-transition relative overflow-hidden"),ee(l,"rounded-tl-xl",e[11].id===e[1]),ee(l,"mdc-elevation--z4",e[2].has(e[11].id)||e[11].id===e[1]),m(t,"class","relative"),this.first=t},m(D,w){V(D,t,w),E(t,l),$(o,l,null),E(l,s),v&&v.m(l,null),E(t,n),k&&k.m(t,null),E(t,a),d&&d.m(t,null),E(t,f),u=!0,p||(g=[U(t,"mouseenter",B),U(t,"mouseleave",e[10])],p=!0)},p(D,w){e=D;const I=w&1?_t(b,[mt(e[11])]):{};o.$set(I),w&5&&(c=e[2].has(e[11].id)),c?v?(v.p(e,w),w&5&&M(v,1)):(v=tt(e),v.c(),M(v,1),v.m(l,null)):v&&(J(),L(v,1,1,()=>{v=null}),x()),w&3&&ee(l,"rounded-tl-xl",e[11].id===e[1]),w&7&&ee(l,"mdc-elevation--z4",e[2].has(e[11].id)||e[11].id===e[1]),w&5&&(i=e[2].has(e[11].id)),i?k?(k.p(e,w),w&5&&M(k,1)):(k=lt(e),k.c(),M(k,1),k.m(t,a)):k&&(J(),L(k,1,1,()=>{k=null}),x()),e[11].id===e[3]?d?d.p(e,w):(d=rt(e),d.c(),d.m(t,f)):d&&(d.d(1),d=null)},i(D){u||(M(o.$$.fragment,D),M(v),M(k),u=!0)},o(D){L(o.$$.fragment,D),L(v),L(k),u=!1},d(D){D&&_(t),K(o),v&&v.d(),k&&k.d(),d&&d.d(),p=!1,we(g)}}}function cl(r){let e,t=[],l=new Map,o,s=r[0];const c=n=>n[11].id;for(let n=0;n<s.length;n+=1){let i=et(r,s,n),a=c(i);l.set(a,t[n]=ot(a,i))}return{c(){e=R("div");for(let n=0;n<t.length;n+=1)t[n].c();this.h()},l(n){e=P(n,"DIV",{class:!0});var i=T(e);for(let a=0;a<t.length;a+=1)t[a].l(i);i.forEach(_),this.h()},h(){m(e,"class","grid grid-cols-3 justify-between gap-5 pb-4 md:grid-cols-4 lg:grid-cols-5")},m(n,i){V(n,e,i);for(let a=0;a<t.length;a+=1)t[a].m(e,null);o=!0},p(n,[i]){i&63&&(s=n[0],J(),t=dt(t,i,c,1,n,s,l,e,ht,ot,null,et),x())},i(n){if(!o){for(let i=0;i<s.length;i+=1)M(t[i]);o=!0}},o(n){for(let i=0;i<t.length;i+=1)L(t[i]);o=!1},d(n){n&&_(e);for(let i=0;i<t.length;i+=1)t[i].d()}}}function be(r){return r?new Date(r).toLocaleString():"No Data"}function fl(r,e,t){let{bookCards:l=[]}=e,{currentBookId:o}=e,{selectedBookIds:s}=e;const c=Ue();let n;function i(b){c("bookClick",{id:b})}const a=b=>i(b.id),f=b=>i(b.id),u=b=>c("removeBookClick",{id:b.id}),p=b=>t(3,n=b.id),g=()=>t(3,n=void 0);return r.$$set=b=>{"bookCards"in b&&t(0,l=b.bookCards),"currentBookId"in b&&t(1,o=b.currentBookId),"selectedBookIds"in b&&t(2,s=b.selectedBookIds)},[l,o,s,n,c,i,a,f,u,p,g]}class ul extends ge{constructor(e){super(),ve(this,e,fl,cl,ke,{bookCards:0,currentBookId:1,selectedBookIds:2})}}/**
 * @license BSD-3-Clause
 * Copyright (c) 2022, ッツ Reader Authors
 * All rights reserved.
 */function dl(r){r.setAttribute("webkitdirectory","")}/**
 * @license BSD-3-Clause
 * Copyright (c) 2022, ッツ Reader Authors
 * All rights reserved.
 */function Re(r,e){const t=()=>{var l;(l=r.files)!=null&&l.length&&(e(r.files),r.value="")};return r.addEventListener("change",t),{destroy(){r.removeEventListener("change",t)}}}function hl(r){let e,t,l,o,s,c,n,i,a,f;return t=new kt({props:{contentText:r[4],contentStyles:"padding: 0.75rem",eventType:"pointer",$$slots:{default:[_l]},$$scope:{ctx:r}}}),{c(){e=R("div"),H(t.$$.fragment),l=A(),o=R("progress"),s=A(),c=R("div"),n=Q(r[7]),this.h()},l(u){e=P(u,"DIV",{class:!0});var p=T(e);N(t.$$.fragment,p),l=S(p),o=P(p,"PROGRESS",{class:!0,max:!0}),T(o).forEach(_),s=S(p),c=P(p,"DIV",{class:!0});var g=T(c);n=Y(g,r[7]),g.forEach(_),p.forEach(_),this.h()},h(){m(o,"class","mx-4 w-full"),o.value=r[5],m(o,"max",r[6]),m(c,"class","ml-4 min-w-fit"),m(e,"class","mx-auto flex h-full transform-gpu items-center justify-center px-4 md:px-8 lg:max-w-4xl xl:max-w-none 2xl:max-w-6xl")},m(u,p){V(u,e,p),$(t,e,null),E(e,l),E(e,o),E(e,s),E(e,c),E(c,n),f=!0},p(u,p){r=u;const g={};p&16&&(g.contentText=r[4]),p&1073741824&&(g.$$scope={dirty:p,ctx:r}),t.$set(g),(!f||p&32)&&(o.value=r[5]),(!f||p&64)&&m(o,"max",r[6]),(!f||p&128)&&_e(n,r[7])},i(u){f||(M(t.$$.fragment,u),ie(()=>{a&&a.end(1),i=se(e,j,r[12]),i.start()}),f=!0)},o(u){L(t.$$.fragment,u),i&&i.invalidate(),a=ae(e,j,r[13]),f=!1},d(u){u&&_(e),K(t),u&&a&&a.end()}}}function pl(r){let e,t,l,o,s,c,n,i,a,f,u;const p=[gl,ml],g=[];function b(B,D){return B[2]===0?0:1}t=b(r),l=g[t]=p[t](r);const C=[kl,vl],h=[];function v(B,D){return B[0]?1:0}c=v(r),n=h[c]=C[c](r);let k=!r[0]&&it(r),d=r[2]>0&&st(r);return{c(){e=R("div"),l.c(),o=A(),s=R("div"),n.c(),i=A(),a=R("div"),k&&k.c(),f=A(),d&&d.c(),this.h()},l(B){e=P(B,"DIV",{class:!0});var D=T(e);l.l(D),o=S(D),s=P(D,"DIV",{class:!0});var w=T(s);n.l(w),w.forEach(_),i=S(D),a=P(D,"DIV",{class:!0});var I=T(a);k&&k.l(I),f=S(I),d&&d.l(I),I.forEach(_),D.forEach(_),this.h()},h(){m(s,"class","absolute left-1/2 h-full -translate-x-1/2 transform-gpu"),m(a,"class","flex transform-gpu "+Ot),m(e,"class","flex h-full justify-between "+gt)},m(B,D){V(B,e,D),g[t].m(e,null),E(e,o),E(e,s),h[c].m(s,null),E(e,i),E(e,a),k&&k.m(a,null),E(a,f),d&&d.m(a,null),u=!0},p(B,D){let w=t;t=b(B),t===w?g[t].p(B,D):(J(),L(g[w],1,1,()=>{g[w]=null}),x(),l=g[t],l?l.p(B,D):(l=g[t]=p[t](B),l.c()),M(l,1),l.m(e,o));let I=c;c=v(B),c===I?h[c].p(B,D):(J(),L(h[I],1,1,()=>{h[I]=null}),x(),n=h[c],n?n.p(B,D):(n=h[c]=C[c](B),n.c()),M(n,1),n.m(s,null)),B[0]?k&&(J(),L(k,1,1,()=>{k=null}),x()):k?(k.p(B,D),D&1&&M(k,1)):(k=it(B),k.c(),M(k,1),k.m(a,f)),B[2]>0?d?(d.p(B,D),D&4&&M(d,1)):(d=st(B),d.c(),M(d,1),d.m(a,null)):d&&(J(),L(d,1,1,()=>{d=null}),x())},i(B){u||(M(l),M(n),M(k),M(d),u=!0)},o(B){L(l),L(n),L(k),L(d),u=!1},d(B){B&&_(e),g[t].d(),h[c].d(),k&&k.d(),d&&d.d()}}}function _l(r){let e,t,l,o,s;return t=new he({props:{icon:Zt,class:"cursor-pointer"}}),{c(){e=R("div"),H(t.$$.fragment)},l(c){e=P(c,"DIV",{});var n=T(e);N(t.$$.fragment,n),n.forEach(_)},m(c,n){V(c,e,n),$(t,e,null),l=!0,o||(s=U(e,"click",r[29]),o=!0)},p:fe,i(c){l||(M(t.$$.fragment,c),l=!0)},o(c){L(t.$$.fragment,c),l=!1},d(c){c&&_(e),K(t),o=!1,s()}}}function ml(r){let e,t,l,o,s,c,n,i,a,f,u,p,g;return l=new he({props:{icon:Jt}}),{c(){e=R("div"),t=R("div"),H(l.$$.fragment),c=A(),n=R("span"),i=Q(r[2]),this.h()},l(b){e=P(b,"DIV",{class:!0});var C=T(e);t=P(C,"DIV",{class:!0});var h=T(t);N(l.$$.fragment,h),h.forEach(_),c=S(C),n=P(C,"SPAN",{class:!0});var v=T(n);i=Y(v,r[2]),v.forEach(_),C.forEach(_),this.h()},h(){m(t,"class","flex h-full items-center text-2xl xl:text-xl "+At+" cursor-pointer"),m(n,"class","translate-x-2 transform-gpu"),m(e,"class","flex h-full transform-gpu items-center "+St+" text-xl font-medium")},m(b,C){V(b,e,C),E(e,t),$(l,t,null),E(e,c),E(e,n),E(n,i),u=!0,p||(g=U(t,"click",r[23]),p=!0)},p(b,C){r=b,(!u||C&4)&&_e(i,r[2])},i(b){u||(M(l.$$.fragment,b),ie(()=>{s&&s.end(1),o=se(t,j,r[12]),o.start()}),ie(()=>{f&&f.end(1),a=se(n,j,r[12]),a.start()}),u=!0)},o(b){L(l.$$.fragment,b),o&&o.invalidate(),s=ae(t,j,r[13]),a&&a.invalidate(),f=ae(n,j,r[13]),u=!1},d(b){b&&_(e),K(l),b&&s&&s.end(),b&&f&&f.end(),p=!1,g()}}}function gl(r){let e,t,l,o,s,c,n,i;return{c(){e=R("div"),t=oe("svg"),l=oe("path"),this.h()},l(a){e=P(a,"DIV",{class:!0});var f=T(e);t=ne(f,"svg",{xmlns:!0,class:!0,viewBox:!0});var u=T(t);l=ne(u,"path",{class:!0,d:!0}),T(l).forEach(_),u.forEach(_),f.forEach(_),this.h()},h(){m(l,"class","fill-current"),m(l,"d","M20,4v12H8V4H20 M20,2H8C6.9,2,6,2.9,6,4v12c0,1.1,0.9,2,2,2h12c1.1,0,2-0.9,2-2V4C22,2.9,21.1,2,20,2L20,2z M12.47,14 L9,10.5l1.4-1.41l2.07,2.08L17.6,6L19,7.41L12.47,14z M4,6H2v14c0,1.1,0.9,2,2,2h14v-2H4V6z"),m(t,"xmlns","http://www.w3.org/2000/svg"),m(t,"class",De),m(t,"viewBox","0 0 24 24"),ee(t,"opacity-100",r[0]),ee(t,"opacity-60",!r[0]),m(e,"class","transform-gpu "+wl)},m(a,f){V(a,e,f),E(e,t),E(t,l),c=!0,n||(i=U(t,"click",r[22]),n=!0)},p(a,f){r=a,f&1&&ee(t,"opacity-100",r[0]),f&1&&ee(t,"opacity-60",!r[0])},i(a){c||(ie(()=>{s&&s.end(1),o=se(e,j,r[12]),o.start()}),c=!0)},o(a){o&&o.invalidate(),s=ae(e,j,r[13]),c=!1},d(a){a&&_(e),a&&s&&s.end(),n=!1,i()}}}function vl(r){let e,t,l,o,s,c,n;return{c(){e=oe("svg"),t=oe("path"),this.h()},l(i){e=ne(i,"svg",{xmlns:!0,viewBox:!0,class:!0});var a=T(e);t=ne(a,"path",{class:!0,d:!0}),T(t).forEach(_),a.forEach(_),this.h()},h(){m(t,"class","fill-current"),m(t,"d","M18 7l-1.41-1.41-6.34 6.34 1.41 1.41L18 7zm4.24-1.41L11.66 16.17 7.48 12l-1.41 1.41L11.66 19l12-12-1.42-1.41zM.41 13.41L6 19l1.41-1.41L1.83 12 .41 13.41z"),m(e,"xmlns","http://www.w3.org/2000/svg"),m(e,"viewBox","0 0 24 24"),m(e,"class",De)},m(i,a){V(i,e,a),E(e,t),s=!0,c||(n=U(e,"click",r[25]),c=!0)},p(i,a){r=i},i(i){s||(ie(()=>{o&&o.end(1),l=se(e,j,r[12]),l.start()}),s=!0)},o(i){l&&l.invalidate(),o=ae(e,j,r[13]),s=!1},d(i){i&&_(e),i&&o&&o.end(),c=!1,n()}}}function kl(r){let e,t,l=r[1]&&nt(r);return{c(){l&&l.c(),e=Pe()},l(o){l&&l.l(o),e=Pe()},m(o,s){l&&l.m(o,s),V(o,e,s),t=!0},p(o,s){o[1]?l?(l.p(o,s),s&2&&M(l,1)):(l=nt(o),l.c(),M(l,1),l.m(e.parentNode,e)):l&&(J(),L(l,1,1,()=>{l=null}),x())},i(o){t||(M(l),t=!0)},o(o){L(l),t=!1},d(o){l&&l.d(o),o&&_(e)}}}function nt(r){let e,t,l,o,s,c,n;return{c(){e=oe("svg"),t=oe("path"),this.h()},l(i){e=ne(i,"svg",{xmlns:!0,viewBox:!0,class:!0});var a=T(e);t=ne(a,"path",{class:!0,d:!0}),T(t).forEach(_),a.forEach(_),this.h()},h(){m(t,"class","fill-current"),m(t,"d","M21 5c-1.11-.35-2.33-.5-3.5-.5-1.95 0-4.05.4-5.5 1.5-1.45-1.1-3.55-1.5-5.5-1.5S2.45 4.9 1 6v14.65c0 .25.25.5.5.5.1 0 .15-.05.25-.05C3.1 20.45 5.05 20 6.5 20c1.95 0 4.05.4 5.5 1.5 1.35-.85 3.8-1.5 5.5-1.5 1.65 0 3.35.3 4.75 1.05.1.05.15.05.25.05.25 0 .5-.25.5-.5V6c-.6-.45-1.25-.75-2-1zm0 13.5c-1.1-.35-2.3-.5-3.5-.5-1.7 0-4.15.65-5.5 1.5V8c1.35-.85 3.8-1.5 5.5-1.5 1.2 0 2.4.15 3.5.5v11.5zm-3.5-8c.88 0 1.73.09 2.5.26V9.24c-.79-.15-1.64-.24-2.5-.24-1.7 0-3.24.29-4.5.83v1.66c1.13-.64 2.7-.99 4.5-.99zM13 12.49v1.66c1.13-.64 2.7-.99 4.5-.99.88 0 1.73.09 2.5.26V11.9c-.79-.15-1.64-.24-2.5-.24-1.7 0-3.24.3-4.5.83zm4.5 1.84c-1.7 0-3.24.29-4.5.83v1.66c1.13-.64 2.7-.99 4.5-.99.88 0 1.73.09 2.5.26v-1.52c-.79-.16-1.64-.24-2.5-.24z"),m(e,"xmlns","http://www.w3.org/2000/svg"),m(e,"viewBox","0 0 24 24"),m(e,"class",De)},m(i,a){V(i,e,a),E(e,t),s=!0,c||(n=U(e,"click",r[24]),c=!0)},p(i,a){r=i},i(i){s||(ie(()=>{o&&o.end(1),l=se(e,j,r[12]),l.start()}),s=!0)},o(i){l&&l.invalidate(),o=ae(e,j,r[13]),s=!1},d(i){i&&_(e),i&&o&&o.end(),c=!1,n()}}}function it(r){let e,t,l,o,s,c,n,i,a,f;return t=new Qe({props:{items:r[14],mergeTo:de.FILE_IMPORT}}),t.$on("action",r[15]),n=new Qe({}),n.$on("action",r[26]),{c(){e=R("div"),H(t.$$.fragment),s=A(),c=R("div"),H(n.$$.fragment),this.h()},l(u){e=P(u,"DIV",{class:!0});var p=T(e);N(t.$$.fragment,p),p.forEach(_),s=S(u),c=P(u,"DIV",{class:!0});var g=T(c);N(n.$$.fragment,g),g.forEach(_),this.h()},h(){m(e,"class","relative transform-gpu"),m(c,"class","relative transform-gpu")},m(u,p){V(u,e,p),$(t,e,null),V(u,s,p),V(u,c,p),$(n,c,null),f=!0},p(u,p){r=u},i(u){f||(M(t.$$.fragment,u),ie(()=>{o&&o.end(1),l=se(e,j,r[12]),l.start()}),M(n.$$.fragment,u),ie(()=>{a&&a.end(1),i=se(c,j,r[12]),i.start()}),f=!0)},o(u){L(t.$$.fragment,u),l&&l.invalidate(),o=ae(e,j,r[13]),L(n.$$.fragment,u),i&&i.invalidate(),a=ae(c,j,r[13]),f=!1},d(u){u&&_(e),K(t),u&&o&&o.end(),u&&_(s),u&&_(c),K(n),u&&a&&a.end()}}}function st(r){let e,t,l,o,s,c,n,i,a,f,u,p;return t=new he({props:{icon:Qt}}),n=new he({props:{icon:Yt}}),{c(){e=R("div"),H(t.$$.fragment),s=A(),c=R("div"),H(n.$$.fragment),this.h()},l(g){e=P(g,"DIV",{class:!0});var b=T(e);N(t.$$.fragment,b),b.forEach(_),s=S(g),c=P(g,"DIV",{class:!0});var C=T(c);N(n.$$.fragment,C),C.forEach(_),this.h()},h(){m(e,"class","transform-gpu "+De),m(c,"class","transform-gpu "+De)},m(g,b){V(g,e,b),$(t,e,null),V(g,s,b),V(g,c,b),$(n,c,null),f=!0,u||(p=[U(e,"click",r[27]),U(c,"click",r[28])],u=!0)},p(g,b){r=g},i(g){f||(M(t.$$.fragment,g),ie(()=>{o&&o.end(1),l=se(e,j,r[12]),l.start()}),M(n.$$.fragment,g),ie(()=>{a&&a.end(1),i=se(c,j,r[12]),i.start()}),f=!0)},o(g){L(t.$$.fragment,g),l&&l.invalidate(),o=ae(e,j,r[13]),L(n.$$.fragment,g),i&&i.invalidate(),a=ae(c,j,r[13]),f=!1},d(g){g&&_(e),K(t),g&&o&&o.end(),g&&_(s),g&&_(c),K(n),g&&a&&a.end(),u=!1,we(p)}}}function bl(r){let e,t,l,o,s,c,n,i,a,f,u,p;const g=[pl,hl],b=[];function C(h,v){return h[6]?1:0}return i=C(r),a=b[i]=g[i](r),{c(){e=R("input"),t=A(),l=R("input"),o=A(),s=R("input"),c=A(),n=R("div"),a.c(),this.h()},l(h){e=P(h,"INPUT",{type:!0,accept:!0}),t=S(h),l=P(h,"INPUT",{type:!0}),o=S(h),s=P(h,"INPUT",{type:!0,accept:!0}),c=S(h),n=P(h,"DIV",{class:!0});var v=T(n);a.l(v),v.forEach(_),this.h()},h(){e.hidden=!0,e.multiple=!0,m(e,"type","file"),m(e,"accept",".htmlz,.epub"),l.hidden=!0,l.multiple=!0,m(l,"type","file"),s.hidden=!0,m(s,"type","file"),m(s,"accept",".zip"),m(n,"class",Lt)},m(h,v){V(h,e,v),r[19](e),V(h,t,v),V(h,l,v),r[20](l),V(h,o,v),V(h,s,v),r[21](s),V(h,c,v),V(h,n,v),b[i].m(n,null),f=!0,u||(p=[Ie(Re.call(null,e,r[16])),Ie(dl.call(null,l)),Ie(Re.call(null,l,r[16])),Ie(Re.call(null,s,r[17]))],u=!0)},p(h,[v]){let k=i;i=C(h),i===k?b[i].p(h,v):(J(),L(b[k],1,1,()=>{b[k]=null}),x(),a=b[i],a?a.p(h,v):(a=b[i]=g[i](h),a.c()),M(a,1),a.m(n,null))},i(h){f||(M(a),f=!0)},o(h){L(a),f=!1},d(h){h&&_(e),r[19](null),h&&_(t),h&&_(l),r[20](null),h&&_(o),h&&_(s),r[21](null),h&&_(c),h&&_(n),b[i].d(),u=!1,we(p)}}}const wl="-translate-x-3 xl:-translate-x-2.5";function Bl(r,e,t){let l;Te(r,ll,O=>t(18,l=O));let{hasBookOpened:o}=e,{selectMode:s}=e,{selectedCount:c}=e,{hasBooks:n}=e,{cancelTooltip:i}=e,{replicationProgress:a}=e,{replicationToProgress:f}=e,{replicationProgressRemaining:u}=e;const p=Ue(),g={delay:150,duration:150,easing:Ne},b={duration:150,easing:Ne},C=[de.FILE_IMPORT];let h,v,k;function d(O){switch(O.detail){case de.FOLDER_IMPORT.label:v.click();break;case de.BACKUP_IMPORT.label:k.click();break;default:h.click();break}}function B(O){p("filesChange",O)}function D(O){p("importBackup",O[0])}function w(O){me[O?"unshift":"push"](()=>{h=O,t(8,h)})}function I(O){me[O?"unshift":"push"](()=>{v=O,t(9,v)})}function z(O){me[O?"unshift":"push"](()=>{k=O,t(10,k)})}const W=()=>t(0,s=n&&!s),Z=()=>t(0,s=!s),X=()=>p("backToBookClick"),ce=()=>p("selectAllClick"),le=({detail:O})=>{O===de.BUG_REPORT.label&&p("bugReportClick")},Be=()=>p("replicateBookData"),Ce=()=>p("removeClick"),ye=()=>p("cancelReplication");return r.$$set=O=>{"hasBookOpened"in O&&t(1,o=O.hasBookOpened),"selectMode"in O&&t(0,s=O.selectMode),"selectedCount"in O&&t(2,c=O.selectedCount),"hasBooks"in O&&t(3,n=O.hasBooks),"cancelTooltip"in O&&t(4,i=O.cancelTooltip),"replicationProgress"in O&&t(5,a=O.replicationProgress),"replicationToProgress"in O&&t(6,f=O.replicationToProgress),"replicationProgressRemaining"in O&&t(7,u=O.replicationProgressRemaining)},r.$$.update=()=>{r.$$.dirty&262144&&C.push(...l?[de.BACKUP_IMPORT]:[de.FOLDER_IMPORT,de.BACKUP_IMPORT])},[s,o,c,n,i,a,f,u,h,v,k,p,g,b,C,d,B,D,l,w,I,z,W,Z,X,ce,le,Be,Ce,ye]}class El extends ge{constructor(e){super(),ve(this,e,Bl,bl,ke,{hasBookOpened:1,selectMode:0,selectedCount:2,hasBooks:3,cancelTooltip:4,replicationProgress:5,replicationToProgress:6,replicationProgressRemaining:7})}}function Il(r){let e,t,l,o,s,c,n,i;return{c(){e=R("div"),t=oe("svg"),l=oe("path"),o=A(),s=R("div"),c=Q(r[1]),this.h()},l(a){e=P(a,"DIV",{class:!0});var f=T(e);t=ne(f,"svg",{class:!0,xmlns:!0,viewBox:!0});var u=T(t);l=ne(u,"path",{class:!0,d:!0}),T(l).forEach(_),u.forEach(_),o=S(f),s=P(f,"DIV",{class:!0});var p=T(s);c=Y(p,r[1]),p.forEach(_),f.forEach(_),this.h()},h(){m(l,"class","fill-current"),m(l,"d",r[0]),m(t,"class","inline-block h-24 w-24"),m(t,"xmlns","http://www.w3.org/2000/svg"),m(t,"viewBox",r[3]),m(s,"class","mt-2"),m(e,"class","mx-4 cursor-pointer border border-transparent p-10 text-center hover:border hover:border-current"),ee(e,"border-current",r[2])},m(a,f){V(a,e,f),E(e,t),E(t,l),E(e,o),E(e,s),E(s,c),n||(i=U(e,"click",r[4]),n=!0)},p(a,[f]){f&1&&m(l,"d",a[0]),f&8&&m(t,"viewBox",a[3]),f&2&&_e(c,a[1]),f&4&&ee(e,"border-current",a[2])},i:fe,o:fe,d(a){a&&_(e),n=!1,i()}}}function Dl(r,e,t){let{d:l}=e,{label:o}=e,{selected:s}=e,{viewBox:c}=e;function n(i){ut.call(this,r,i)}return r.$$set=i=>{"d"in i&&t(0,l=i.d),"label"in i&&t(1,o=i.label),"selected"in i&&t(2,s=i.selected),"viewBox"in i&&t(3,c=i.viewBox)},[l,o,s,c,n]}class Cl extends ge{constructor(e){super(),ve(this,e,Dl,Il,ke,{d:0,label:1,selected:2,viewBox:3})}}function at(r,e,t){const l=r.slice();return l[7]=e[t],l}function ct(r,e){let t,l,o;const s=[e[7],{selected:e[7].source===e[1]}];function c(){return e[3](e[7])}let n={};for(let i=0;i<s.length;i+=1)n=pt(n,s[i]);return l=new Cl({props:n}),l.$on("click",c),{key:r,first:null,c(){t=Pe(),H(l.$$.fragment),this.h()},l(i){t=Pe(),N(l.$$.fragment,i),this.h()},h(){this.first=t},m(i,a){V(i,t,a),$(l,i,a),o=!0},p(i,a){e=i;const f=a&6?_t(s,[a&4&&mt(e[7]),{selected:e[7].source===e[1]}]):{};l.$set(f)},i(i){o||(M(l.$$.fragment,i),o=!0)},o(i){L(l.$$.fragment,i),o=!1},d(i){i&&_(t),K(l,i)}}}function Tl(r){let e,t=[],l=new Map,o,s,c,n,i,a,f,u,p,g,b,C,h,v,k,d,B=r[2];const D=w=>w[7].source;for(let w=0;w<B.length;w+=1){let I=at(r,B,w),z=D(I);l.set(z,t[w]=ct(z,I))}return{c(){e=R("div");for(let w=0;w<t.length;w+=1)t[w].c();o=A(),s=R("div"),c=R("div"),n=R("input"),i=A(),a=R("label"),f=Q("Book Data"),u=A(),p=R("div"),g=R("input"),b=A(),C=R("label"),h=Q("Bookmark"),this.h()},l(w){e=P(w,"DIV",{class:!0});var I=T(e);for(let le=0;le<t.length;le+=1)t[le].l(I);I.forEach(_),o=S(w),s=P(w,"DIV",{class:!0});var z=T(s);c=P(z,"DIV",{class:!0});var W=T(c);n=P(W,"INPUT",{type:!0,id:!0,name:!0}),i=S(W),a=P(W,"LABEL",{for:!0});var Z=T(a);f=Y(Z,"Book Data"),Z.forEach(_),W.forEach(_),u=S(z),p=P(z,"DIV",{});var X=T(p);g=P(X,"INPUT",{type:!0,id:!0,name:!0}),b=S(X),C=P(X,"LABEL",{for:!0});var ce=T(C);h=Y(ce,"Bookmark"),ce.forEach(_),X.forEach(_),z.forEach(_),this.h()},h(){m(e,"class","mb-8 flex grow justify-center"),m(n,"type","checkbox"),m(n,"id","bookdata"),m(n,"name","data"),n.__value="data",n.value=n.__value,r[5][0].push(n),m(a,"for","bookdata"),m(c,"class","mb-4 mr-4"),m(g,"type","checkbox"),m(g,"id","bookprogress"),m(g,"name","bookmark"),g.__value="bookmark",g.value=g.__value,r[5][0].push(g),m(C,"for","bookprogress"),m(s,"class","ml-5 flex")},m(w,I){V(w,e,I);for(let z=0;z<t.length;z+=1)t[z].m(e,null);V(w,o,I),V(w,s,I),E(s,c),E(c,n),n.checked=~r[0].indexOf(n.__value),E(c,i),E(c,a),E(a,f),E(s,u),E(s,p),E(p,g),g.checked=~r[0].indexOf(g.__value),E(p,b),E(p,C),E(C,h),v=!0,k||(d=[U(n,"change",r[4]),U(g,"change",r[6])],k=!0)},p(w,[I]){I&6&&(B=w[2],J(),t=dt(t,I,D,1,w,B,l,e,ht,ct,null,at),x()),I&1&&(n.checked=~w[0].indexOf(n.__value)),I&1&&(g.checked=~w[0].indexOf(g.__value))},i(w){if(!v){for(let I=0;I<B.length;I+=1)M(t[I]);v=!0}},o(w){for(let I=0;I<t.length;I+=1)L(t[I]);v=!1},d(w){w&&_(e);for(let I=0;I<t.length;I+=1)t[I].d();w&&_(o),w&&_(s),r[5][0].splice(r[5][0].indexOf(n),1),r[5][0].splice(r[5][0].indexOf(g),1),k=!1,we(d)}}}function Rl(r,e,t){let{dataToReplicate:l}=e,{icons:o}=e,{target:s}=e;const c=[[]],n=f=>{t(1,s=f.source)};function i(){l=He(c[0],this.__value,this.checked),t(0,l)}function a(){l=He(c[0],this.__value,this.checked),t(0,l)}return r.$$set=f=>{"dataToReplicate"in f&&t(0,l=f.dataToReplicate),"icons"in f&&t(2,o=f.icons),"target"in f&&t(1,s=f.target)},[l,s,o,n,i,c,a]}class Pl extends ge{constructor(e){super(),ve(this,e,Rl,Tl,ke,{dataToReplicate:0,icons:2,target:1})}}function yl(r){let e,t,l,o,s;function c(a){r[7](a)}function n(a){r[8](a)}let i={icons:r[2]};return r[1]!==void 0&&(i.target=r[1]),r[0]!==void 0&&(i.dataToReplicate=r[0]),t=new Pl({props:i}),me.push(()=>Se(t,"target",c)),me.push(()=>Se(t,"dataToReplicate",n)),{c(){e=R("div"),H(t.$$.fragment),this.h()},l(a){e=P(a,"DIV",{class:!0,slot:!0});var f=T(e);N(t.$$.fragment,f),f.forEach(_),this.h()},h(){m(e,"class","flex flex-col"),m(e,"slot","content")},m(a,f){V(a,e,f),$(t,e,null),s=!0},p(a,f){const u={};!l&&f&2&&(l=!0,u.target=a[1],ze(()=>l=!1)),!o&&f&1&&(o=!0,u.dataToReplicate=a[0],ze(()=>o=!1)),t.$set(u)},i(a){s||(M(t.$$.fragment,a),s=!0)},o(a){L(t.$$.fragment,a),s=!1},d(a){a&&_(e),K(t)}}}function Ml(r){let e,t,l,o,s,c,n,i,a,f,u,p,g,b;return c=new Ke({}),f=new Ke({}),{c(){e=R("div"),t=R("div"),l=R("div"),o=R("button"),s=Q(`Cancel\r
          `),H(c.$$.fragment),n=A(),i=R("button"),a=Q(`Start\r
        `),H(f.$$.fragment),this.h()},l(C){e=P(C,"DIV",{class:!0,slot:!0});var h=T(e);t=P(h,"DIV",{class:!0});var v=T(t);l=P(v,"DIV",{class:!0});var k=T(l);o=P(k,"BUTTON",{class:!0});var d=T(o);s=Y(d,`Cancel\r
          `),N(c.$$.fragment,d),d.forEach(_),k.forEach(_),n=S(v),i=P(v,"BUTTON",{class:!0});var B=T(i);a=Y(B,`Start\r
        `),N(f.$$.fragment,B),B.forEach(_),v.forEach(_),h.forEach(_),this.h()},h(){m(o,"class",We),m(l,"class","flex"),m(i,"class",We),i.disabled=u=!r[0].length,m(t,"class","flex grow justify-between"),m(e,"class","flex grow flex-col"),m(e,"slot","footer")},m(C,h){V(C,e,h),E(e,t),E(t,l),E(l,o),E(o,s),$(c,o,null),E(t,n),E(t,i),E(i,a),$(f,i,null),p=!0,g||(b=[U(o,"click",r[6]),U(i,"click",r[4])],g=!0)},p(C,h){(!p||h&1&&u!==(u=!C[0].length))&&(i.disabled=u)},i(C){p||(M(c.$$.fragment,C),M(f.$$.fragment,C),p=!0)},o(C){L(c.$$.fragment,C),L(f.$$.fragment,C),p=!1},d(C){C&&_(e),K(c),K(f),g=!1,we(b)}}}function Vl(r){let e,t;return e=new zt({props:{$$slots:{footer:[Ml],content:[yl]},$$scope:{ctx:r}}}),{c(){H(e.$$.fragment)},l(l){N(e.$$.fragment,l)},m(l,o){$(e,l,o),t=!0},p(l,[o]){const s={};o&515&&(s.$$scope={dirty:o,ctx:l}),e.$set(s)},i(l){t||(M(e.$$.fragment,l),t=!0)},o(l){L(e.$$.fragment,l),t=!1},d(l){K(e,l)}}}function Ll(r,e,t){let{dataToReplicate:l}=e,{source:o}=e,{target:s}=e;const c=[{...$e(re.BACKUP),source:re.BACKUP,label:"Zip Export"},{...$e(re.BROWSER),source:re.BROWSER,label:"Browser DB"}].filter(p=>p.source!==o),n=Ue();function i(){vt.next({source:o,target:s,dataToReplicate:l}),n("close")}const a=()=>n("close");function f(p){s=p,t(1,s)}function u(p){l=p,t(0,l)}return r.$$set=p=>{"dataToReplicate"in p&&t(0,l=p.dataToReplicate),"source"in p&&t(5,o=p.source),"target"in p&&t(1,s=p.target)},[l,s,c,n,i,o,a,f,u]}class Ol extends ge{constructor(e){super(),ve(this,e,Ll,Vl,ke,{dataToReplicate:0,source:5,target:1})}}/**
 * @license BSD-3-Clause
 * Copyright (c) 2022, ッツ Reader Authors
 * All rights reserved.
 */function Oe(r,e){const t=new Set(r);return e(t),t}/**
 * @license BSD-3-Clause
 * Copyright (c) 2022, ッツ Reader Authors
 * All rights reserved.
 */async function bt(r){if(Al(r)){const t=r.createReader(),l=await wt(t);return(await Promise.all(l.map(s=>bt(s)))).flat()}return[await new Promise((t,l)=>{r.file(t,l)})]}async function wt(r){const e=await new Promise((l,o)=>{r.readEntries(l,o)});if(!e.length)return[];const t=await wt(r);return e.concat(t)}function Al(r){return r.isDirectory}/**
 * @license BSD-3-Clause
 * Copyright (c) 2022, ッツ Reader Authors
 * All rights reserved.
 */async function Sl(r){var l;if(!((l=r.dataTransfer)!=null&&l.items))return[];const e=Array.from(r.dataTransfer.items).filter(o=>o.kind==="file").map(o=>o.webkitGetAsEntry()).filter(o=>!!o);return e.length?(await Promise.all(e.map(o=>bt(o)))).flat():[]}/**
 * @license BSD-3-Clause
 * Copyright (c) 2022, ッツ Reader Authors
 * All rights reserved.
 */function zl(r,e){return new Map(r.map(t=>[t[e],t]))}const{document:Ae}=Mt;function Ul(r){let e,t,l,o,s,c,n,i,a;return l=new he({props:{icon:xt,style:"width: 100%; height: auto"}}),{c(){e=R("div"),t=R("div"),H(l.$$.fragment),o=A(),s=R("label"),c=R("input"),this.h()},l(f){e=P(f,"DIV",{class:!0});var u=T(e);t=P(u,"DIV",{class:!0});var p=T(t);N(l.$$.fragment,p),p.forEach(_),u.forEach(_),o=S(f),s=P(f,"LABEL",{class:!0});var g=T(s);c=P(g,"INPUT",{type:!0,accept:!0}),g.forEach(_),this.h()},h(){m(t,"class","flex w-3/6 justify-center xl:w-3/12"),m(e,"class","flex justify-center pt-44 text-gray-400 text-opacity-40"),m(c,"type","file"),m(c,"accept",".htmlz,.epub"),c.multiple=!0,c.hidden=!0,m(s,"class","fixed inset-0 z-0")},m(f,u){V(f,e,u),E(e,t),$(l,t,null),V(f,o,u),V(f,s,u),E(s,c),n=!0,i||(a=Ie(Re.call(null,c,r[15])),i=!0)},p:fe,i(f){n||(M(l.$$.fragment,f),n=!0)},o(f){L(l.$$.fragment,f),n=!1},d(f){f&&_(e),K(l),f&&_(o),f&&_(s),i=!1,a()}}}function Fl(r){let e,t;return e=new ul({props:{currentBookId:r[9],selectedBookIds:r[1],bookCards:r[8]}}),e.$on("bookClick",r[27]),e.$on("removeBookClick",r[28]),{c(){H(e.$$.fragment)},l(l){N(e.$$.fragment,l)},m(l,o){$(e,l,o),t=!0},p(l,o){const s={};o[0]&512&&(s.currentBookId=l[9]),o[0]&2&&(s.selectedBookIds=l[1]),o[0]&256&&(s.bookCards=l[8]),e.$set(s)},i(l){t||(M(e.$$.fragment,l),t=!0)},o(l){L(e.$$.fragment,l),t=!1},d(l){K(e,l)}}}function jl(r){let e;return{c(){e=Q("Loading...")},l(t){e=Y(t,"Loading...")},m(t,l){V(t,e,l)},p:fe,i:fe,o:fe,d(t){t&&_(e)}}}function Hl(r){var k;let e,t,l,o,s,c,n,i,a,f,u,p;Ae.title=e=qe("Book Manager");function g(d){r[22](d)}let b={hasBookOpened:!!r[9],selectedCount:r[1].size,hasBooks:!!((k=r[8])!=null&&k.length),cancelTooltip:r[4],replicationProgress:r[5],replicationToProgress:r[6],replicationProgressRemaining:r[7]};r[0]!==void 0&&(b.selectMode=r[0]),o=new El({props:b}),me.push(()=>Se(o,"selectMode",g)),o.$on("selectAllClick",r[16]),o.$on("backToBookClick",r[17]),o.$on("removeClick",r[23]),o.$on("filesChange",r[24]),o.$on("bugReportClick",r[20]),o.$on("cancelReplication",r[25]),o.$on("replicateBookData",r[21]),o.$on("importBackup",r[26]);const C=[jl,Fl,Ul],h=[];function v(d,B){return!d[8]||d[10]?0:d[8].length?1:2}return i=v(r),a=h[i]=C[i](r),{c(){t=A(),l=R("div"),H(o.$$.fragment),c=A(),n=R("div"),a.c(),this.h()},l(d){yt('[data-svelte="svelte-1u9ti14"]',Ae.head).forEach(_),t=S(d),l=P(d,"DIV",{class:!0});var D=T(l);N(o.$$.fragment,D),D.forEach(_),c=S(d),n=P(d,"DIV",{class:!0});var w=T(n);a.l(w),w.forEach(_),this.h()},h(){m(l,"class","elevation-4 fixed inset-x-0 top-0 z-10"),m(n,"class",gt+" h-full pt-16 xl:pt-14")},m(d,B){V(d,t,B),V(d,l,B),$(o,l,null),V(d,c,B),V(d,n,B),h[i].m(n,null),f=!0,u||(p=[U(n,"dragenter",Wl),U(n,"dragover",ql),U(n,"dragend",Gl),U(n,"drop",Xl),U(n,"drop",r[29])],u=!0)},p(d,B){var I;(!f||B&0)&&e!==(e=qe("Book Manager"))&&(Ae.title=e);const D={};B[0]&512&&(D.hasBookOpened=!!d[9]),B[0]&2&&(D.selectedCount=d[1].size),B[0]&256&&(D.hasBooks=!!((I=d[8])!=null&&I.length)),B[0]&16&&(D.cancelTooltip=d[4]),B[0]&32&&(D.replicationProgress=d[5]),B[0]&64&&(D.replicationToProgress=d[6]),B[0]&128&&(D.replicationProgressRemaining=d[7]),!s&&B[0]&1&&(s=!0,D.selectMode=d[0],ze(()=>s=!1)),o.$set(D);let w=i;i=v(d),i===w?h[i].p(d,B):(J(),L(h[w],1,1,()=>{h[w]=null}),x(),a=h[i],a?a.p(d,B):(a=h[i]=C[i](d),a.c()),M(a,1),a.m(n,null))},i(d){f||(M(o.$$.fragment,d),M(a),f=!0)},o(d){L(o.$$.fragment,d),L(a),f=!1},d(d){d&&_(t),d&&_(l),K(o),d&&_(c),d&&_(n),h[i].d(),u=!1,we(p)}}}function Nl(r){return r!=null&&r.progress?{progress:typeof r.progress=="string"?+r.progress.slice(0,-1):r.progress,lastBookmarkModified:r.lastBookmarkModified||0}:{progress:0,lastBookmarkModified:0}}function $l(r,e){let t=0;const{lastBookModified:l=0,lastBookOpen:o=0}=r,{lastBookModified:s=0,lastBookOpen:c=0}=e;return o||c?t=c-o:t=s-l,t}function Kl(r){return r&&Number.isFinite(r)?new Date(r*1e3).toISOString().substr(11,8):"??:??:??"}const Wl=r=>r.preventDefault(),ql=r=>r.preventDefault(),Gl=r=>r.preventDefault(),Xl=r=>r.preventDefault();function Zl(r,e,t){let l,o,s;const c=new rl,n=Ee.listLoading$.pipe(Ve(y=>y));Te(r,n,y=>t(10,s=y));const i=tl([Ee.dataList$,Ee.bookmarks$]).pipe(Ve(([y,F])=>{const q=zl(F,"dataId");return y.map(G=>({...G,...Nl(q.get(G.id))})).sort($l)}),Ge());Te(r,i,y=>t(8,l=y));const a=Ee.lastItem$.pipe(Ve(y=>y==null?void 0:y.dataId),Ge());Te(r,a,y=>t(9,o=y));let f=new Set,u=!1,p=new AbortController,g=p.signal,b="",C=0,h=0,v="~ ??:??:??",k=0,d;ft(()=>{c.next(),c.complete()});function B(y){if(!!D()){if(!u){w(y);return}t(1,f=Oe(f,F=>{if(F.has(y)){F.delete(y);return}F.add(y)}))}}function D(){return!h}function w(y){!y||(Ee.putLastItem(y),I(y))}async function I(y){await Ht(`/ebook-reader/b?id=${y}`)}async function z(y){if(!D())return;t(4,b=`Cancels the current Import
Already imported Data will not be deleted`),Z();const F=/\.(?:htmlz|epub)$/,q=Array.from(y).filter(Me=>F.test(Me.name)),G="Bookimport failed";if(!q.length){X(),W(G,"File(s) must be HTMLZ or EPUB","");return}const ue=re.BROWSER,{error:te,dataId:pe}=await Nt(window,document,ue,q,g).catch(Me=>({error:Me.message,dataId:0}));X(),te?W(G,te,"Error(s) occurred during Bookimport"):ue===re.BROWSER&&pe&&w(pe)}function W(y,F,q){const G=Xe.errorCount>1;Le.dialogs$.next([{component:G?Ze:$t,props:{title:y,message:G?q:F}}])}function Z(){t(7,v="~ ??:??:??"),t(5,C=0),t(6,h=1),d=Date.now(),Xe.clearHistory(),t(2,p=new AbortController),t(3,g=p.signal)}function X(){t(6,h=0),t(5,C=0),t(4,b="")}function ce(){const y=l;t(1,f=Oe(f,F=>{y.forEach(q=>F.add(q.id))}))}function le(){const y=o;!y||I(y)}async function Be(y){if(!D())return;t(4,b=`Cancels the Deletion
Already deleted Data will not be restored`),Z();const F=l.length,q=await Kt(re.BROWSER,window),[G,ue]=await q.deleteBookData(l.reduce((te,pe)=>(y.includes(pe.id)&&te.push(pe.title),te),[]),g);X(),await Vt(),ue.length===F?t(0,u=!1):t(1,f=Oe(f,te=>{ue.forEach(pe=>te.delete(pe))})),G&&W("Deletion failed",G,"Error(s) occurred during Deletion")}async function Ce(y){if(!D())return;const F="Import failed";if(t(4,b=`Cancels the current Import
Already imported Data will not be deleted`),Z(),!y.name.endsWith(".zip")){X(),W(F,"Invalid File - expected zip Archive","");return}const q=await Wt(window,re.BROWSER,y,g).catch(G=>G.message);X(),q&&W(F,q,"Error(s) occurred during Import")}function ye(){Le.dialogs$.next([{component:Ze,props:{title:"Bug Report",message:"Please include the attached file for your report"}}])}function O(){Le.dialogs$.next([{component:Ol,props:{dataToReplicate:[qt.PROGRESS],source:re.BROWSER,target:re.BACKUP},disableCloseOnClick:!0}])}Ut.pipe(Ye(c)).subscribe(y=>{if(!g.aborted){if(k=y.baseProgress||k||0,t(6,h=y.maxProgress||h||0),y.progressToAdd===-1){const F=Math.ceil(C/k)*k-C;t(5,C+=F||k)}else y.progressToAdd&&t(5,C+=y.progressToAdd);if(y.progressToAdd||y.reportOnly){const F=(Date.now()-d)/1e3,q=C/F,G=(h-C)/q;t(7,v=`~ ${Kl(Math.ceil(G))}`)}}}),vt.pipe(Ft(async({source:y,target:F,dataToReplicate:q})=>{if(!D())return;t(4,b="Cancels the current Export"),Z();const G=l.filter(te=>f.has(te.id)),ue=await jt(window,y,F,G,q,g).catch(te=>te.message);X(),ue&&W("Export failed",ue,"Error(s) occurred during Export")}),Ye(c)).subscribe(()=>{});function Bt(y){u=y,t(0,u)}const Et=()=>Be(Array.from(f)),It=y=>z(y.detail),Dt=()=>{g.aborted||(p.abort(),t(7,v="Canceling ..."))},Ct=y=>Ce(y.detail),Tt=y=>B(y.detail.id),Rt=y=>Be([y.detail.id]),Pt=y=>Sl(y).then(z);return r.$$.update=()=>{r.$$.dirty[0]&1&&(u||t(1,f=new Set))},[u,f,p,g,b,C,h,v,l,o,s,n,i,a,B,z,ce,le,Be,Ce,ye,O,Bt,Et,It,Dt,Ct,Tt,Rt,Pt]}class nr extends ge{constructor(e){super(),ve(this,e,Zl,Hl,ke,{},null,[-1,-1])}}export{nr as default};
