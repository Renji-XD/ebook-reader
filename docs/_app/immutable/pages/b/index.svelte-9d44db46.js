import{S as Ke,i as Ue,n as Je,P as to,e as it,Q as no,a as L,E as at,f as D,T as At,j as oo,k as Q,w as ge,s as $,l as Z,m as x,x as ke,c as ee,p as q,U as z,q as E,y as pe,O as Fe,d as W,g as Le,t as j,b as Ge,B as be,V as Ot,W as K,X as Qt,Y as Dn,Z as ie,H as J,_ as Zt,r as ue,u as fe,v as Be,$ as tn,a0 as he,a1 as me,o as Tn,a2 as ro,a3 as io,G as ao,a4 as lo,a5 as In,a6 as nn,a7 as so}from"../../chunks/index-df0cdd8f.js";import{A as uo,a as fo,p as An,f as On,i as co,m as yt,b as kt,t as xt,c as Vn,d as ho,e as mo,g as $e,o as st,h as Rn,j as zn,s as mt,k as Se,l as Vt,F as Ie,n as Xt,q as Ln,r as on,u as Ye,v as ct,w as go,x as qt,y as jt,R as ko,z as Yt,V as Mt,B as $t,C as po,D as bo,E as Co,G as _o,H as Gn,N as wo,I as So,J as Xe,K as rn,L as _t,M as vo,S as yo,O as Mo,P as Po,Q as Fo,T as Bo,U as Kt,W as Ut,X as Eo,Y as Nt,Z as Do,_ as To,$ as Io,a0 as Ao,a1 as Oo,a2 as Vo,a3 as Ro,a4 as zo,a5 as Lo,a6 as Go,a7 as No,a8 as Ho,a9 as Wo}from"../../chunks/format-page-title-36cd2a0a.js";import{p as Xo}from"../../chunks/stores-b20e80ef.js";import{F as Ne,f as dt,a as qo,M as jo,m as Ft,b as Yo,c as Ko,d as Uo,e as Jo,g as Qo,h as Nn}from"../../chunks/merged-header-icon-197d1b73.js";import{S as Zo,_ as an,a as Jt,b as Hn,O as Qe,i as et,n as xo,c as $o,B as Bt,e as Pe,w as er,d as ln}from"../../chunks/dialog-manager-cce8b3b0.js";import{m as tr,t as Oe,c as gt,f as sn}from"../../chunks/index.es-d81d3801.js";import{r as tt,a as nr}from"../../chunks/theme-option-f666c2ca.js";import"../../chunks/singletons-a14e46a6.js";import"../../chunks/index-31b77272.js";var ht={schedule:function(t){var e=requestAnimationFrame,n=cancelAnimationFrame,r=ht.delegate;r&&(e=r.requestAnimationFrame,n=r.cancelAnimationFrame);var o=e(function(i){n=void 0,t(i)});return new Zo(function(){return n==null?void 0:n(o)})},requestAnimationFrame:function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=ht.delegate;return((n==null?void 0:n.requestAnimationFrame)||requestAnimationFrame).apply(void 0,an([],Jt(t)))},cancelAnimationFrame:function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=ht.delegate;return((n==null?void 0:n.cancelAnimationFrame)||cancelAnimationFrame).apply(void 0,an([],Jt(t)))},delegate:void 0},or=function(t){Hn(e,t);function e(n,r){var o=t.call(this,n,r)||this;return o.scheduler=n,o.work=r,o}return e.prototype.requestAsyncId=function(n,r,o){return o===void 0&&(o=0),o!==null&&o>0?t.prototype.requestAsyncId.call(this,n,r,o):(n.actions.push(this),n._scheduled||(n._scheduled=ht.requestAnimationFrame(function(){return n.flush(void 0)})))},e.prototype.recycleAsyncId=function(n,r,o){if(o===void 0&&(o=0),o!=null&&o>0||o==null&&this.delay>0)return t.prototype.recycleAsyncId.call(this,n,r,o);n.actions.some(function(i){return i.id===r})||(ht.cancelAnimationFrame(r),n._scheduled=void 0)},e}(uo),rr=function(t){Hn(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.flush=function(n){this._active=!0;var r=this._scheduled;this._scheduled=void 0;var o=this.actions,i;n=n||o.shift();do if(i=n.execute(n.state,n.delay))break;while((n=o[0])&&n.id===r&&o.shift());if(this._active=!1,i){for(;(n=o[0])&&n.id===r&&o.shift();)n.unsubscribe();throw i}},e}(fo),Rt=new rr(or),lt=new Qe(function(t){return t.complete()});function Wn(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=An(t);return On(t,n)}var ir=["addListener","removeListener"],ar=["addEventListener","removeEventListener"],lr=["on","off"];function qe(t,e,n,r){if(et(n)&&(r=n,n=void 0),r)return qe(t,e,n).pipe(tr(r));var o=Jt(fr(t)?ar.map(function(l){return function(s){return t[l](e,s,n)}}):sr(t)?ir.map(un(t,e)):ur(t)?lr.map(un(t,e)):[],2),i=o[0],a=o[1];if(!i&&co(t))return yt(function(l){return qe(l,e,n)})(kt(t));if(!i)throw new TypeError("Invalid event target");return new Qe(function(l){var s=function(){for(var f=[],m=0;m<arguments.length;m++)f[m]=arguments[m];return l.next(1<f.length?f:f[0])};return i(s),function(){return a(s)}})}function un(t,e){return function(n){return function(r){return t[n](e,r)}}}function sr(t){return et(t.addListener)&&et(t.removeListener)}function ur(t){return et(t.on)&&et(t.off)}function fr(t){return et(t.addEventListener)&&et(t.removeEventListener)}function cr(t,e){return t===void 0&&(t=0),e===void 0&&(e=Vn),t<0&&(t=0),xt(t,t,e)}function zt(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=An(t),r=ho(t,1/0),o=t;return o.length?o.length===1?kt(o[0]):mo(r)(On(o,n)):lt}var hr=Array.isArray;function mr(t){return t.length===1&&hr(t[0])?t[0]:t}function dr(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return t=mr(t),t.length===1?kt(t[0]):new Qe(gr(t))}function gr(t){return function(e){for(var n=[],r=function(i){n.push(kt(t[i]).subscribe($e(e,function(a){if(n){for(var l=0;l<n.length;l++)l!==i&&n[l].unsubscribe();n=null}e.next(a)})))},o=0;n&&!e.closed&&o<t.length;o++)r(o)}}function kr(t){return st(function(e,n){var r=!1,o=null,i=null,a=function(){if(i==null||i.unsubscribe(),i=null,r){r=!1;var l=o;o=null,n.next(l)}};e.subscribe($e(n,function(l){i==null||i.unsubscribe(),r=!0,o=l,i=$e(n,a,xo),kt(t(l)).subscribe(i)},function(){a(),n.complete()},void 0,function(){o=i=null}))})}function Et(t,e){return e===void 0&&(e=Vn),st(function(n,r){var o=null,i=null,a=null,l=function(){if(o){o.unsubscribe(),o=null;var f=i;i=null,r.next(f)}};function s(){var f=a+t,m=e.now();if(m<f){o=this.schedule(void 0,f-m),r.add(o);return}l()}n.subscribe($e(r,function(f){i=f,a=e.now(),o||(o=e.schedule(s,t),r.add(o))},function(){l(),r.complete()},void 0,function(){i=o=null}))})}function pt(t){return t<=0?function(){return lt}:st(function(e,n){var r=0;e.subscribe($e(n,function(o){++r<=t&&(n.next(o),t<=r&&n.complete())}))})}function Xn(t,e){return e===void 0&&(e=$o),t=t!=null?t:pr,st(function(n,r){var o,i=!0;n.subscribe($e(r,function(a){var l=e(a);(i||!t(o,l))&&(i=!1,o=l,r.next(a))}))})}function pr(t,e){return t===e}function br(t){return st(function(e,n){try{e.subscribe(n)}finally{n.add(t)}})}function Cr(){return st(function(t,e){var n,r=!1;t.subscribe($e(e,function(o){var i=n;n=o,r&&e.next([i,o]),r=!0}))})}/**
 * @license BSD-3-Clause
 * Copyright (c) 2022, ッツ Reader Authors
 * All rights reserved.
 */const en=new Bt([]),Dt=new Pe,bt=new Pe,rt=new Pe;function qn(t){const e=t.filter(i=>!i.parentChapter);let n=t.find(i=>i.progress<100);n||(n=t[t.length-1]);const r=n.parentChapter||n.reference,o=e.findIndex(i=>i.reference===r);return[e,o,r]}function _r(t){let e,n;return{c(){e=new to(!1),n=it(),this.h()},l(r){e=no(r,!1),n=it(),this.h()},h(){e.a=n},m(r,o){e.m(t[0],r,o),L(r,n,o)},p(r,[o]){o&1&&e.p(r[0])},i:at,o:at,d(r){r&&D(n),r&&e.d()}}}function wr(t,e,n){let{html:r}=e;const o=At();return oo(()=>{o("load")}),t.$$set=i=>{"html"in i&&n(0,r=i.html)},[r]}class jn extends Ke{constructor(e){super(),Ue(this,e,wr,_r,Je,{html:0})}}/**
 * @license BSD-3-Clause
 * Copyright (c) 2022, ッツ Reader Authors
 * All rights reserved.
 */function nt(t,e){return e==="rtl"?-t:t}/**
 * @license BSD-3-Clause
 * Copyright (c) 2022, ッツ Reader Authors
 * All rights reserved.
 */class Sr{constructor(e,n,r){this.calculator=e,this.window=n,this.firstDimensionMargin=r}scrollToBookmark(e){const n=this.getBookmarkPosition(e);if(!n)return;const{scrollToData:r}=fn(n,this.firstDimensionMargin);this.window.scrollTo(r)}formatBookmarkData(e){const n=this.calculator.calcExploredCharCount(),r=this.calculator.charCount,{verticalMode:o}=this.calculator,i=o?"scrollX":"scrollY";return{dataId:e,exploredCharCount:n,progress:n/r,[i]:this.window[i],lastBookmarkModified:new Date().getTime()}}getBookmarkBarPosition(e){const n=this.getBookmarkPosition(e);if(!!n)return fn(n,this.firstDimensionMargin).bookmarkPosData}getBookmarkPosition(e){if(!e.exploredCharCount)return;const{verticalMode:n}=this.calculator,r=this.getBookmarkTargetPosByScrollValue(e);if(r)return r;const o=this.calculator.getScrollPosByCharCount(e.exploredCharCount);return n?{scrollX:o}:{scrollY:o}}getBookmarkTargetPosByScrollValue(e){const{exploredCharCount:n}=e,r=o=>{const i=e[o];if(!i)return;const a=nt(i,this.calculator.direction);if(this.calculator.getCharCountByScrollPos(a)===n)return{[o]:i}};return this.calculator.verticalMode?r("scrollX"):r("scrollY")}}function fn(t,e){return"scrollX"in t?{scrollToData:{left:t.scrollX},bookmarkPosData:{right:`${-t.scrollX+e}px`}}:{scrollToData:{top:t.scrollY},bookmarkPosData:{top:`${t.scrollY+e}px`}}}/**
 * @license BSD-3-Clause
 * Copyright (c) 2022, ッツ Reader Authors
 * All rights reserved.
 */function vr(t){const e=(n,r,o,i)=>{if(o<r)return t!=null?t:o;const a=Math.floor((r+o)/2);return n[a]===i?a:n[a]>i?e(n,r,a-1,i):e(n,a+1,o,i)};return(n,r)=>e(n,0,n.length-1,r)}const Tt=vr(void 0);/**
 * @license BSD-3-Clause
 * Copyright (c) 2022, ッツ Reader Authors
 * All rights reserved.
 */class Yn{constructor(e,n,r,o,i){this.containerEl=e,this.axis=n,this.direction=r,this.scrollEl=o,this.document=i,this.paragraphPosToAccCharCount=new Map,this.paragraphs=Rn(e),this.paragraphPos=Array(this.paragraphs.length),this.accumulatedCharCount=[];let a=0;this.paragraphs.forEach(l=>{a+=zn(l),this.accumulatedCharCount.push(a)}),this.charCount=a}get verticalMode(){return this.axis==="vertical"}updateParagraphPos(e=0){const n=this.scrollEl.getBoundingClientRect(),r=nt(this.verticalMode?n.right:n.top,this.direction),o=Number(getComputedStyle(this.containerEl)[this.verticalMode?"paddingRight":"paddingTop"].replace(/px$/,"")),i=new Map;for(let a=0;a<this.paragraphs.length;a+=1){const l=this.paragraphs[a],s=this.getNodeBoundingRect(l),m=(()=>(this.verticalMode?s.width:s.height)<=0?this.paragraphPos[a-1]||0:nt(this.verticalMode?s.left:s.bottom,this.direction)-r-o+e)();this.paragraphPos[a]=m;const p=i.get(m)||[];i.set(m,p),p.push(a)}this.paragraphPosToAccCharCount=new Map(Array.from(i.entries()).map(([a,l])=>[a,Math.max(...l.map(s=>this.accumulatedCharCount[s]))]))}calcExploredCharCount(){return this.getCharCountByScrollPos(this.scrollPos)}getCharCountByScrollPos(e){const n=Tt(this.paragraphPos,e);return this.paragraphPosToAccCharCount.get(this.paragraphPos[n])||0}getScrollPosByCharCount(e){const n=Tt(this.accumulatedCharCount,e);return nt(this.paragraphPos[n],this.direction)}getNodeBoundingRect(e){const n=this.document.createRange();return n.selectNode(e),n.getBoundingClientRect()}get scrollPos(){return nt(this.scrollEl[this.scrollPosProp],this.direction)}get scrollPosProp(){return this.verticalMode?"scrollLeft":"scrollTop"}}/**
 * @license BSD-3-Clause
 * Copyright (c) 2022, ッツ Reader Authors
 * All rights reserved.
 */function yr(t,e,n){const r=Fr(e,n)(t,"scrollLeft");return(o,i,a)=>{if(!Mr(o))return;const l=Pr(o,i,a);r(-l),o.preventDefault()}}function Mr(t){return!(!t.deltaY||t.deltaX||t.altKey||t.shiftKey||t.ctrlKey||t.metaKey)}function Pr(t,e,n){switch(t.deltaMode){case 0:return t.deltaY;case 1:return t.deltaY*e*1.75;default:return t.deltaY*n}}function Fr(t,e){return(n,r)=>{let o=!1,i=t[r],a=t[r];const l=()=>{o=!0;const s=Math.trunc((i-t[r])/n);if(t[r]!==a){o=!1;return}if(a+=s,t.scrollBy(s,0),Math.abs(s)>0){e(l);return}o=!1};return s=>{o||(i=t[r],a=t[r]),i+=s,o||e(l)}}}/**
 * @license BSD-3-Clause
 * Copyright (c) 2022, ッツ Reader Authors
 * All rights reserved.
 */class Br{constructor(e,n,r){this.verticalMode=e,this.firstDimensionMargin=n,this.window=r}nextPage(){this.scrollByPercent(.9)}prevPage(){this.scrollByPercent(-.9)}scrollTo(e){this.window.scrollTo({[this.verticalMode?"left":"top"]:e})}scrollByPercent(e){let n=this.window.innerHeight,r="top",o=1;this.verticalMode&&(n=this.window.innerWidth,r="left",o=-1);const i=n-this.firstDimensionMargin*2;this.window.scrollBy({[r]:i*e*o,behavior:"smooth"})}}/**
 * @license BSD-3-Clause
 * Copyright (c) 2022, ッツ Reader Authors
 * All rights reserved.
 */class Er{constructor(e,n,r,o,i=Rt){this.multiplier=e,this.verticalMode=n,this.enabled$=new Bt(!1),this.enabled$.pipe(mt(a=>{if(!a)return lt;let l=0;return cr(0,i).pipe(Se(()=>Date.now()),Cr(),Se(s=>this.calcNewPos(s)),Se(s=>{l+=s;const f=Math.trunc(l);return l-=f,f}),Vt(s=>s!==0))}),Oe(r)).subscribe(a=>{let l="top";n&&(l="left"),o.documentElement.scrollBy({[l]:a})})}toggle(){this.enabled$.next(!this.enabled$.getValue())}off(){this.enabled$.next(!1)}calcNewPos([e,n]){let r=.00365956;return this.verticalMode&&(r=-91489e-8),r*this.multiplier*(n-e)}}const{document:Dr,window:Tr}=Dn;function cn(t){let e,n,r,o,i;return{c(){e=Q("div"),r=$(),o=Q("div"),this.h()},l(a){e=Z(a,"DIV",{class:!0,style:!0}),x(e).forEach(D),r=ee(a),o=Z(a,"DIV",{class:!0,style:!0}),x(o).forEach(D),this.h()},h(){q(e,"class","fixed z-[5]"),q(e,"style",n=t[21]+": 100%; "+t[20]+": "+t[14]+"px; "+t[19][0]+": 0"),z(e,"inset-y-0",t[2]),z(e,"inset-x-0",!t[2]),E(e,"background-color",t[4],!1),q(o,"class","fixed z-[5]"),q(o,"style",i=t[21]+": 100%; "+t[20]+": "+t[14]+"px; "+t[19][1]+": 0"),z(o,"inset-y-0",t[2]),z(o,"inset-x-0",!t[2]),E(o,"background-color",t[4],!1)},m(a,l){L(a,e,l),L(a,r,l),L(a,o,l)},p(a,l){l[0]&3686400&&n!==(n=a[21]+": 100%; "+a[20]+": "+a[14]+"px; "+a[19][0]+": 0")&&q(e,"style",n),l[0]&4&&z(e,"inset-y-0",a[2]),l[0]&4&&z(e,"inset-x-0",!a[2]),l[0]&16&&E(e,"background-color",a[4],!1),l[0]&3686400&&i!==(i=a[21]+": 100%; "+a[20]+": "+a[14]+"px; "+a[19][1]+": 0")&&q(o,"style",i),l[0]&4&&z(o,"inset-y-0",a[2]),l[0]&4&&z(o,"inset-x-0",!a[2]),l[0]&16&&E(o,"background-color",a[4],!1)},d(a){a&&D(e),a&&D(r),a&&D(o)}}}function hn(t){let e,n,r,o;const i=[Ar,Ir],a=[];function l(s,f){return s[2]?0:1}return e=l(t),n=a[e]=i[e](t),{c(){n.c(),r=it()},l(s){n.l(s),r=it()},m(s,f){a[e].m(s,f),L(s,r,f),o=!0},p(s,f){let m=e;e=l(s),e===m?a[e].p(s,f):(Le(),j(a[m],1,1,()=>{a[m]=null}),Ge(),n=a[e],n?n.p(s,f):(n=a[e]=i[e](s),n.c()),W(n,1),n.m(r.parentNode,r))},i(s){o||(W(n),o=!0)},o(s){j(n),o=!1},d(s){a[e].d(s),s&&D(r)}}}function Ir(t){let e,n,r;return n=new Ne({props:{icon:dt}}),{c(){e=Q("div"),ge(n.$$.fragment),this.h()},l(o){e=Z(o,"DIV",{class:!0});var i=x(e);ke(n.$$.fragment,i),i.forEach(D),this.h()},h(){q(e,"class","pointer-events-none absolute text-sm opacity-25 sm:text-xl"),E(e,"color",t[3],!1),E(e,"left",t[16],!1),E(e,"top",`calc(${t[17].top} + 1.5rem)`,!1)},m(o,i){L(o,e,i),pe(n,e,null),r=!0},p(o,i){i[0]&8&&E(e,"color",o[3],!1),i[0]&65536&&E(e,"left",o[16],!1),i[0]&131072&&E(e,"top",`calc(${o[17].top} + 1.5rem)`,!1)},i(o){r||(W(n.$$.fragment,o),r=!0)},o(o){j(n.$$.fragment,o),r=!1},d(o){o&&D(e),be(n)}}}function Ar(t){let e,n,r;return n=new Ne({props:{icon:dt}}),{c(){e=Q("div"),ge(n.$$.fragment),this.h()},l(o){e=Z(o,"DIV",{class:!0});var i=x(e);ke(n.$$.fragment,i),i.forEach(D),this.h()},h(){q(e,"class","pointer-events-none absolute text-xl opacity-25"),E(e,"color",t[3],!1),E(e,"right",`calc(${t[17].right} + 1rem)`,!1),E(e,"top",t[16],!1)},m(o,i){L(o,e,i),pe(n,e,null),r=!0},p(o,i){i[0]&8&&E(e,"color",o[3],!1),i[0]&131072&&E(e,"right",`calc(${o[17].right} + 1rem)`,!1),i[0]&65536&&E(e,"top",o[16],!1)},i(o){r||(W(n.$$.fragment,o),r=!0)},o(o){j(n.$$.fragment,o),r=!1},d(o){o&&D(e),be(n)}}}function Or(t){let e,n,r=`${t[7]}px`,o=`${t[18]||t[1]}px`,i,a,l,s,f,m;n=new jn({props:{html:t[0]}}),n.$on("load",t[24]);let p=t[14]&&cn(t),h=t[17]&&hn(t);return{c(){e=Q("div"),ge(n.$$.fragment),i=$(),p&&p.c(),a=$(),h&&h.c(),l=$(),this.h()},l(c){e=Z(c,"DIV",{class:!0});var b=x(e);ke(n.$$.fragment,b),b.forEach(D),i=ee(c),p&&p.l(c),a=ee(c),h&&h.l(c),l=ee(c),this.h()},h(){q(e,"class","book-content m-auto svelte-r5jtw7"),z(e,"book-content--writing-vertical-rl",t[2]),z(e,"book-content--writing-horizontal-rl",!t[2]),z(e,"book-content--hide-furigana",t[11]),z(e,"book-content--hide-spoiler-image",t[10]),z(e,"book-content--furigana-style-partial",t[12]===Ie.Partial),z(e,"book-content--furigana-style-full",t[12]===Ie.Full),z(e,"book-content--furigana-style-toggle",t[12]===Ie.Toggle),E(e,"color",t[3],!1),E(e,"font-size",r,!1),E(e,"max-width",!t[2]&&t[13]?`${t[13]}px`:void 0,!1),E(e,"max-height",t[18]?`${t[18]}px`:void 0,!1),E(e,"padding-left",t[2]&&t[14]?`${t[14]}px`:void 0,!1),E(e,"padding-right",t[2]&&t[14]?`${t[14]}px`:void 0,!1),E(e,"padding-top",!t[2]&&t[14]?`${t[14]}px`:void 0,!1),E(e,"padding-bottom",!t[2]&&t[14]?`${t[14]}px`:void 0,!1),E(e,"--font-family-serif",t[8],!1),E(e,"--font-family-sans-serif",t[9],!1),E(e,"--book-content-hint-furigana-font-color",t[5],!1),E(e,"--book-content-hint-furigana-shadow-color",t[6],!1),E(e,"--book-content-child-height",o,!1)},m(c,b){L(c,e,b),pe(n,e,null),t[41](e),L(c,i,b),p&&p.m(c,b),L(c,a,b),h&&h.m(c,b),L(c,l,b),s=!0,f||(m=[Fe(Tr,"scroll",t[23]),Fe(Dr.body,"wheel",t[22],{passive:!1})],f=!0)},p(c,b){const v={};b[0]&1&&(v.html=c[0]),n.$set(v),b[0]&4&&z(e,"book-content--writing-vertical-rl",c[2]),b[0]&4&&z(e,"book-content--writing-horizontal-rl",!c[2]),b[0]&2048&&z(e,"book-content--hide-furigana",c[11]),b[0]&1024&&z(e,"book-content--hide-spoiler-image",c[10]),b[0]&4096&&z(e,"book-content--furigana-style-partial",c[12]===Ie.Partial),b[0]&4096&&z(e,"book-content--furigana-style-full",c[12]===Ie.Full),b[0]&4096&&z(e,"book-content--furigana-style-toggle",c[12]===Ie.Toggle),b[0]&8&&E(e,"color",c[3],!1),b[0]&128&&r!==(r=`${c[7]}px`)&&E(e,"font-size",r,!1),b[0]&8196&&E(e,"max-width",!c[2]&&c[13]?`${c[13]}px`:void 0,!1),b[0]&262144&&E(e,"max-height",c[18]?`${c[18]}px`:void 0,!1),b[0]&16388&&E(e,"padding-left",c[2]&&c[14]?`${c[14]}px`:void 0,!1),b[0]&16388&&E(e,"padding-right",c[2]&&c[14]?`${c[14]}px`:void 0,!1),b[0]&16388&&E(e,"padding-top",!c[2]&&c[14]?`${c[14]}px`:void 0,!1),b[0]&16388&&E(e,"padding-bottom",!c[2]&&c[14]?`${c[14]}px`:void 0,!1),b[0]&256&&E(e,"--font-family-serif",c[8],!1),b[0]&512&&E(e,"--font-family-sans-serif",c[9],!1),b[0]&32&&E(e,"--book-content-hint-furigana-font-color",c[5],!1),b[0]&64&&E(e,"--book-content-hint-furigana-shadow-color",c[6],!1),b[0]&262146&&o!==(o=`${c[18]||c[1]}px`)&&E(e,"--book-content-child-height",o,!1),c[14]?p?p.p(c,b):(p=cn(c),p.c(),p.m(a.parentNode,a)):p&&(p.d(1),p=null),c[17]?h?(h.p(c,b),b[0]&131072&&W(h,1)):(h=hn(c),h.c(),W(h,1),h.m(l.parentNode,l)):h&&(Le(),j(h,1,1,()=>{h=null}),Ge())},i(c){s||(W(n.$$.fragment,c),W(h),s=!0)},o(c){j(n.$$.fragment,c),j(h),s=!1},d(c){c&&D(e),be(n),t[41](null),c&&D(i),p&&p.d(c),c&&D(a),h&&h.d(c),c&&D(l),f=!1,Ot(m)}}}function Vr(t,e,n){let r,o,i,a,l;K(t,rt,F=>n(47,l=F));let{htmlContent:s}=e,{width:f}=e,{height:m}=e,{verticalMode:p}=e,{fontColor:h}=e,{backgroundColor:c}=e,{hintFuriganaFontColor:b}=e,{hintFuriganaShadowColor:v}=e,{fontSize:d}=e,{fontFamilyGroupOne:C}=e,{fontFamilyGroupTwo:B}=e,{hideSpoilerImage:u}=e,{hideFurigana:_}=e,{furiganaStyle:P}=e,{secondDimensionMaxValue:V}=e,{firstDimensionMargin:I}=e,{autoPositionOnResize:Y}=e,{autoBookmark:oe}=e,{loadingState:ae}=e,{multiplier:k}=e,{bookmarkData:T}=e,{exploredCharCount:w}=e,{bookCharCount:A}=e,{autoScroller:R}=e,{bookmarkManager:X}=e,{pageManager:G}=e;const te=At();let N,U,y={},O,le,H,_e,se,ve=0,ce=!1,Ce=window.matchMedia("(min-width: 640px)").matches?"0.5rem":"0.25rem";const Ee=yr(4,document.documentElement,requestAnimationFrame),De=new Pe,ye=new Pe,we=new Pe,de=new Map,Ve=new Map;let Re=0,Ae=!1;Qt(()=>{we.next(),we.complete()}),O=new Er(k,p,we,document),R=O,gt([De,ye]).pipe(Vt(()=>Y),Xt(1),Se(([F,re])=>p?re:F),Xn(),Et(10),Ln(Rt),Oe(we)).subscribe(()=>{if(!U||!H)return;const F=U.getScrollPosByCharCount(ve);ce=!0,H.scrollTo(F)});function Ze(F){F.updateParagraphPos(),n(25,w=F.calcExploredCharCount()),se&&(se=!1,T.then(re=>{!re||!X||X.scrollToBookmark(re)}).finally(()=>{oe&&qe(window,"scroll").pipe(Xt(1),Et(3e3),Oe(we)).subscribe(()=>{te("bookmark")}),en.pipe(pt(1),mt(re=>re.length?(re.forEach(We=>{const Te=We.reference,ze=document.getElementById(Te);ze&&(Re||(Re=Number(getComputedStyle(ze)[p?"marginLeft":"marginBottom"].replace(/px$/,""))/2),Ve.set(Te,{...We,progress:0}),de.set(Te,ze))}),de.size?(je(),qe(window,"scroll")):lt):lt),kr(()=>xt(Ae?100:500)),Oe(we)).subscribe(je)})),n(37,y={})}function je(){const F=[...Ve.entries()];for(let re=0,{length:We}=F;re<We;re+=1){const[Te,ze]=F[re],g=de.get(Te).getBoundingClientRect();ze.progress=p?Math.min(Math.max(g.right+(I||0)-window.innerWidth,0),g.width)/(g.width||1)*100:Math.abs(Math.min(Math.max(g.top-(I||0),-g.height),0))/(g.height||1)*100,Ve.set(Te,ze)}Ae=!1,Dt.next(Ve)}function He(F){p&&!l&&Ee(F,d,window.innerWidth)}function xe(){requestAnimationFrame(()=>{!U||(n(25,w=U.calcExploredCharCount()),ce||(ve=w),ce=!1)})}function M(){!N||(n(36,U=new Yn(N,p?"vertical":"horizontal",p?"rtl":"ltr",document.documentElement,document)),n(25,w=0),ve=w,n(26,A=U.charCount),te("contentChange",N))}bt.pipe(Oe(we)).subscribe(F=>{let re=document.getElementById(F);if(!re)return;re=!F.startsWith(on)&&re.closest(`div[id^="${on}"]`)||re,Ae=!0;const Te=re.getBoundingClientRect();p?window.scrollBy(-(window.innerWidth-Te.right-(I||0)-Re),0):window.scrollBy(0,Te.top-(I||0)-Re)});function ne(F){ie[F?"unshift":"push"](()=>{N=F,n(15,N)})}return t.$$set=F=>{"htmlContent"in F&&n(0,s=F.htmlContent),"width"in F&&n(30,f=F.width),"height"in F&&n(1,m=F.height),"verticalMode"in F&&n(2,p=F.verticalMode),"fontColor"in F&&n(3,h=F.fontColor),"backgroundColor"in F&&n(4,c=F.backgroundColor),"hintFuriganaFontColor"in F&&n(5,b=F.hintFuriganaFontColor),"hintFuriganaShadowColor"in F&&n(6,v=F.hintFuriganaShadowColor),"fontSize"in F&&n(7,d=F.fontSize),"fontFamilyGroupOne"in F&&n(8,C=F.fontFamilyGroupOne),"fontFamilyGroupTwo"in F&&n(9,B=F.fontFamilyGroupTwo),"hideSpoilerImage"in F&&n(10,u=F.hideSpoilerImage),"hideFurigana"in F&&n(11,_=F.hideFurigana),"furiganaStyle"in F&&n(12,P=F.furiganaStyle),"secondDimensionMaxValue"in F&&n(13,V=F.secondDimensionMaxValue),"firstDimensionMargin"in F&&n(14,I=F.firstDimensionMargin),"autoPositionOnResize"in F&&n(31,Y=F.autoPositionOnResize),"autoBookmark"in F&&n(32,oe=F.autoBookmark),"loadingState"in F&&n(33,ae=F.loadingState),"multiplier"in F&&n(34,k=F.multiplier),"bookmarkData"in F&&n(35,T=F.bookmarkData),"exploredCharCount"in F&&n(25,w=F.exploredCharCount),"bookCharCount"in F&&n(26,A=F.bookCharCount),"autoScroller"in F&&n(27,R=F.autoScroller),"bookmarkManager"in F&&n(28,X=F.bookmarkManager),"pageManager"in F&&n(29,G=F.pageManager)},t.$$.update=()=>{if(t.$$.dirty[0]&4&&n(21,r=p?"height":"width"),t.$$.dirty[0]&4&&n(20,o=p?"width":"height"),t.$$.dirty[0]&4&&n(19,i=p?["left","right"]:["top","bottom"]),t.$$.dirty[0]&1073741824&&De.next(f),t.$$.dirty[0]&2&&ye.next(m),t.$$.dirty[0]&8196&&n(18,a=p&&V?V:void 0),t.$$.dirty[0]&106500&&V&&N){const F=Number(getComputedStyle(N)[p?"marginTop":"marginRight"].replace(/px$/,""));n(16,Ce=`min(max(calc(${`${F}px - ${Ce}`}), ${Ce}), ${F?`${F}px`:Ce})`)}if(t.$$.dirty[0]&1&&s&&(se=!0),t.$$.dirty[0]&1073741826|t.$$.dirty[1]&36&&U&&f&&m&&!ae){const F=U;requestAnimationFrame(()=>{Ze(F)})}t.$$.dirty[0]&4|t.$$.dirty[1]&136&&O&&(n(38,O.multiplier=k,O),n(38,O.verticalMode=p,O)),t.$$.dirty[0]&16384|t.$$.dirty[1]&288&&U&&(n(39,le=U&&new Sr(U,window,I||0)),n(28,X=le)),t.$$.dirty[1]&336&&y&&(n(17,_e=void 0),T.then(F=>{!F||n(17,_e=le==null?void 0:le.getBookmarkBarPosition(F))})),t.$$.dirty[0]&16388|t.$$.dirty[1]&512&&(n(40,H=new Br(p,I,window)),n(29,G=H))},[s,m,p,h,c,b,v,d,C,B,u,_,P,V,I,N,Ce,_e,a,i,o,r,He,xe,M,w,A,R,X,G,f,Y,oe,ae,k,T,U,y,O,le,H,ne]}class Rr extends Ke{constructor(e){super(),Ue(this,e,Vr,Or,Je,{htmlContent:0,width:30,height:1,verticalMode:2,fontColor:3,backgroundColor:4,hintFuriganaFontColor:5,hintFuriganaShadowColor:6,fontSize:7,fontFamilyGroupOne:8,fontFamilyGroupTwo:9,hideSpoilerImage:10,hideFurigana:11,furiganaStyle:12,secondDimensionMaxValue:13,firstDimensionMargin:14,autoPositionOnResize:31,autoBookmark:32,loadingState:33,multiplier:34,bookmarkData:35,exploredCharCount:25,bookCharCount:26,autoScroller:27,bookmarkManager:28,pageManager:29},null,[-1,-1])}}/**
 * @license BSD-3-Clause
 * Copyright (c) 2022, ッツ Reader Authors
 * All rights reserved.
 */const zr="px-4 md:px-8";/**
 * @license BSD-3-Clause
 * Copyright (c) 2022, ッツ Reader Authors
 * All rights reserved.
 */function Lr(t){const e=Array.from(t.getElementsByTagName("img"));return new Qe(n=>{const r=e.filter(i=>i.src).map(Gr);if(r.length<=0){n.next(!1),n.complete();return}const o=gt(r).subscribe(()=>{n.next(!1),n.complete()});return n.next(!0),o})}function Gr(t){return t.complete?Wn(1):dr(qe(t,"load"),qe(t,"error"))}/**
 * @license BSD-3-Clause
 * Copyright (c) 2022, ッツ Reader Authors
 * All rights reserved.
 */function Nr(t,e){const n=Hr(t),r=Xr(t);return o=>zt(n(o),Wr(o,e),r(o))}function Hr(t){return e=>{const n=Array.from(e.getElementsByTagName("a"));n.forEach(o=>{o.href=t.location.pathname+o.hash});const r=n.map(o=>It(o).pipe(Ye(()=>bt.next(o.hash.substring(1)))));return zt(...r)}}function Wr(t,e){const n=e===Ie.Toggle,o=Array.from(t.getElementsByTagName("ruby")).map(i=>n?It(i).pipe(Ye(()=>{i.classList.toggle("reveal-rt")})):It(i).pipe(pt(1),Ye(()=>{i.classList.add("reveal-rt")})));return zt(...o)}function Xr(t){return e=>{const r=Array.from(e.querySelectorAll("[data-ttu-spoiler-img]")).map(o=>{const i=t.createElement("span");return i.classList.add("spoiler-label"),i.setAttribute("aria-hidden","true"),i.innerText="\u30CD\u30BF\u30D0\u30EC",o.appendChild(i),It(o).pipe(pt(1),Ye(()=>{o.removeChild(i),o.removeAttribute("data-ttu-spoiler-img")}))});return zt(...r)}}function It(t){return qe(t,"click").pipe(Ye(e=>{e.preventDefault(),e.stopImmediatePropagation()}))}const qr=300,jr=60,Kn="none";function ft(t,e,n){return t.addEventListener(e,n),()=>t.removeEventListener(e,n)}function Yr(t,e){return e.filter(n=>t.pointerId!==n.pointerId)}function wt(t,e,n,r,o){t.dispatchEvent(new CustomEvent(`${e}${o}`,{detail:{event:n,pointersCount:r.length}}))}function Kr(t,e,n,r,o,i=Kn){e.style.touchAction=i;let a=[];function l(f){a.push(f),wt(e,t,f,a,"down"),r==null||r(a,f);const m=f.pointerId;function p(C){m===C.pointerId&&(a=Yr(C,a),a.length||h(),wt(e,t,C,a,"up"),o==null||o(a,C))}function h(){c(),b(),v(),d()}const c=ft(e,"pointermove",C=>{a=a.map(B=>C.pointerId===B.pointerId?C:B),wt(e,t,C,a,"move"),n==null||n(a,C)}),b=ft(e,"lostpointercapture",C=>{p(C)}),v=ft(e,"pointerup",C=>{p(C)}),d=ft(e,"pointerleave",C=>{a=[],h(),wt(e,t,C,a,"up"),o==null||o(a,C)})}const s=ft(e,"pointerdown",l);return{destroy:()=>{s()}}}function Ur(t,e={timeframe:qr,minSwipeDistance:jr,touchAction:Kn}){const n="swipe";let r,o,i,a;function l(f,m){o=m.clientX,i=m.clientY,r=Date.now(),f.length===1&&(a=m.target)}function s(f,m){if(m.type==="pointerup"&&f.length===0&&Date.now()-r<e.timeframe){const p=m.clientX-o,h=m.clientY-i,c=Math.abs(p),b=Math.abs(h);let v=null;c>=2*b&&c>e.minSwipeDistance?v=p>0?"right":"left":b>=2*c&&b>e.minSwipeDistance&&(v=h>0?"bottom":"top"),v&&t.dispatchEvent(new CustomEvent(n,{detail:{direction:v,target:a}}))}}return Kr(n,t,null,l,s,e.touchAction)}/**
 * @license BSD-3-Clause
 * Copyright (c) 2022, ッツ Reader Authors
 * All rights reserved.
 */class Jr{constructor(e,n,r,o,i,a,l,s,f,m,p){this.contentEl=e,this.scrollEl=n,this.sections=r,this.sectionIndex$=o,this.virtualScrollPos$=i,this.width=a,this.height=l,this.pageGap=s,this.verticalMode=f,this.pageChange$=m,this.sectionRenderComplete$=p,this.translateX=0,this.sectionData=new Map,en.pipe(pt(1)).subscribe(h=>{!h.length||(h.forEach(c=>{this.sectionData.set(c.reference,{...c,progress:0})}),Dt.next(this.sectionData))})}nextPage(){this.flipPage(1)}prevPage(){this.flipPage(-1)}flipPage(e){const n=this.verticalMode?"scrollHeight":"scrollWidth",r=this.verticalMode?this.height:this.width,o=r+this.pageGap,i=!0;if(this.translateX){const p=()=>{this.contentEl.style.removeProperty("transform"),this.translateX=0};if(e<0){const h=this.translateX;p(),this.scrollToPos(-h-o,i);return}if(this.nextSection(i)){p();return}return}const a=0,l=this.scrollEl[n],s=this.virtualScrollPos$.getValue(),f=s+o*e,m=Math.ceil(f);if(m<a){if(s!==a){this.scrollToPos(a,i);return}this.prevSection(o,n,r,i);return}if(m>=l){this.nextSection(i);return}this.scrollOrTranslateToPos(f,l,r,i)}scrollTo(e,n){const r=this.verticalMode?"scrollHeight":"scrollWidth",o=this.verticalMode?this.height:this.width;this.scrollOrTranslateToPos(e,this.scrollEl[r],o,n)}prevSection(e,n,r,o){const i=this.sectionIndex$.getValue()-1;return i<0?!1:(this.updateSectionIndex(i).subscribe(()=>{const a=this.scrollEl[n];let l=e*(Math.ceil(a/e)-1);Math.ceil(l)>=a&&(l-=e),this.scrollOrTranslateToPos(l,a,r,o)}),!0)}nextSection(e){const n=this.sectionIndex$.getValue()+1;return n>=this.sections.length?!1:(this.updateSectionIndex(n).subscribe(()=>{var r,o;this.scrollToPos(0,e),this.updateSectionData((r=this.sections[n-1])==null?void 0:r.id,100,!1),this.updateSectionData((o=this.sections[n])==null?void 0:o.id,0)}),!0)}scrollOrTranslateToPos(e,n,r,o){var a;if(this.updateSectionData((a=this.sections[this.sectionIndex$.getValue()])==null?void 0:a.id,e/n*100),this.verticalMode){this.scrollToPos(e,o);return}if(e+r<=n){this.scrollToPos(e,o);return}this.translateXToPos(-e,o)}scrollToPos(e,n){this.virtualScrollPos$.next(e),this.scrollEl.scrollTo({[this.verticalMode?"top":"left"]:e}),this.pageChange$.next(n)}translateXToPos(e,n){this.virtualScrollPos$.next(-e),this.contentEl.style.transform=`translateX(${e}px)`,this.translateX=e,this.pageChange$.next(n)}updateSectionIndex(e){return new Qe(n=>{if(this.sectionIndex$.getValue()===e){n.next(),n.complete();return}const r=this.sectionRenderComplete$.subscribe(o=>{o===e&&n.next(),n.complete(),r.unsubscribe()});return this.sectionIndex$.next(e),r})}updateSectionData(e,n,r=!0){if(!e||!this.sectionData.has(e))return;const o=[...this.sectionData.values()];let i=!1;o.forEach(a=>{const l=this.sectionData.get(a.reference),s=a.reference===e;s?l.progress=n:i?l.progress=0:l.progress=100,!i&&s&&(i=!0),this.sectionData.set(a.reference,l)}),r&&Dt.next(this.sectionData)}}/**
 * @license BSD-3-Clause
 * Copyright (c) 2022, ッツ Reader Authors
 * All rights reserved.
 */class Qr{constructor(e,n,r,o,i,a,l,s,f){this.containerEl=e,this.sections=n,this.virtualScrollPos$=r,this.getWidth=o,this.getHeight=i,this.getPageGap=a,this.verticalMode=l,this.scrollEl=s,this.document=f,this.sectionIndex=-1;const m=h=>Rn(h).reduce((b,v)=>b+zn(v),0);let p=0;this.sectionAccCharCounts=n.map(h=>(p+=m(h),p)),this.charCount=p}updateCurrentSection(e){this.calculator=new Yn(this.containerEl,this.verticalMode?"horizontal":"vertical","ltr",this.scrollEl,this.document),this.sectionIndex=e}updateParagraphPos(){!this.calculator||this.calculator.updateParagraphPos(this.virtualScrollPos$.getValue())}calcExploredCharCount(){const e=this.verticalMode?0:-this.screenSize;return this.getCharCountByScrollPos(this.virtualScrollPos$.getValue()+e)}getCharCountByScrollPos(e){if(!this.calculator)return-1;const n=this.getSectionStartCount();return this.calculator.getCharCountByScrollPos(e)+n}getSectionIndexByCharCount(e){return Tt(this.sectionAccCharCounts,e)+1}getScrollPosByCharCount(e){if(!this.calculator)return-1;const n=this.getSectionStartCount(),r=this.sectionAccCharCounts[this.sectionIndex],o=e-n,i=e===r&&r-n>0;if(o<0||e>r||i)return-1;if(o===0)return 0;const a=Tt(this.calculator.accumulatedCharCount,o),{accumulatedCharCount:l,paragraphPos:s}=this.calculator,f=l[a];if(Number.isNaN(Number(s[a])))return-1;const m=(v,d)=>v>=d?d:l[v]>f?v:m(v+1,d),p=s[m(a+1,l.length-1)],{screenSize:h}=this,c=this.verticalMode?-1:0,b=h*(Math.ceil(p/h)+c);return nt(b,this.calculator.direction)}isCharOnScreen(e){const n=this.getScrollPosByCharCount(e),r=this.virtualScrollPos$.getValue();return n===r}getSectionStartCount(){return this.sectionAccCharCounts[this.sectionIndex-1]||0}get screenSize(){return(this.verticalMode?this.getHeight():this.getWidth())+this.getPageGap()}}/**
 * @license BSD-3-Clause
 * Copyright (c) 2022, ッツ Reader Authors
 * All rights reserved.
 */class Zr{constructor(e,n,r,o,i){this.calculator=e,this.pageManager=n,this.sectionReady$=r,this.sectionIndex$=o,this.setIntendedCharCount=i}scrollToBookmark(e){const n=e.exploredCharCount;if(!n)return;const r=this.calculator.getSectionIndexByCharCount(n),o=l=>{const s=l.getScrollPosByCharCount(n);this.pageManager.scrollTo(s,!1),this.setIntendedCharCount(n)};if(this.sectionIndex$.getValue()===r){o(this.calculator);return}const a=this.sectionReady$.subscribe(l=>{o(l),a.unsubscribe()});this.sectionIndex$.next(r)}formatBookmarkData(e){const n=this.calculator.calcExploredCharCount(),r=this.calculator.charCount;return{dataId:e,exploredCharCount:n,progress:n/r,lastBookmarkModified:new Date().getTime()}}}function mn(t){let e,n,r;return n=new Ne({props:{icon:qo,spin:!0}}),{c(){e=Q("div"),ge(n.$$.fragment),this.h()},l(o){e=Z(o,"DIV",{class:!0});var i=x(e);ke(n.$$.fragment,i),i.forEach(D),this.h()},h(){q(e,"class","fixed inset-0 flex h-full w-full items-center justify-center text-7xl"),E(e,"color",t[4],!1),E(e,"background-color",t[5],!1)},m(o,i){L(o,e,i),pe(n,e,null),r=!0},p(o,i){i[0]&16&&E(e,"color",o[4],!1),i[0]&32&&E(e,"background-color",o[5],!1)},i(o){r||(W(n.$$.fragment,o),r=!0)},o(o){j(n.$$.fragment,o),r=!1},d(o){o&&D(e),be(n)}}}function dn(t){let e,n,r;return n=new Ne({props:{icon:dt}}),{c(){e=Q("div"),ge(n.$$.fragment),this.h()},l(o){e=Z(o,"DIV",{class:!0});var i=x(e);ke(n.$$.fragment,i),i.forEach(D),this.h()},h(){q(e,"class","fixed top-3 right-3 text-xl opacity-25"),E(e,"color",t[4],!1)},m(o,i){L(o,e,i),pe(n,e,null),r=!0},p(o,i){i[0]&16&&E(e,"color",o[4],!1)},i(o){r||(W(n.$$.fragment,o),r=!0)},o(o){j(n.$$.fragment,o),r=!1},d(o){o&&D(e),be(n)}}}function xr(t){let e,n,r,o=`${t[8]}px`,i=`${t[1]}px`,a=`${t[2]}px`,l=`${t[3]?t[1]:(t[1]+ot)/t[20]-ot}px`,s,f,m,p,h,c;r=new jn({props:{html:t[19]}}),r.$on("load",t[21]);let b=!t[18]&&mn(t),v=t[0]&&dn(t);return{c(){e=Q("div"),n=Q("div"),ge(r.$$.fragment),s=$(),b&&b.c(),f=$(),v&&v.c(),m=it(),this.h()},l(d){e=Z(d,"DIV",{class:!0});var C=x(e);n=Z(C,"DIV",{class:!0});var B=x(n);ke(r.$$.fragment,B),B.forEach(D),C.forEach(D),s=ee(d),b&&b.l(d),f=ee(d),v&&v.l(d),m=it(),this.h()},h(){q(n,"class","book-content-container svelte-1n4j7cq"),q(e,"class","book-content m-auto svelte-1n4j7cq"),z(e,"book-content--avoid-page-break",t[14]),z(e,"book-content--writing-vertical-rl",t[3]),z(e,"book-content--writing-horizontal-rl",!t[3]),z(e,"book-content--hide-furigana",t[12]),z(e,"book-content--hide-spoiler-image",t[11]),z(e,"book-content--furigana-style-partial",t[13]===Ie.Partial),z(e,"book-content--furigana-style-full",t[13]===Ie.Full),z(e,"book-content--furigana-style-toggle",t[13]===Ie.Toggle),E(e,"color",t[4],!1),E(e,"font-size",o,!1),E(e,"padding-top",!t[3]&&t[15]?`${t[15]}px`:void 0,!1),E(e,"padding-bottom",!t[3]&&t[15]?`${t[15]}px`:void 0,!1),E(e,"padding-left",t[3]&&t[15]?`${t[15]}px`:void 0,!1),E(e,"padding-right",t[3]&&t[15]?`${t[15]}px`:void 0,!1),E(e,"max-width",t[1]?`${t[1]}px`:void 0,!1),E(e,"max-height",t[3]&&t[2]?`${t[2]}px`:void 0,!1),E(e,"--font-family-serif",t[9],!1),E(e,"--font-family-sans-serif",t[10],!1),E(e,"--book-content-hint-furigana-font-color",t[6],!1),E(e,"--book-content-hint-furigana-shadow-color",t[7],!1),E(e,"--book-content-child-width",i,!1),E(e,"--book-content-child-height",a,!1),E(e,"--book-content-child-column-width",!t[3]&&t[20]===1?`${t[1]}px`:"",!1),E(e,"--book-content-column-count",t[20],!1),E(e,"--book-content-image-max-width",l,!1)},m(d,C){L(d,e,C),J(e,n),pe(r,n,null),t[37](n),t[38](e),L(d,s,C),b&&b.m(d,C),L(d,f,C),v&&v.m(d,C),L(d,m,C),p=!0,h||(c=[Fe(window,"keydown",t[23]),Zt(Ur.call(null,e,{timeframe:500,minSwipeDistance:10,touchAction:"pan-y"})),Fe(e,"swipe",t[22])],h=!0)},p(d,C){const B={};C[0]&524288&&(B.html=d[19]),r.$set(B),C[0]&16384&&z(e,"book-content--avoid-page-break",d[14]),C[0]&8&&z(e,"book-content--writing-vertical-rl",d[3]),C[0]&8&&z(e,"book-content--writing-horizontal-rl",!d[3]),C[0]&4096&&z(e,"book-content--hide-furigana",d[12]),C[0]&2048&&z(e,"book-content--hide-spoiler-image",d[11]),C[0]&8192&&z(e,"book-content--furigana-style-partial",d[13]===Ie.Partial),C[0]&8192&&z(e,"book-content--furigana-style-full",d[13]===Ie.Full),C[0]&8192&&z(e,"book-content--furigana-style-toggle",d[13]===Ie.Toggle),C[0]&16&&E(e,"color",d[4],!1),C[0]&256&&o!==(o=`${d[8]}px`)&&E(e,"font-size",o,!1),C[0]&32776&&E(e,"padding-top",!d[3]&&d[15]?`${d[15]}px`:void 0,!1),C[0]&32776&&E(e,"padding-bottom",!d[3]&&d[15]?`${d[15]}px`:void 0,!1),C[0]&32776&&E(e,"padding-left",d[3]&&d[15]?`${d[15]}px`:void 0,!1),C[0]&32776&&E(e,"padding-right",d[3]&&d[15]?`${d[15]}px`:void 0,!1),C[0]&2&&E(e,"max-width",d[1]?`${d[1]}px`:void 0,!1),C[0]&12&&E(e,"max-height",d[3]&&d[2]?`${d[2]}px`:void 0,!1),C[0]&512&&E(e,"--font-family-serif",d[9],!1),C[0]&1024&&E(e,"--font-family-sans-serif",d[10],!1),C[0]&64&&E(e,"--book-content-hint-furigana-font-color",d[6],!1),C[0]&128&&E(e,"--book-content-hint-furigana-shadow-color",d[7],!1),C[0]&2&&i!==(i=`${d[1]}px`)&&E(e,"--book-content-child-width",i,!1),C[0]&4&&a!==(a=`${d[2]}px`)&&E(e,"--book-content-child-height",a,!1),C[0]&1048586&&E(e,"--book-content-child-column-width",!d[3]&&d[20]===1?`${d[1]}px`:"",!1),C[0]&1048576&&E(e,"--book-content-column-count",d[20],!1),C[0]&1048586&&l!==(l=`${d[3]?d[1]:(d[1]+ot)/d[20]-ot}px`)&&E(e,"--book-content-image-max-width",l,!1),d[18]?b&&(Le(),j(b,1,1,()=>{b=null}),Ge()):b?(b.p(d,C),C[0]&262144&&W(b,1)):(b=mn(d),b.c(),W(b,1),b.m(f.parentNode,f)),d[0]?v?(v.p(d,C),C[0]&1&&W(v,1)):(v=dn(d),v.c(),W(v,1),v.m(m.parentNode,m)):v&&(Le(),j(v,1,1,()=>{v=null}),Ge())},i(d){p||(W(r.$$.fragment,d),W(b),W(v),p=!0)},o(d){j(r.$$.fragment,d),j(b),j(v),p=!1},d(d){d&&D(e),be(r),t[37](null),t[38](null),d&&D(s),b&&b.d(d),d&&D(f),v&&v.d(d),d&&D(m),h=!1,Ot(c)}}}const gn="overflow-hidden",ot=20;function $r(t,e,n){let r,o;K(t,rt,M=>n(42,o=M));let{htmlContent:i}=e,{width:a}=e,{height:l}=e,{verticalMode:s}=e,{fontColor:f}=e,{backgroundColor:m}=e,{hintFuriganaFontColor:p}=e,{hintFuriganaShadowColor:h}=e,{fontSize:c}=e,{fontFamilyGroupOne:b}=e,{fontFamilyGroupTwo:v}=e,{hideSpoilerImage:d}=e,{hideFurigana:C}=e,{furiganaStyle:B}=e,{loadingState:u}=e,{bookmarkData:_}=e,{pageManager:P}=e,{bookmarkManager:V}=e,{exploredCharCount:I}=e,{bookCharCount:Y}=e,{isBookmarkScreen:oe=!1}=e,{avoidPageBreak:ae=!0}=e,{pageColumns:k}=e,{firstDimensionMargin:T}=e,{autoBookmark:w=!1}=e;const A=At();let R,X,G,te=[],N,U,y,O=!1,le="",H=!0,_e=0;const se=new Pe,ve=new Pe,ce=new Bt(-1),Ce=new Pe,Ee=new Bt(0),De=new Pe,ye=new Pe,we=ce.pipe(Se(M=>{var ne;return((ne=te[M])==null?void 0:ne.innerHTML)||""})),de=new Pe;Qt(()=>{document.body.classList.remove(gn),de.next(),de.complete()}),gt([se,ve]).pipe(Xt(1),mt(()=>ye.pipe(pt(1))),Oe(de)).subscribe(()=>{if(!G||!N)return;const M=G.getScrollPosByCharCount(_e);M<0||N.scrollTo(M,!1)}),Ce.pipe(Oe(de)).subscribe(M=>{!G||(n(26,I=G.calcExploredCharCount()),M&&(_e=I),_.then(Ae))}),w&&Ce.pipe(Et(3e3),Oe(de)).subscribe(M=>{M&&A("bookmark")}),we.pipe(Xn(),Oe(de)).subscribe(()=>{n(18,O=!1)}),we.pipe(Oe(de)).subscribe(M=>{const ne=(F,re)=>{if(re===0){F();return}requestAnimationFrame(()=>ne(F,re-1))};ne(()=>{n(19,le=M)},2)}),ct(()=>qe(document.body,"wheel",{passive:!0})).pipe(go(50),Oe(de)).subscribe(M=>{if(!o){let ne=(M.deltaX<0?-1:1)*(s?-1:1);M.deltaX||(ne=M.deltaY<0?-1:1),N==null||N.flipPage(ne)}});function Ve(){if(H){H=!1;return}!R||(n(33,G=new Qr(R,te,Ee,()=>a,()=>l,()=>ot,s,R,document)),n(26,I=0),_e=0,n(27,Y=G.charCount),G.updateCurrentSection(ce.getValue()),A("contentChange",R))}function Re(M){M.updateParagraphPos(),n(26,I=M.calcExploredCharCount()),ye.next(M),_.then(Ae),y&&(y=!1,_.then(ne=>{!ne||!V||V.scrollToBookmark(ne)})),n(18,O=!0)}function Ae(M){const ne=M==null?void 0:M.exploredCharCount;!G||!ne||n(0,oe=G.isCharOnScreen(ne))}function Ze(M){if(!N||o||M.detail.direction!=="left"&&M.detail.direction!=="right")return;const ne=M.detail.direction==="left",F=s?!ne:ne;N.flipPage(F?1:-1)}function je(M){if(!(!N||o))switch(M.code){case"ArrowLeft":N[s?"nextPage":"prevPage"]();break;case"ArrowRight":N[s?"prevPage":"nextPage"]();break;case"ArrowUp":N.prevPage();break;case"ArrowDown":N.nextPage();break}}bt.pipe(Oe(de)).subscribe(M=>{const ne=te.findIndex(F=>F.id===M||F.querySelector(`[id="${M}"]`));ne>-1&&(ce.next(ne),N==null||N.scrollTo(0,!0))});function He(M){ie[M?"unshift":"push"](()=>{X=M,n(17,X)})}function xe(M){ie[M?"unshift":"push"](()=>{R=M,n(16,R)})}return t.$$set=M=>{"htmlContent"in M&&n(28,i=M.htmlContent),"width"in M&&n(1,a=M.width),"height"in M&&n(2,l=M.height),"verticalMode"in M&&n(3,s=M.verticalMode),"fontColor"in M&&n(4,f=M.fontColor),"backgroundColor"in M&&n(5,m=M.backgroundColor),"hintFuriganaFontColor"in M&&n(6,p=M.hintFuriganaFontColor),"hintFuriganaShadowColor"in M&&n(7,h=M.hintFuriganaShadowColor),"fontSize"in M&&n(8,c=M.fontSize),"fontFamilyGroupOne"in M&&n(9,b=M.fontFamilyGroupOne),"fontFamilyGroupTwo"in M&&n(10,v=M.fontFamilyGroupTwo),"hideSpoilerImage"in M&&n(11,d=M.hideSpoilerImage),"hideFurigana"in M&&n(12,C=M.hideFurigana),"furiganaStyle"in M&&n(13,B=M.furiganaStyle),"loadingState"in M&&n(29,u=M.loadingState),"bookmarkData"in M&&n(30,_=M.bookmarkData),"pageManager"in M&&n(24,P=M.pageManager),"bookmarkManager"in M&&n(25,V=M.bookmarkManager),"exploredCharCount"in M&&n(26,I=M.exploredCharCount),"bookCharCount"in M&&n(27,Y=M.bookCharCount),"isBookmarkScreen"in M&&n(0,oe=M.isBookmarkScreen),"avoidPageBreak"in M&&n(14,ae=M.avoidPageBreak),"pageColumns"in M&&n(31,k=M.pageColumns),"firstDimensionMargin"in M&&n(15,T=M.firstDimensionMargin),"autoBookmark"in M&&n(32,w=M.autoBookmark)},t.$$.update=()=>{if(t.$$.dirty[0]&1073741824&&_.then(Ae),t.$$.dirty[0]&2&&a&&se.next(a),t.$$.dirty[0]&4&&l&&ve.next(l),t.$$.dirty[0]&10|t.$$.dirty[1]&1&&n(20,r=s?1:k||Math.ceil(a/1e3)),t.$$.dirty[0]&268435456&&i&&(y=!0),t.$$.dirty[0]&268435456){const M=document.createElement("div");M.innerHTML=i,n(34,te=Array.from(M.children)),ce.next(0)}if(t.$$.dirty[0]&196622|t.$$.dirty[1]&24&&X&&R&&te&&(n(35,N=new Jr(X,R,te,ce,Ee,a,l,ot,s,Ce,De)),n(24,P=N)),t.$$.dirty[0]&536870918|t.$$.dirty[1]&4&&G&&a&&l&&!u){const M=G;requestAnimationFrame(()=>{Re(M)})}t.$$.dirty[0]&536870912|t.$$.dirty[1]&4&&G&&!u&&De.next(ce.getValue()),t.$$.dirty[1]&52&&G&&N&&(n(36,U=new Zr(G,N,ye,ce,M=>_e=M)),n(25,V=U))},document.body.classList.add(gn),[oe,a,l,s,f,m,p,h,c,b,v,d,C,B,ae,T,R,X,O,le,r,Ve,Ze,je,P,V,I,Y,i,u,_,k,w,G,te,N,U,He,xe]}class ei extends Ke{constructor(e){super(),Ue(this,e,$r,xr,Je,{htmlContent:28,width:1,height:2,verticalMode:3,fontColor:4,backgroundColor:5,hintFuriganaFontColor:6,hintFuriganaShadowColor:7,fontSize:8,fontFamilyGroupOne:9,fontFamilyGroupTwo:10,hideSpoilerImage:11,hideFurigana:12,furiganaStyle:13,loadingState:29,bookmarkData:30,pageManager:24,bookmarkManager:25,exploredCharCount:26,bookCharCount:27,isBookmarkScreen:0,avoidPageBreak:14,pageColumns:31,firstDimensionMargin:15,autoBookmark:32},null,[-1,-1])}}function ti(t){var d,C,B;let e,n,r,o,i,a,l,s;function f(u){t[48](u)}function m(u){t[49](u)}function p(u){t[50](u)}function h(u){t[51](u)}function c(u){t[52](u)}function b(u){t[53](u)}let v={htmlContent:t[7],width:(d=t[28])!=null?d:0,height:(C=t[29])!=null?C:0,verticalMode:t[8],fontColor:t[9],backgroundColor:t[10],hintFuriganaFontColor:t[11],hintFuriganaShadowColor:t[12],fontSize:t[13],fontFamilyGroupOne:t[14],fontFamilyGroupTwo:t[15],hideSpoilerImage:t[16],hideFurigana:t[17],furiganaStyle:t[18],loadingState:(B=t[30])!=null?B:!0,avoidPageBreak:t[22],pageColumns:t[23],autoBookmark:t[24],firstDimensionMargin:t[20]};return t[0]!==void 0&&(v.exploredCharCount=t[0]),t[1]!==void 0&&(v.bookCharCount=t[1]),t[6]!==void 0&&(v.isBookmarkScreen=t[6]),t[2]!==void 0&&(v.bookmarkData=t[2]),t[4]!==void 0&&(v.bookmarkManager=t[4]),t[5]!==void 0&&(v.pageManager=t[5]),e=new ei({props:v}),ie.push(()=>he(e,"exploredCharCount",f)),ie.push(()=>he(e,"bookCharCount",m)),ie.push(()=>he(e,"isBookmarkScreen",p)),ie.push(()=>he(e,"bookmarkData",h)),ie.push(()=>he(e,"bookmarkManager",c)),ie.push(()=>he(e,"pageManager",b)),e.$on("contentChange",t[54]),e.$on("bookmark",t[55]),{c(){ge(e.$$.fragment)},l(u){ke(e.$$.fragment,u)},m(u,_){pe(e,u,_),s=!0},p(u,_){var V,I,Y;const P={};_[0]&128&&(P.htmlContent=u[7]),_[0]&268435456&&(P.width=(V=u[28])!=null?V:0),_[0]&536870912&&(P.height=(I=u[29])!=null?I:0),_[0]&256&&(P.verticalMode=u[8]),_[0]&512&&(P.fontColor=u[9]),_[0]&1024&&(P.backgroundColor=u[10]),_[0]&2048&&(P.hintFuriganaFontColor=u[11]),_[0]&4096&&(P.hintFuriganaShadowColor=u[12]),_[0]&8192&&(P.fontSize=u[13]),_[0]&16384&&(P.fontFamilyGroupOne=u[14]),_[0]&32768&&(P.fontFamilyGroupTwo=u[15]),_[0]&65536&&(P.hideSpoilerImage=u[16]),_[0]&131072&&(P.hideFurigana=u[17]),_[0]&262144&&(P.furiganaStyle=u[18]),_[0]&1073741824&&(P.loadingState=(Y=u[30])!=null?Y:!0),_[0]&4194304&&(P.avoidPageBreak=u[22]),_[0]&8388608&&(P.pageColumns=u[23]),_[0]&16777216&&(P.autoBookmark=u[24]),_[0]&1048576&&(P.firstDimensionMargin=u[20]),!n&&_[0]&1&&(n=!0,P.exploredCharCount=u[0],me(()=>n=!1)),!r&&_[0]&2&&(r=!0,P.bookCharCount=u[1],me(()=>r=!1)),!o&&_[0]&64&&(o=!0,P.isBookmarkScreen=u[6],me(()=>o=!1)),!i&&_[0]&4&&(i=!0,P.bookmarkData=u[2],me(()=>i=!1)),!a&&_[0]&16&&(a=!0,P.bookmarkManager=u[4],me(()=>a=!1)),!l&&_[0]&32&&(l=!0,P.pageManager=u[5],me(()=>l=!1)),e.$set(P)},i(u){s||(W(e.$$.fragment,u),s=!0)},o(u){j(e.$$.fragment,u),s=!1},d(u){be(e,u)}}}function ni(t){var d,C,B;let e,n,r,o,i,a,l,s;function f(u){t[40](u)}function m(u){t[41](u)}function p(u){t[42](u)}function h(u){t[43](u)}function c(u){t[44](u)}function b(u){t[45](u)}let v={htmlContent:t[7],width:(d=t[28])!=null?d:0,height:(C=t[29])!=null?C:0,verticalMode:t[8],fontColor:t[9],backgroundColor:t[10],hintFuriganaFontColor:t[11],hintFuriganaShadowColor:t[12],fontSize:t[13],fontFamilyGroupOne:t[14],fontFamilyGroupTwo:t[15],hideSpoilerImage:t[16],hideFurigana:t[17],furiganaStyle:t[18],secondDimensionMaxValue:t[19],firstDimensionMargin:t[20],autoPositionOnResize:t[21],autoBookmark:t[24],multiplier:t[26],loadingState:(B=t[30])!=null?B:!0};return t[0]!==void 0&&(v.exploredCharCount=t[0]),t[1]!==void 0&&(v.bookCharCount=t[1]),t[2]!==void 0&&(v.bookmarkData=t[2]),t[3]!==void 0&&(v.autoScroller=t[3]),t[4]!==void 0&&(v.bookmarkManager=t[4]),t[5]!==void 0&&(v.pageManager=t[5]),e=new Rr({props:v}),ie.push(()=>he(e,"exploredCharCount",f)),ie.push(()=>he(e,"bookCharCount",m)),ie.push(()=>he(e,"bookmarkData",p)),ie.push(()=>he(e,"autoScroller",h)),ie.push(()=>he(e,"bookmarkManager",c)),ie.push(()=>he(e,"pageManager",b)),e.$on("contentChange",t[46]),e.$on("bookmark",t[47]),{c(){ge(e.$$.fragment)},l(u){ke(e.$$.fragment,u)},m(u,_){pe(e,u,_),s=!0},p(u,_){var V,I,Y;const P={};_[0]&128&&(P.htmlContent=u[7]),_[0]&268435456&&(P.width=(V=u[28])!=null?V:0),_[0]&536870912&&(P.height=(I=u[29])!=null?I:0),_[0]&256&&(P.verticalMode=u[8]),_[0]&512&&(P.fontColor=u[9]),_[0]&1024&&(P.backgroundColor=u[10]),_[0]&2048&&(P.hintFuriganaFontColor=u[11]),_[0]&4096&&(P.hintFuriganaShadowColor=u[12]),_[0]&8192&&(P.fontSize=u[13]),_[0]&16384&&(P.fontFamilyGroupOne=u[14]),_[0]&32768&&(P.fontFamilyGroupTwo=u[15]),_[0]&65536&&(P.hideSpoilerImage=u[16]),_[0]&131072&&(P.hideFurigana=u[17]),_[0]&262144&&(P.furiganaStyle=u[18]),_[0]&524288&&(P.secondDimensionMaxValue=u[19]),_[0]&1048576&&(P.firstDimensionMargin=u[20]),_[0]&2097152&&(P.autoPositionOnResize=u[21]),_[0]&16777216&&(P.autoBookmark=u[24]),_[0]&67108864&&(P.multiplier=u[26]),_[0]&1073741824&&(P.loadingState=(Y=u[30])!=null?Y:!0),!n&&_[0]&1&&(n=!0,P.exploredCharCount=u[0],me(()=>n=!1)),!r&&_[0]&2&&(r=!0,P.bookCharCount=u[1],me(()=>r=!1)),!o&&_[0]&4&&(o=!0,P.bookmarkData=u[2],me(()=>o=!1)),!i&&_[0]&8&&(i=!0,P.autoScroller=u[3],me(()=>i=!1)),!a&&_[0]&16&&(a=!0,P.bookmarkManager=u[4],me(()=>a=!1)),!l&&_[0]&32&&(l=!0,P.pageManager=u[5],me(()=>l=!1)),e.$set(P)},i(u){s||(W(e.$$.fragment,u),s=!0)},o(u){j(e.$$.fragment,u),s=!1},d(u){be(e,u)}}}function oi(t){var p;let e,n,r,o,i=((p=t[31])!=null?p:"")+"",a,l;const s=[ni,ti],f=[];function m(h,c){return h[25]===Mt.Continuous?0:1}return n=m(t),r=f[n]=s[n](t),{c(){e=Q("div"),r.c(),o=$(),a=ue(i),this.h()},l(h){e=Z(h,"DIV",{class:!0});var c=x(e);r.l(c),c.forEach(D),o=ee(h),a=fe(h,i),this.h()},h(){q(e,"class",zr+" py-8")},m(h,c){L(h,e,c),f[n].m(e,null),t[56](e),L(h,o,c),L(h,a,c),l=!0},p(h,c){var v;let b=n;n=m(h),n===b?f[n].p(h,c):(Le(),j(f[b],1,1,()=>{f[b]=null}),Ge(),r=f[n],r?r.p(h,c):(r=f[n]=s[n](h),r.c()),W(r,1),r.m(e,null)),(!l||c[1]&1)&&i!==(i=((v=h[31])!=null?v:"")+"")&&Be(a,i)},i(h){l||(W(r),l=!0)},o(h){j(r),l=!1},d(h){h&&D(e),f[n].d(),t[56](null),h&&D(o),h&&D(a)}}}function St(t){return Number(t.replace(/px$/,""))}function ri(t,e,n){let r,o,i,a,l,s,{htmlContent:f}=e,{width:m}=e,{height:p}=e,{verticalMode:h}=e,{fontColor:c}=e,{backgroundColor:b}=e,{hintFuriganaFontColor:v}=e,{hintFuriganaShadowColor:d}=e,{fontSize:C}=e,{fontFamilyGroupOne:B}=e,{fontFamilyGroupTwo:u}=e,{hideSpoilerImage:_}=e,{hideFurigana:P}=e,{furiganaStyle:V}=e,{secondDimensionMaxValue:I}=e,{firstDimensionMargin:Y}=e,{autoPositionOnResize:oe}=e,{avoidPageBreak:ae}=e,{pageColumns:k}=e,{autoBookmark:T}=e,{viewMode:w}=e,{exploredCharCount:A}=e,{bookCharCount:R}=e,{multiplier:X}=e,{bookmarkData:G}=e,{autoScroller:te}=e,{bookmarkManager:N}=e,{pageManager:U}=e,{isBookmarkScreen:y}=e;const O=new Pe,le=new Pe,H=er(null);K(t,H,g=>n(27,o=g));const _e=gt([H.pipe(Vt(g=>!!g)),gt([O,le]).pipe(qt(0))]).pipe(Et(0,Rt),Se(([g])=>getComputedStyle(g)),jt({refCount:!0,bufferSize:1})),se=new ko(1),ve=_e.pipe(Se(g=>De(m-St(g.paddingLeft)-St(g.paddingRight))));K(t,ve,g=>n(28,i=g));const ce=_e.pipe(Se(g=>ye(p-St(g.paddingTop)-St(g.paddingBottom)-r)));K(t,ce,g=>n(29,a=g));const Ce=ct(()=>Wn(document)).pipe(yt(g=>{const Lt=Nr(g,V);return se.pipe(yt(Gt=>Lt(Gt)))}),tt());K(t,Ce,g=>n(31,s=g));const Ee=se.pipe(yt(g=>Lr(g)),Yt());K(t,Ee,g=>n(30,l=g));function De(g){return Mt.Paginated===w&&!h&&I?Math.min(I,g):g}function ye(g){return Mt.Paginated===w&&h&&I?Math.min(I,g):g}function we(g){A=g,n(0,A)}function de(g){R=g,n(1,R)}function Ve(g){G=g,n(2,G)}function Re(g){te=g,n(3,te)}function Ae(g){N=g,n(4,N)}function Ze(g){U=g,n(5,U)}const je=g=>se.next(g.detail);function He(g){tn.call(this,t,g)}function xe(g){A=g,n(0,A)}function M(g){R=g,n(1,R)}function ne(g){y=g,n(6,y)}function F(g){G=g,n(2,G)}function re(g){N=g,n(4,N)}function We(g){U=g,n(5,U)}const Te=g=>se.next(g.detail);function ze(g){tn.call(this,t,g)}function Ct(g){ie[g?"unshift":"push"](()=>{o=g,H.set(o)})}return t.$$set=g=>{"htmlContent"in g&&n(7,f=g.htmlContent),"width"in g&&n(38,m=g.width),"height"in g&&n(39,p=g.height),"verticalMode"in g&&n(8,h=g.verticalMode),"fontColor"in g&&n(9,c=g.fontColor),"backgroundColor"in g&&n(10,b=g.backgroundColor),"hintFuriganaFontColor"in g&&n(11,v=g.hintFuriganaFontColor),"hintFuriganaShadowColor"in g&&n(12,d=g.hintFuriganaShadowColor),"fontSize"in g&&n(13,C=g.fontSize),"fontFamilyGroupOne"in g&&n(14,B=g.fontFamilyGroupOne),"fontFamilyGroupTwo"in g&&n(15,u=g.fontFamilyGroupTwo),"hideSpoilerImage"in g&&n(16,_=g.hideSpoilerImage),"hideFurigana"in g&&n(17,P=g.hideFurigana),"furiganaStyle"in g&&n(18,V=g.furiganaStyle),"secondDimensionMaxValue"in g&&n(19,I=g.secondDimensionMaxValue),"firstDimensionMargin"in g&&n(20,Y=g.firstDimensionMargin),"autoPositionOnResize"in g&&n(21,oe=g.autoPositionOnResize),"avoidPageBreak"in g&&n(22,ae=g.avoidPageBreak),"pageColumns"in g&&n(23,k=g.pageColumns),"autoBookmark"in g&&n(24,T=g.autoBookmark),"viewMode"in g&&n(25,w=g.viewMode),"exploredCharCount"in g&&n(0,A=g.exploredCharCount),"bookCharCount"in g&&n(1,R=g.bookCharCount),"multiplier"in g&&n(26,X=g.multiplier),"bookmarkData"in g&&n(2,G=g.bookmarkData),"autoScroller"in g&&n(3,te=g.autoScroller),"bookmarkManager"in g&&n(4,N=g.bookmarkManager),"pageManager"in g&&n(5,U=g.pageManager),"isBookmarkScreen"in g&&n(6,y=g.isBookmarkScreen)},t.$$.update=()=>{t.$$.dirty[0]&34603264&&(r=Y&&Mt.Paginated===w&&!h?Y*2:0),t.$$.dirty[1]&128&&O.next(m),t.$$.dirty[1]&256&&le.next(p)},[A,R,G,te,N,U,y,f,h,c,b,v,d,C,B,u,_,P,V,I,Y,oe,ae,k,T,w,X,o,i,a,l,s,H,se,ve,ce,Ce,Ee,m,p,we,de,Ve,Re,Ae,Ze,je,He,xe,M,ne,F,re,We,Te,ze,Ct]}class ii extends Ke{constructor(e){super(),Ue(this,e,ri,oi,Je,{htmlContent:7,width:38,height:39,verticalMode:8,fontColor:9,backgroundColor:10,hintFuriganaFontColor:11,hintFuriganaShadowColor:12,fontSize:13,fontFamilyGroupOne:14,fontFamilyGroupTwo:15,hideSpoilerImage:16,hideFurigana:17,furiganaStyle:18,secondDimensionMaxValue:19,firstDimensionMargin:20,autoPositionOnResize:21,avoidPageBreak:22,pageColumns:23,autoBookmark:24,viewMode:25,exploredCharCount:0,bookCharCount:1,multiplier:26,bookmarkData:2,autoScroller:3,bookmarkManager:4,pageManager:5,isBookmarkScreen:6},null,[-1,-1,-1])}}function ai(t,e){const n=document.createTextNode(e);if(t.firstChild){t.replaceChild(n,t.firstChild);return}t.appendChild(n)}function li(t,e,n){let{styleSheet:r}=e,o;return Tn(()=>{n(1,o=document.createElement("style")),document.head.appendChild(o)}),Qt(()=>{o&&document.head.removeChild(o)}),t.$$set=i=>{"styleSheet"in i&&n(0,r=i.styleSheet)},t.$$.update=()=>{t.$$.dirty&3&&o&&ai(o,r)},[r,o]}class si extends Ke{constructor(e){super(),Ue(this,e,li,null,Je,{styleSheet:0})}}function kn(t){let e,n,r,o,i;return n=new Ne({props:{icon:Yo}}),{c(){e=Q("div"),ge(n.$$.fragment),this.h()},l(a){e=Z(a,"DIV",{class:!0,role:!0});var l=x(e);ke(n.$$.fragment,l),l.forEach(D),this.h()},h(){q(e,"class",$t),q(e,"role","button")},m(a,l){L(a,e,l),pe(n,e,null),r=!0,o||(i=Fe(e,"click",t[5]),o=!0)},p:at,i(a){r||(W(n.$$.fragment,a),r=!0)},o(a){j(n.$$.fragment,a),r=!1},d(a){a&&D(e),be(n),o=!1,i()}}}function pn(t){let e,n,r,o,i;return n=new Ne({props:{icon:Ko}}),{c(){e=Q("div"),ge(n.$$.fragment),this.h()},l(a){e=Z(a,"DIV",{role:!0,class:!0});var l=x(e);ke(n.$$.fragment,l),l.forEach(D),this.h()},h(){q(e,"role","button"),q(e,"class",$t)},m(a,l){L(a,e,l),pe(n,e,null),r=!0,o||(i=Fe(e,"click",t[7]),o=!0)},p:at,i(a){r||(W(n.$$.fragment,a),r=!0)},o(a){j(n.$$.fragment,a),r=!1},d(a){a&&D(e),be(n),o=!1,i()}}}function ui(t){let e,n,r,o,i,a,l,s,f,m,p,h,c,b,v,d,C=t[0]&&kn(t);i=new Ne({props:{icon:t[3]?dt:sn}});let B=t[2]&&pn(t);return c=new jo({props:{items:[Ft.SETTINGS,Ft.MANAGE]}}),c.$on("action",t[8]),{c(){e=Q("div"),n=Q("div"),C&&C.c(),r=$(),o=Q("div"),ge(i.$$.fragment),a=$(),l=Q("div"),s=ue(t[1]),f=ue("x"),m=$(),p=Q("div"),B&&B.c(),h=$(),ge(c.$$.fragment),this.h()},l(u){e=Z(u,"DIV",{class:!0});var _=x(e);n=Z(_,"DIV",{class:!0});var P=x(n);C&&C.l(P),r=ee(P),o=Z(P,"DIV",{class:!0,role:!0});var V=x(o);ke(i.$$.fragment,V),V.forEach(D),a=ee(P),l=Z(P,"DIV",{class:!0});var I=x(l);s=fe(I,t[1]),f=fe(I,"x"),I.forEach(D),P.forEach(D),m=ee(_),p=Z(_,"DIV",{class:!0});var Y=x(p);B&&B.l(Y),h=ee(Y),ke(c.$$.fragment,Y),Y.forEach(D),_.forEach(D),this.h()},h(){q(o,"class",$t),q(o,"role","button"),q(l,"class","flex items-center px-4 text-xl xl:px-3 xl:text-lg"),q(n,"class","flex transform-gpu "+po),q(p,"class","flex transform-gpu "+bo),q(e,"class","flex justify-between bg-gray-700 px-4 md:px-8 "+Co)},m(u,_){L(u,e,_),J(e,n),C&&C.m(n,null),J(n,r),J(n,o),pe(i,o,null),J(n,a),J(n,l),J(l,s),J(l,f),J(e,m),J(e,p),B&&B.m(p,null),J(p,h),pe(c,p,null),b=!0,v||(d=Fe(o,"click",t[6]),v=!0)},p(u,[_]){u[0]?C?(C.p(u,_),_&1&&W(C,1)):(C=kn(u),C.c(),W(C,1),C.m(n,r)):C&&(Le(),j(C,1,1,()=>{C=null}),Ge());const P={};_&8&&(P.icon=u[3]?dt:sn),i.$set(P),(!b||_&2)&&Be(s,u[1]),u[2]?B?(B.p(u,_),_&4&&W(B,1)):(B=pn(u),B.c(),W(B,1),B.m(p,h)):B&&(Le(),j(B,1,1,()=>{B=null}),Ge())},i(u){b||(W(C),W(i.$$.fragment,u),W(B),W(c.$$.fragment,u),b=!0)},o(u){j(C),j(i.$$.fragment,u),j(B),j(c.$$.fragment,u),b=!1},d(u){u&&D(e),C&&C.d(),be(i),B&&B.d(),be(c),v=!1,d()}}}function fi(t,e,n){let{hasChapterData:r}=e,{autoScrollMultiplier:o}=e,{showFullscreenButton:i}=e,{isBookmarkScreen:a}=e;const l=At(),s=()=>l("tocClick"),f=()=>l("bookmarkClick"),m=()=>l("fullscreenClick"),p=({detail:h})=>{h===Ft.SETTINGS.label?l("settingsClick"):h===Ft.MANAGE.label&&l("bookManagerClick")};return t.$$set=h=>{"hasChapterData"in h&&n(0,r=h.hasChapterData),"autoScrollMultiplier"in h&&n(1,o=h.autoScrollMultiplier),"showFullscreenButton"in h&&n(2,i=h.showFullscreenButton),"isBookmarkScreen"in h&&n(3,a=h.isBookmarkScreen)},[r,o,i,a,l,s,f,m,p]}class ci extends Ke{constructor(e){super(),Ue(this,e,fi,ui,Je,{hasChapterData:0,autoScrollMultiplier:1,showFullscreenButton:2,isBookmarkScreen:3})}}function bn(t,e,n){const r=t.slice();return r[16]=e[n],r}function Cn(t,e){let n,r,o=e[16].label+"",i,a,l,s,f=e[16].startCharacter+"",m,p,h,c;function b(){return e[13](e[16])}return{key:t,first:null,c(){n=Q("div"),r=Q("div"),i=ue(o),l=$(),s=Q("div"),m=ue(f),p=$(),this.h()},l(v){n=Z(v,"DIV",{class:!0});var d=x(n);r=Z(d,"DIV",{id:!0,class:!0});var C=x(r);i=fe(C,o),C.forEach(D),l=ee(d),s=Z(d,"DIV",{});var B=x(s);m=fe(B,f),B.forEach(D),p=ee(d),d.forEach(D),this.h()},h(){q(r,"id",a=`for${e[16].reference}`),q(r,"class","mr-4 cursor-pointer"),z(r,"opacity-30",e[16].progress===100&&e[16]!==e[2]),z(r,"hover:opacity-100",e[16].progress===100&&e[16]!==e[2]),z(r,"hover:opacity-60",e[16].progress<100||e[16]===e[2]),z(s,"opacity-30",e[16].progress===100&&e[16]!==e[2]),q(n,"class","my-6 flex justify-between"),this.first=n},m(v,d){L(v,n,d),J(n,r),J(r,i),J(n,l),J(n,s),J(s,m),J(n,p),h||(c=Fe(r,"click",b),h=!0)},p(v,d){e=v,d&2&&o!==(o=e[16].label+"")&&Be(i,o),d&2&&a!==(a=`for${e[16].reference}`)&&q(r,"id",a),d&6&&z(r,"opacity-30",e[16].progress===100&&e[16]!==e[2]),d&6&&z(r,"hover:opacity-100",e[16].progress===100&&e[16]!==e[2]),d&6&&z(r,"hover:opacity-60",e[16].progress<100||e[16]===e[2]),d&2&&f!==(f=e[16].startCharacter+"")&&Be(m,f),d&6&&z(s,"opacity-30",e[16].progress===100&&e[16]!==e[2])},d(v){v&&D(n),h=!1,c()}}}function hi(t){let e,n,r,o,i,a,l,s,f,m,p,h,c=[],b=new Map,v,d,C,B,u,_,P,V,I,Y;m=new Ne({props:{icon:Uo}});let oe=t[1];const ae=k=>k[16].reference;for(let k=0;k<oe.length;k+=1){let T=bn(t,oe,k),w=ae(T);b.set(w,c[k]=Cn(w,T))}return B=new Ne({props:{icon:Jo}}),P=new Ne({props:{icon:Qo}}),{c(){e=Q("div"),n=Q("div"),r=ue("Chapter Progress: "),o=ue(t[3]),i=ue(" ("),a=ue(t[4]),l=ue("%)"),s=$(),f=Q("div"),ge(m.$$.fragment),p=$(),h=Q("div");for(let k=0;k<c.length;k+=1)c[k].c();v=$(),d=Q("div"),C=Q("div"),ge(B.$$.fragment),u=$(),_=Q("div"),ge(P.$$.fragment),this.h()},l(k){e=Z(k,"DIV",{class:!0});var T=x(e);n=Z(T,"DIV",{});var w=x(n);r=fe(w,"Chapter Progress: "),o=fe(w,t[3]),i=fe(w," ("),a=fe(w,t[4]),l=fe(w,"%)"),w.forEach(D),s=ee(T),f=Z(T,"DIV",{class:!0});var A=x(f);ke(m.$$.fragment,A),A.forEach(D),T.forEach(D),p=ee(k),h=Z(k,"DIV",{class:!0});var R=x(h);for(let N=0;N<c.length;N+=1)c[N].l(R);R.forEach(D),v=ee(k),d=Z(k,"DIV",{class:!0});var X=x(d);C=Z(X,"DIV",{class:!0});var G=x(C);ke(B.$$.fragment,G),G.forEach(D),u=ee(X),_=Z(X,"DIV",{class:!0});var te=x(_);ke(P.$$.fragment,te),te.forEach(D),X.forEach(D),this.h()},h(){q(f,"class","flex cursor-pointer items-end md:items-center"),q(e,"class","flex justify-between p-4"),q(h,"class","flex-1 overflow-auto p-4"),q(C,"class","cursor-pointer"),z(C,"opacity-30",!t[6]),q(_,"class","cursor-pointer"),z(_,"opacity-30",!t[5]),q(d,"class","flex justify-between px-4 py-6")},m(k,T){L(k,e,T),J(e,n),J(n,r),J(n,o),J(n,i),J(n,a),J(n,l),J(e,s),J(e,f),pe(m,f,null),L(k,p,T),L(k,h,T);for(let w=0;w<c.length;w+=1)c[w].m(h,null);L(k,v,T),L(k,d,T),J(d,C),pe(B,C,null),J(d,u),J(d,_),pe(P,_,null),V=!0,I||(Y=[Fe(f,"click",t[9]),Fe(C,"click",t[14]),Fe(_,"click",t[15])],I=!0)},p(k,[T]){(!V||T&8)&&Be(o,k[3]),(!V||T&16)&&Be(a,k[4]),T&262&&(oe=k[1],c=ro(c,T,ae,1,k,oe,b,h,io,Cn,null,bn)),T&64&&z(C,"opacity-30",!k[6]),T&32&&z(_,"opacity-30",!k[5])},i(k){V||(W(m.$$.fragment,k),W(B.$$.fragment,k),W(P.$$.fragment,k),V=!0)},o(k){j(m.$$.fragment,k),j(B.$$.fragment,k),j(P.$$.fragment,k),V=!1},d(k){k&&D(e),be(m),k&&D(p),k&&D(h);for(let T=0;T<c.length;T+=1)c[T].d();k&&D(v),k&&D(d),be(B),be(P),I=!1,Ot(Y)}}}function mi(t,e){const[n,r]=e.reduce((o,i,a)=>(o[0]+=t[a]*i,o[1]+=i,o),[0,0]);return n/r}function _n(t){!t||(t.scrollIntoViewIfNeeded?t.scrollIntoViewIfNeeded():t.scrollIntoView())}function di(t,e,n){let r,o,{sectionData:i=[]}=e,{exploredCharCount:a=0}=e,{verticalMode:l}=e,s=[],f,m=-1,p="0/0",h="0.00";Tn(()=>{ln.dialogs$.next([{component:"<div/>"}]),f&&_n(document.getElementById(`for${f.reference}`))});function c(u,_){if(u){const P=s[m+_];b(P.reference,!1)}}function b(u,_=!1){bt.next(u),_&&v()}function v(){rt.next(!1),ln.dialogs$.next([])}const d=u=>b(u.reference,!0),C=()=>c(r,l?1:-1),B=()=>c(o,l?-1:1);return t.$$set=u=>{"sectionData"in u&&n(10,i=u.sectionData),"exploredCharCount"in u&&n(11,a=u.exploredCharCount),"verticalMode"in u&&n(0,l=u.verticalMode)},t.$$.update=()=>{if(t.$$.dirty&5120&&i){const[u,_,P]=qn(i),V=i.filter(I=>I.reference===P||I.parentChapter===P);n(4,h=mi(V.map(I=>I.progress),V.map(I=>I.charactersWeight)).toFixed(2)),n(1,s=u),n(12,m=_),n(2,f=u[m])}if(t.$$.dirty&4099&&n(6,r=l?m<s.length-1:!!m),t.$$.dirty&4099&&n(5,o=l?!!m:m<s.length-1),t.$$.dirty&2052&&f){_n(document.getElementById(`for${f.reference}`));const u=f.characters;n(3,p=`${Math.min(Math.max(a-f.startCharacter,0),u)} / ${u}`)}},[l,s,f,p,h,o,r,c,b,v,i,a,m,d,C,B]}class gi extends Ke{constructor(e){super(),Ue(this,e,di,hi,Je,{sectionData:10,exploredCharCount:11,verticalMode:0})}}/**
 * @license BSD-3-Clause
 * Copyright (c) 2022, ッツ Reader Authors
 * All rights reserved.
 */class ki{constructor(e){this.document=e,this.fallbackSpec=wn(this.document)}get fullscreenEnabled(){var e;return(e=this.fallbackSpec("fullscreenEnabled","webkitFullscreenEnabled"))!=null?e:!1}get fullscreenElement(){var e;return(e=this.fallbackSpec("fullscreenElement","webkitFullscreenElement"))!=null?e:null}async requestFullscreen(e,n){const r=wn(e)("requestFullscreen","webkitRequestFullscreen");!r||await r(n)}async exitFullscreen(){const e=this.fallbackSpec("exitFullscreen","webkitExitFullscreen");!e||await e()}}function wn(t){return(e,n)=>{var r;return(r=Sn(t,e))!=null?r:Sn(t,n)}}function Sn(t,e){const n=t[e];return typeof n=="function"?n.bind(t):n}const Pt=new ki(document);/**
 * @license BSD-3-Clause
 * Copyright (c) 2022, ッツ Reader Authors
 * All rights reserved.
 */function pi(t,e){return bi(t).pipe(Se(n=>{const r=e.createElement("div");return r.innerHTML=n,Ci(r),_i(r),wi(r,e),Si(r),r.innerHTML}))}function bi(t){return new Qe(e=>{const{blobs:n}=t;let{elementHtml:r}=t;const o=[];return Object.entries(n).forEach(([i,a])=>{const l=URL.createObjectURL(a);o.push(l),r=r.replaceAll(_o(i),l).replaceAll(`ttu:${i}`,l)}),e.next(r),()=>{o.forEach(i=>URL.revokeObjectURL(i))}})}function Ci(t){Array.from(t.getElementsByTagName("img")).map(e=>({parentEl:e.parentElement,isGaiji:Gn(e)})).forEach(({parentEl:e,isGaiji:n})=>{e==null||e.classList.add("ttu-img-container"),n||e==null||e.classList.add("ttu-illustration-container")})}function _i(t){Array.from(t.getElementsByTagName("svg")).forEach(e=>{e.removeAttribute("width"),e.removeAttribute("height")})}function wi(t,e){const n=()=>{let o=[...t.children];const i=o.findIndex(a=>a.getElementsByTagName("a").length>1)+1;return i>0&&i<o.length&&(o=o.slice(i)),o},r=(o,i)=>{const a=e.createElement("span");a.toggleAttribute("data-ttu-spoiler-img"),(o.parentElement||i).insertBefore(a,o),a.appendChild(o)};n().forEach(o=>{Array.from(o.getElementsByTagName("img")).filter(i=>!Gn(i)).forEach(i=>r(i,o)),Array.from(o.getElementsByTagName("svg")).filter(i=>i.getElementsByTagName("image").length).forEach(i=>r(i,o))})}function Si(t){t.querySelectorAll(".placeholder-br").forEach(e=>{e.parentElement.removeChild(e)})}var vi=Un;function Un(t,e,n){t instanceof RegExp&&(t=vn(t,n)),e instanceof RegExp&&(e=vn(e,n));const r=Jn(t,e,n);return r&&{start:r[0],end:r[1],pre:n.slice(0,r[0]),body:n.slice(r[0]+t.length,r[1]),post:n.slice(r[1]+e.length)}}function vn(t,e){const n=e.match(t);return n?n[0]:null}Un.range=Jn;function Jn(t,e,n){let r,o,i,a,l,s=n.indexOf(t),f=n.indexOf(e,s+1),m=s;if(s>=0&&f>0){if(t===e)return[s,f];for(r=[],i=n.length;m>=0&&!l;)m===s?(r.push(m),s=n.indexOf(t,m+1)):r.length===1?l=[r.pop(),f]:(o=r.pop(),o<i&&(i=o,a=f),f=n.indexOf(e,m+1)),m=s<f&&s>=0?s:f;r.length&&(l=[i,a])}return l}function yi(t,e={}){const r=Object.assign({},{preserveStatic:!0,removeComments:!1},e),o=[];function i(w){throw new Error(`CSS parse error: ${w}`)}function a(w){const A=w.exec(t);if(A)return t=t.slice(A[0].length),A}function l(){return a(/^{\s*/)}function s(){return a(/^}/)}function f(){a(/^\s*/)}function m(){if(f(),t[0]!=="/"||t[1]!=="*")return;let w=2;for(;t[w]&&(t[w]!=="*"||t[w+1]!=="/");)w++;if(!t[w])return i("end of comment is missing");const A=t.slice(2,w);return t=t.slice(w+2),{type:"comment",comment:A}}function p(){const w=[];let A;for(;A=m();)w.push(A);return r.removeComments?[]:w}function h(){for(f();t[0]==="}";)i("extra closing bracket");const w=a(/^(("(?:\\"|[^"])*"|'(?:\\'|[^'])*'|[^{])+)/);if(w)return w[0].trim().replace(/\/\*([^*]|[\r\n]|(\*+([^*/]|[\r\n])))*\*\/+/g,"").replace(/"(?:\\"|[^"])*"|'(?:\\'|[^'])*'/g,function(A){return A.replace(/,/g,"\u200C")}).split(/\s*(?![^(]*\)),\s*/).map(function(A){return A.replace(/\u200C/g,",")})}function c(){if(t[0]==="@")return ae();a(/^([;\s]*)+/);const w=/\/\*[^*]*\*+([^/*][^*]*\*+)*\//g;let A=a(/^(\*?[-#/*\\\w]+(\[[0-9a-z_-]+\])?)\s*/);if(!A)return;if(A=A[0].trim(),!a(/^:\s*/))return i("property missing ':'");const R=a(/^((?:\/\*.*?\*\/|'(?:\\'|.)*?'|"(?:\\"|.)*?"|\((\s*'(?:\\'|.)*?'|"(?:\\"|.)*?"|[^)]*?)\s*\)|[^};])+)/),X={type:"declaration",property:A.replace(w,""),value:R?R[0].replace(w,"").trim():""};return a(/^[;\s]*/),X}function b(){if(!l())return i("missing '{'");let w,A=p();for(;w=c();)A.push(w),A=A.concat(p());return s()?A:i("missing '}'")}function v(){f();const w=[];let A;for(;A=a(/^((\d+\.\d+|\.\d+|\d+)%?|[a-z]+)\s*/);)w.push(A[1]),a(/^,\s*/);if(w.length)return{type:"keyframe",values:w,declarations:b()}}function d(){let w=a(/^@([-\w]+)?keyframes\s*/);if(!w)return;const A=w[1];if(w=a(/^([-\w]+)\s*/),!w)return i("@keyframes missing name");const R=w[1];if(!l())return i("@keyframes missing '{'");let X,G=p();for(;X=v();)G.push(X),G=G.concat(p());return s()?{type:"keyframes",name:R,vendor:A,keyframes:G}:i("@keyframes missing '}'")}function C(){if(a(/^@page */)){const A=h()||[];return{type:"page",selectors:A,declarations:b()}}}function B(){const w=a(/@(top|bottom|left|right)-(left|center|right|top|middle|bottom)-?(corner)?\s*/);if(w){const A=`${w[1]}-${w[2]}`+(w[3]?`-${w[3]}`:"");return{type:"page-margin-box",name:A,declarations:b()}}}function u(){if(a(/^@font-face\s*/))return{type:"font-face",declarations:b()}}function _(){const w=a(/^@supports *([^{]+)/);if(w)return{type:"supports",supports:w[1].trim(),rules:T()}}function P(){if(a(/^@host\s*/))return{type:"host",rules:T()}}function V(){const w=a(/^@media([^{]+)*/);if(w)return{type:"media",media:(w[1]||"").trim(),rules:T()}}function I(){const w=a(/^@custom-media\s+(--[^\s]+)\s*([^{;]+);/);if(w)return{type:"custom-media",name:w[1].trim(),media:w[2].trim()}}function Y(){const w=a(/^@([-\w]+)?document *([^{]+)/);if(w)return{type:"document",document:w[2].trim(),vendor:w[1]?w[1].trim():null,rules:T()}}function oe(){const w=a(/^@(import|charset|namespace)\s*([^;]+);/);if(w)return{type:w[1],name:w[2].trim()}}function ae(){if(f(),t[0]==="@"){const w=oe()||u()||V()||d()||_()||Y()||I()||P()||C()||B();if(w&&!r.preserveStatic){let A=!1;return w.declarations?A=w.declarations.some(R=>/var\(/.test(R.value)):A=(w.keyframes||w.rules||[]).some(X=>(X.declarations||[]).some(G=>/var\(/.test(G.value))),A?w:{}}return w}}function k(){if(!r.preserveStatic){const R=vi("{","}",t);if(R){const X=/:(?:root|host)(?![.:#(])/.test(R.pre)&&/--\S*\s*:/.test(R.body),G=/var\(/.test(R.body);if(!X&&!G)return t=t.slice(R.end+1),{}}}const w=h()||[],A=r.preserveStatic?b():b().filter(R=>{const X=w.some(te=>/:(?:root|host)(?![.:#(])/.test(te))&&/^--\S/.test(R.property),G=/var\(/.test(R.value);return X||G});return w.length||i("selector missing"),{type:"rule",selectors:w,declarations:A}}function T(w){if(!w&&!l())return i("missing '{'");let A,R=p();for(;t.length&&(w||t[0]!=="}")&&(A=ae()||k());)A.type&&R.push(A),R=R.concat(p());return!w&&!s()?i("missing '}'"):R}return{type:"stylesheet",stylesheet:{rules:T(!0),errors:o}}}function Mi(t,e="",n){const r={charset(i){return"@charset "+i.name+";"},comment(i){return i.comment.indexOf("__CSSVARSPONYFILL")===0?"/*"+i.comment+"*/":""},"custom-media"(i){return"@custom-media "+i.name+" "+i.media+";"},declaration(i){return i.property+":"+i.value+";"},document(i){return"@"+(i.vendor||"")+"document "+i.document+"{"+o(i.rules)+"}"},"font-face"(i){return"@font-face{"+o(i.declarations)+"}"},host(i){return"@host{"+o(i.rules)+"}"},import(i){return"@import "+i.name+";"},keyframe(i){return i.values.join(",")+"{"+o(i.declarations)+"}"},keyframes(i){return"@"+(i.vendor||"")+"keyframes "+i.name+"{"+o(i.keyframes)+"}"},media(i){return"@media "+i.media+"{"+o(i.rules)+"}"},namespace(i){return"@namespace "+i.name+";"},page(i){return"@page "+(i.selectors.length?i.selectors.join(", "):"")+"{"+o(i.declarations)+"}"},"page-margin-box"(i){return"@"+i.name+"{"+o(i.declarations)+"}"},rule(i){const a=i.declarations;if(a.length)return i.selectors.join(",")+"{"+o(a)+"}"},supports(i){return"@supports "+i.supports+"{"+o(i.rules)+"}"}};function o(i){let a="";for(let l=0;l<i.length;l++){const s=i[l];n&&n(s);const f=r[s.type](s);f&&(a+=f,f.length&&s.selectors&&(a+=e))}return a}return o(t.stylesheet.rules)}/**
 * @license BSD-3-Clause
 * Copyright (c) 2022, ッツ Reader Authors
 * All rights reserved.
 */const Pi=/\s?html\s?/gi,Fi=/\s?body\s?/gi;function Bi(t,e){const r=yi(t.styleSheet).stylesheet.rules.filter(o=>o.type==="rule").filter(o=>!o.selectors.some(i=>Pi.test(i)||Fi.test(i)));return r.forEach(o=>{const i={};o.declarations=o.declarations.filter(l=>!/line-height$/.test(l.property)&&!/text-indent$/.test(l.property));const a=new Ii(o.declarations,i);o.declarations.forEach(l=>{Ht(i,Di(l)),Ht(i,Ti(l)),Ht(i,a.convert(l))}),Object.entries(i).forEach(([l,s])=>{o.declarations.push({type:"declaration",property:l,value:s})}),o.declarations=o.declarations.filter(l=>!/writing-mode\s*$/.test(l.property))}),r.push(Ai()),r.forEach(o=>{o.selectors=Ei(o.selectors,e)}),Mi({stylesheet:{rules:r},type:"stylesheet"})}function Ei(t,e){return t.map(n=>`${e} ${n}`)}function Ht(t,e){return e&&(t[e.key]=e.value),t}function Di(t){const e=/(?:(?:-epub-)|(?:-webkit-))(.+)/i.exec(t.property);if(e)return{key:e[1],value:t.value}}function Ti(t){if(t.property==="font-family"){let e=t.value;return e.includes("sans-serif")?e="var(--font-family-sans-serif, Noto Sans JP, sans-serif)":e.includes("serif")&&(e="var(--font-family-serif, Noto Serif JP, serif)"),{key:t.property,value:e}}}class Ii{constructor(e,n){this.ruleDeclarations=e,this.newDeclarations=n}convert(e){if(/(?:(?:-epub-)|(?:-webkit-))?word-break$/i.exec(e.property)&&e.value==="break-all"&&(this.hasLineBreakDefined===void 0&&(this.hasLineBreakDefined=this.ruleDeclarations.some(n=>n.type==="declaration"&&n.property==="line-break")),!this.hasLineBreakDefined&&!this.newDeclarations["line-break"]))return{key:"line-break",value:"loose"}}}function Ai(){return{type:"rule",selectors:["br"],declarations:[{type:"declaration",property:"display",value:"inline!important"}]}}/**
 * @license BSD-3-Clause
 * Copyright (c) 2022, ッツ Reader Authors
 * All rights reserved.
 */function Oi(t,e,n){return pi(t,n).pipe(Se(r=>({htmlContent:r,styleSheet:Bi(t,e)})))}/**
 * @license BSD-3-Clause
 * Copyright (c) 2022, ッツ Reader Authors
 * All rights reserved.
 */function Vi(t){return new Qe(e=>t.subscribe(n=>{e.next(n)}))}/**
 * @license BSD-3-Clause
 * Copyright (c) 2022, ッツ Reader Authors
 * All rights reserved.
 */function vt(t=So){return e=>t?e:wo}/**
 * @license BSD-3-Clause
 * Copyright (c) 2022, ッツ Reader Authors
 * All rights reserved.
 */function yn(t,e,n){return r=>new Qe(o=>{const i=t();return r.pipe(Ln(Rt),br(()=>n(i))).subscribe({next:a=>{e(a,i),o.next(a)},error:a=>o.error(a),complete:()=>o.complete()})})}/**
 * @license BSD-3-Clause
 * Copyright (c) 2022, ッツ Reader Authors
 * All rights reserved.
 */function Ri(t,e,n,r,o,i,a,l,s){switch(e[t.code]){case Xe.BOOKMARK:return n(),!0;case Xe.JUMP_TO_BOOKMARK:return r(),!0;case Xe.AUTO_SCROLL_TOGGLE:return i==null||i.toggle(),!0;case Xe.AUTO_SCROLL_INCREASE:return o(1),!0;case Xe.AUTO_SCROLL_DECREASE:return o(-1),!0;case Xe.NEXT_PAGE:return a==null||a.nextPage(),!0;case Xe.PREV_PAGE:return a==null||a.prevPage(),!0;case Xe.PREV_CHAPTER:return s(l?1:-1),!0;case Xe.NEXT_CHAPTER:return s(l?-1:1),!0;default:return!1}}const{document:Wt,window:zi}=Dn;function Mn(t){var p;let e,n,r,o,i,a,l,s;function f(h){t[54](h)}let m={hasChapterData:!!((p=t[10])!=null&&p.length),showFullscreenButton:Pt.fullscreenEnabled,autoScrollMultiplier:t[14]};return t[3]!==void 0&&(m.isBookmarkScreen=t[3]),n=new ci({props:m}),ie.push(()=>he(n,"isBookmarkScreen",f)),n.$on("tocClick",t[55]),n.$on("fullscreenClick",t[52]),n.$on("bookmarkClick",t[50]),n.$on("bookManagerClick",t[51]),n.$on("settingsClick",t[50]),{c(){e=Q("div"),ge(n.$$.fragment),this.h()},l(h){e=Z(h,"DIV",{class:!0});var c=x(e);ke(n.$$.fragment,c),c.forEach(D),this.h()},h(){q(e,"class","elevation-4 writing-horizontal-tb fixed inset-x-0 top-0 z-10 w-full")},m(h,c){L(h,e,c),pe(n,e,null),a=!0,l||(s=Zt(o=Nn.call(null,e,t[56])),l=!0)},p(h,c){var v;t=h;const b={};c[0]&1024&&(b.hasChapterData=!!((v=t[10])!=null&&v.length)),c[0]&16384&&(b.autoScrollMultiplier=t[14]),!r&&c[0]&8&&(r=!0,b.isBookmarkScreen=t[3],me(()=>r=!1)),n.$set(b),o&&lo(o.update)&&c[0]&4&&o.update.call(null,t[56])},i(h){a||(W(n.$$.fragment,h),h&&In(()=>{i||(i=nn(e,Ut,{y:-300,easing:Kt},!0)),i.run(1)}),a=!0)},o(h){j(n.$$.fragment,h),h&&(i||(i=nn(e,Ut,{y:-300,easing:Kt},!1)),i.run(0)),a=!1},d(h){h&&D(e),be(n),h&&i&&i.end(),l=!1,s()}}}function Li(t){var r;let e=((r=t[36])!=null?r:"")+"",n;return{c(){n=ue(e)},l(o){n=fe(o,e)},m(o,i){L(o,n,i)},p(o,i){var a;i[1]&32&&e!==(e=((a=o[36])!=null?a:"")+"")&&Be(n,e)},i:at,o:at,d(o){o&&D(n)}}}function Gi(t){var w,A,R,X,G,te,N,U;let e,n,r,o,i,a,l,s,f,m,p,h=((w=t[33])!=null?w:"")+"",c,b,v=((A=t[34])!=null?A:"")+"",d,C,B=((R=t[35])!=null?R:"")+"",u,_;e=new si({props:{styleSheet:t[15].styleSheet}});function P(y){t[57](y)}function V(y){t[58](y)}function I(y){t[59](y)}function Y(y){t[60](y)}function oe(y){t[61](y)}function ae(y){t[62](y)}function k(y){t[63](y)}let T={htmlContent:t[15].htmlContent,width:(X=t[16])!=null?X:0,height:(G=t[17])!=null?G:0,verticalMode:t[11],fontColor:(te=t[18])==null?void 0:te.fontColor,backgroundColor:t[19],hintFuriganaFontColor:(N=t[18])==null?void 0:N.hintFuriganaFontColor,hintFuriganaShadowColor:(U=t[18])==null?void 0:U.hintFuriganaShadowColor,fontSize:t[20],fontFamilyGroupOne:t[21],fontFamilyGroupTwo:t[22],hideSpoilerImage:t[23],hideFurigana:t[24],furiganaStyle:t[25],viewMode:t[26],secondDimensionMaxValue:t[27],firstDimensionMargin:t[28],autoPositionOnResize:t[29],avoidPageBreak:t[30],pageColumns:t[31],autoBookmark:t[32],multiplier:t[14]};return t[5]!==void 0&&(T.exploredCharCount=t[5]),t[6]!==void 0&&(T.bookCharCount=t[6]),t[3]!==void 0&&(T.isBookmarkScreen=t[3]),t[9]!==void 0&&(T.bookmarkData=t[9]),t[0]!==void 0&&(T.autoScroller=t[0]),t[7]!==void 0&&(T.bookmarkManager=t[7]),t[8]!==void 0&&(T.pageManager=t[8]),r=new ii({props:T}),ie.push(()=>he(r,"exploredCharCount",P)),ie.push(()=>he(r,"bookCharCount",V)),ie.push(()=>he(r,"isBookmarkScreen",I)),ie.push(()=>he(r,"bookmarkData",Y)),ie.push(()=>he(r,"autoScroller",oe)),ie.push(()=>he(r,"bookmarkManager",ae)),ie.push(()=>he(r,"pageManager",k)),r.$on("bookmark",t[50]),{c(){ge(e.$$.fragment),n=$(),ge(r.$$.fragment),p=$(),c=ue(h),b=$(),d=ue(v),C=$(),u=ue(B)},l(y){ke(e.$$.fragment,y),n=ee(y),ke(r.$$.fragment,y),p=ee(y),c=fe(y,h),b=ee(y),d=fe(y,v),C=ee(y),u=fe(y,B)},m(y,O){pe(e,y,O),L(y,n,O),pe(r,y,O),L(y,p,O),L(y,c,O),L(y,b,O),L(y,d,O),L(y,C,O),L(y,u,O),_=!0},p(y,O){var _e,se,ve,ce,Ce,Ee,De,ye;const le={};O[0]&32768&&(le.styleSheet=y[15].styleSheet),e.$set(le);const H={};O[0]&32768&&(H.htmlContent=y[15].htmlContent),O[0]&65536&&(H.width=(_e=y[16])!=null?_e:0),O[0]&131072&&(H.height=(se=y[17])!=null?se:0),O[0]&2048&&(H.verticalMode=y[11]),O[0]&262144&&(H.fontColor=(ve=y[18])==null?void 0:ve.fontColor),O[0]&524288&&(H.backgroundColor=y[19]),O[0]&262144&&(H.hintFuriganaFontColor=(ce=y[18])==null?void 0:ce.hintFuriganaFontColor),O[0]&262144&&(H.hintFuriganaShadowColor=(Ce=y[18])==null?void 0:Ce.hintFuriganaShadowColor),O[0]&1048576&&(H.fontSize=y[20]),O[0]&2097152&&(H.fontFamilyGroupOne=y[21]),O[0]&4194304&&(H.fontFamilyGroupTwo=y[22]),O[0]&8388608&&(H.hideSpoilerImage=y[23]),O[0]&16777216&&(H.hideFurigana=y[24]),O[0]&33554432&&(H.furiganaStyle=y[25]),O[0]&67108864&&(H.viewMode=y[26]),O[0]&134217728&&(H.secondDimensionMaxValue=y[27]),O[0]&268435456&&(H.firstDimensionMargin=y[28]),O[0]&536870912&&(H.autoPositionOnResize=y[29]),O[0]&1073741824&&(H.avoidPageBreak=y[30]),O[1]&1&&(H.pageColumns=y[31]),O[1]&2&&(H.autoBookmark=y[32]),O[0]&16384&&(H.multiplier=y[14]),!o&&O[0]&32&&(o=!0,H.exploredCharCount=y[5],me(()=>o=!1)),!i&&O[0]&64&&(i=!0,H.bookCharCount=y[6],me(()=>i=!1)),!a&&O[0]&8&&(a=!0,H.isBookmarkScreen=y[3],me(()=>a=!1)),!l&&O[0]&512&&(l=!0,H.bookmarkData=y[9],me(()=>l=!1)),!s&&O[0]&1&&(s=!0,H.autoScroller=y[0],me(()=>s=!1)),!f&&O[0]&128&&(f=!0,H.bookmarkManager=y[7],me(()=>f=!1)),!m&&O[0]&256&&(m=!0,H.pageManager=y[8],me(()=>m=!1)),r.$set(H),(!_||O[1]&4)&&h!==(h=((Ee=y[33])!=null?Ee:"")+"")&&Be(c,h),(!_||O[1]&8)&&v!==(v=((De=y[34])!=null?De:"")+"")&&Be(d,v),(!_||O[1]&16)&&B!==(B=((ye=y[35])!=null?ye:"")+"")&&Be(u,B)},i(y){_||(W(e.$$.fragment,y),W(r.$$.fragment,y),_=!0)},o(y){j(e.$$.fragment,y),j(r.$$.fragment,y),_=!1},d(y){be(e,y),y&&D(n),be(r,y),y&&D(p),y&&D(c),y&&D(b),y&&D(d),y&&D(C),y&&D(u)}}}function Pn(t){let e,n,r,o,i,a;return n=new gi({props:{sectionData:t[10],verticalMode:t[11],exploredCharCount:t[5]}}),{c(){e=Q("div"),ge(n.$$.fragment),this.h()},l(l){e=Z(l,"DIV",{class:!0});var s=x(e);ke(n.$$.fragment,s),s.forEach(D),this.h()},h(){var l;q(e,"class","writing-horizontal-tb fixed top-0 left-0 z-[60] flex h-full w-full max-w-xl flex-col justify-between"),E(e,"color",(l=t[18])==null?void 0:l.fontColor,!1),E(e,"background-color",t[19],!1)},m(l,s){L(l,e,s),pe(n,e,null),o=!0,i||(a=Zt(Nn.call(null,e,t[64])),i=!0)},p(l,s){var m;t=l;const f={};s[0]&1024&&(f.sectionData=t[10]),s[0]&2048&&(f.verticalMode=t[11]),s[0]&32&&(f.exploredCharCount=t[5]),n.$set(f),s[0]&262144&&E(e,"color",(m=t[18])==null?void 0:m.fontColor,!1),s[0]&524288&&E(e,"background-color",t[19],!1)},i(l){o||(W(n.$$.fragment,l),l&&(r||In(()=>{r=so(e,Ut,{x:-100,duration:100,easing:Kt}),r.start()})),o=!0)},o(l){j(n.$$.fragment,l),o=!1},d(l){l&&D(e),be(n),i=!1,a()}}}function Fn(t){let e,n,r,o,i,a=(t[5]/t[6]*100).toFixed(2)+"",l,s;return{c(){e=Q("div"),n=ue(t[5]),r=ue(" / "),o=ue(t[6]),i=ue(" ("),l=ue(a),s=ue("%)"),this.h()},l(f){e=Z(f,"DIV",{class:!0});var m=x(e);n=fe(m,t[5]),r=fe(m," / "),o=fe(m,t[6]),i=fe(m," ("),l=fe(m,a),s=fe(m,"%)"),m.forEach(D),this.h()},h(){var f;q(e,"class","writing-horizontal-tb fixed bottom-2 right-2 z-10 text-xs leading-none"),E(e,"color",(f=t[18])==null?void 0:f.tooltipTextFontColor,!1)},m(f,m){L(f,e,m),J(e,n),J(e,r),J(e,o),J(e,i),J(e,l),J(e,s)},p(f,m){var p;m[0]&32&&Be(n,f[5]),m[0]&64&&Be(o,f[6]),m[0]&96&&a!==(a=(f[5]/f[6]*100).toFixed(2)+"")&&Be(l,a),m[0]&262144&&E(e,"color",(p=f[18])==null?void 0:p.tooltipTextFontColor,!1)},d(f){f&&D(e)}}}function Ni(t){var Y,oe,ae;let e,n,r=((Y=t[13])!=null?Y:"")+"",o,i,a,l,s,f,m,p,h,c,b,v,d,C;Wt.title=e=rn((ae=(oe=t[12])==null?void 0:oe.title)!=null?ae:"");let B=t[2]&&Mn(t);const u=[Gi,Li],_=[];function P(k,T){return k[15]?0:1}f=P(t),m=_[f]=u[f](t);let V=t[1]&&Pn(t),I=t[4]&&t[6]&&Fn(t);return{c(){n=$(),o=ue(r),i=$(),a=Q("button"),l=$(),B&&B.c(),s=$(),m.c(),p=$(),V&&V.c(),h=$(),I&&I.c(),c=$(),b=Q("button"),this.h()},l(k){ao('[data-svelte="svelte-rnuhm6"]',Wt.head).forEach(D),n=ee(k),o=fe(k,r),i=ee(k),a=Z(k,"BUTTON",{class:!0}),x(a).forEach(D),l=ee(k),B&&B.l(k),s=ee(k),m.l(k),p=ee(k),V&&V.l(k),h=ee(k),I&&I.l(k),c=ee(k),b=Z(k,"BUTTON",{class:!0}),x(b).forEach(D),this.h()},h(){q(a,"class","fixed inset-x-0 top-0 z-10 h-8 w-full"),q(b,"class","fixed inset-x-0 bottom-0 z-10 h-8 w-full cursor-pointer")},m(k,T){L(k,n,T),L(k,o,T),L(k,i,T),L(k,a,T),L(k,l,T),B&&B.m(k,T),L(k,s,T),_[f].m(k,T),L(k,p,T),V&&V.m(k,T),L(k,h,T),I&&I.m(k,T),L(k,c,T),L(k,b,T),v=!0,d||(C=[Fe(zi,"keydown",t[49]),Fe(a,"click",t[53]),Fe(b,"click",t[65])],d=!0)},p(k,T){var A,R,X;(!v||T[0]&4096)&&e!==(e=rn((R=(A=k[12])==null?void 0:A.title)!=null?R:""))&&(Wt.title=e),(!v||T[0]&8192)&&r!==(r=((X=k[13])!=null?X:"")+"")&&Be(o,r),k[2]?B?(B.p(k,T),T[0]&4&&W(B,1)):(B=Mn(k),B.c(),W(B,1),B.m(s.parentNode,s)):B&&(Le(),j(B,1,1,()=>{B=null}),Ge());let w=f;f=P(k),f===w?_[f].p(k,T):(Le(),j(_[w],1,1,()=>{_[w]=null}),Ge(),m=_[f],m?m.p(k,T):(m=_[f]=u[f](k),m.c()),W(m,1),m.m(p.parentNode,p)),k[1]?V?(V.p(k,T),T[0]&2&&W(V,1)):(V=Pn(k),V.c(),W(V,1),V.m(h.parentNode,h)):V&&(Le(),j(V,1,1,()=>{V=null}),Ge()),k[4]&&k[6]?I?I.p(k,T):(I=Fn(k),I.c(),I.m(c.parentNode,c)):I&&(I.d(1),I=null)},i(k){v||(W(B),W(m),W(V),v=!0)},o(k){j(B),j(m),j(V),v=!1},d(k){k&&D(n),k&&D(o),k&&D(i),k&&D(a),k&&D(l),B&&B.d(k),k&&D(s),_[f].d(k),k&&D(p),V&&V.d(k),k&&D(h),I&&I.d(k),k&&D(c),k&&D(b),d=!1,Ot(C)}}}const Bn="background-color",En="writing-mode";function Hi(t,e,n){let r,o,i,a,l,s,f,m,p,h,c,b,v,d,C,B,u,_,P,V,I,Y,oe,ae,k,T,w,A;K(t,Eo,S=>n(11,o=S)),K(t,rt,S=>n(1,i=S)),K(t,Nt,S=>n(14,s=S)),K(t,Do,S=>n(20,b=S)),K(t,To,S=>n(21,v=S)),K(t,Io,S=>n(22,d=S)),K(t,Ao,S=>n(23,C=S)),K(t,Oo,S=>n(24,B=S)),K(t,Vo,S=>n(25,u=S)),K(t,Ro,S=>n(26,_=S)),K(t,zo,S=>n(27,P=S)),K(t,Lo,S=>n(28,V=S)),K(t,Go,S=>n(29,I=S)),K(t,No,S=>n(30,Y=S)),K(t,Ho,S=>n(31,oe=S)),K(t,Wo,S=>n(32,ae=S));let R=!0,X=!1,G=!0,te=0,N=0,U,y,O,le=Promise.resolve(void 0);const H=xt(2500).pipe(Ye(()=>n(2,R=!1)),tt());K(t,H,S=>n(13,l=S));const _e=ct(()=>Vi(Xo)).pipe(Se(S=>Number(S.url.searchParams.get("id"))),jt({refCount:!0,bufferSize:1})),se=_e.pipe(mt(S=>_t.getData(S)),Yt());K(t,se,S=>n(12,a=S));const ve=se.pipe(Ye(S=>{S||Fo("/ebook-reader/manage")}),tt());K(t,ve,S=>n(36,A=S));const ce=se.pipe(Ye(S=>{!S||n(9,le=_t.getBookmark(S.id))}),tt());K(t,ce,S=>n(33,k=S));const Ce=se.pipe(mt(S=>S?(S.lastBookOpen=new Date().getTime(),vo(yo.BROWSER,window).then(Me=>Me.saveBook(S,S.title)).catch(()=>{}),en.next(S.sections||[]),Oi(S,".book-content",document)):lt),jt({refCount:!0,bufferSize:1}));K(t,Ce,S=>n(15,f=S));const Ee=ct(()=>qe(visualViewport,"resize")).pipe(Yt()),De=Ee.pipe(qt(0),Se(()=>visualViewport.width),vt());K(t,De,S=>n(16,m=S));const ye=Ee.pipe(qt(0),Se(()=>visualViewport.height),vt());K(t,ye,S=>n(17,p=S));const we=Mo.pipe(Se(S=>nr.get(S)),Vt(S=>!!S));K(t,we,S=>n(18,h=S));const de=we.pipe(Se(S=>S.backgroundColor));K(t,de,S=>n(19,c=S));const Ve=de.pipe(yn(()=>document.body,(S,Me)=>Me.style.setProperty(Bn,S),S=>S.style.removeProperty(Bn)),tt(),vt());K(t,Ve,S=>n(34,T=S));const Re=Po.pipe(yn(()=>document.documentElement,(S,Me)=>Me.style.setProperty(En,S),S=>S.style.removeProperty(En)),tt(),vt());K(t,Re,S=>n(35,w=S));const Ae=ct(()=>Dt).pipe(Se(S=>[...S.values()]));K(t,Ae,S=>n(10,r=S));function Ze(S){!Ri(S,Bo.getValue(),He,xe,ut=>Nt.next(Nt.getValue()+ut),U,O,o,F)||(document.activeElement instanceof HTMLElement&&document.activeElement.blur(),S.preventDefault())}function je(){let S;return _e.subscribe(Me=>S=Me).unsubscribe(),S}async function He(){const S=je();if(!S||!y)return;const Me=y.formatBookmarkData(S);await _t.putBookmark(Me),n(9,le=Promise.resolve(Me))}async function xe(){const S=await le;!S||!y||y.scrollToBookmark(S)}function M(){_t.deleteLastItem(),He()}function ne(){if(!Pt.fullscreenElement){Pt.requestFullscreen(document.documentElement);return}Pt.exitFullscreen()}function F(S){if(!(r!=null&&r.length))return;const[Me,ut]=qn(r);!ut&&S===-1||S===1&&ut===Me.length-1||bt.next(Me[ut+S].reference)}const re=()=>n(2,R=!0);function We(S){X=S,n(3,X)}const Te=()=>{n(2,R=!1),rt.next(!0)},ze=()=>n(2,R=!1);function Ct(S){te=S,n(5,te)}function g(S){N=S,n(6,N)}function Lt(S){X=S,n(3,X)}function Gt(S){le=S,n(9,le)}function Qn(S){U=S,n(0,U)}function Zn(S){y=S,n(7,y)}function xn(S){O=S,n(8,O)}const $n=()=>rt.next(!1),eo=()=>n(4,G=!G);return t.$$.update=()=>{t.$$.dirty[0]&3&&i&&(U==null||U.off())},[U,i,R,X,G,te,N,y,O,le,r,o,a,l,s,f,m,p,h,c,b,v,d,C,B,u,_,P,V,I,Y,oe,ae,k,T,w,A,H,se,ve,ce,Ce,De,ye,we,de,Ve,Re,Ae,Ze,He,M,ne,re,We,Te,ze,Ct,g,Lt,Gt,Qn,Zn,xn,$n,eo]}class Zi extends Ke{constructor(e){super(),Ue(this,e,Hi,Ni,Je,{},null,[-1,-1,-1])}}export{Zi as default};
