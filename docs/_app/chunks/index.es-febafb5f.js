import{f as I,p as $,h as W,T as V,U as q,g as G,o as F}from"./format-page-title-88a0fb5c.js";import{_ as J,a as K,O as U,d as z}from"./store-9e108e48.js";function Ee(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var r=$(t);return I(t,r)}var X=Array.isArray;function Q(t,e){return X(e)?t.apply(void 0,J([],K(e))):t(e)}function Z(t){return W(function(e){return Q(t,e)})}var Y=Array.isArray,ee=Object.getPrototypeOf,re=Object.prototype,te=Object.keys;function ne(t){if(t.length===1){var e=t[0];if(Y(e))return{args:e,keys:null};if(ae(e)){var r=te(e);return{args:r.map(function(n){return e[n]}),keys:r}}}return{args:t,keys:null}}function ae(t){return t&&typeof t=="object"&&ee(t)===re}function ie(t,e){return t.reduce(function(r,n,i){return r[n]=e[i],r},{})}function ke(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var r=$(t),n=V(t),i=ne(t),f=i.args,a=i.keys;if(f.length===0)return I([],r);var s=new U(se(f,r,a?function(o){return ie(a,o)}:z));return n?s.pipe(Z(n)):s}function se(t,e,r){return r===void 0&&(r=z),function(n){D(e,function(){for(var i=t.length,f=new Array(i),a=i,s=i,o=function(c){D(e,function(){var l=I(t[c],e),A=!1;l.subscribe(G(n,function(b){f[c]=b,A||(A=!0,s--),s||n.next(r(f.slice()))},function(){--a||n.complete()}))},n)},u=0;u<i;u++)o(u)},n)}}function D(t,e,r){t?q(r,t,e):e()}function Te(t){return F(function(e,r){try{e.subscribe(r)}finally{r.add(t)}})}function v(t){if(typeof t!="string")throw new TypeError("Path must be a string. Received "+JSON.stringify(t))}function _(t,e){for(var r="",n=0,i=-1,f=0,a,s=0;s<=t.length;++s){if(s<t.length)a=t.charCodeAt(s);else{if(a===47)break;a=47}if(a===47){if(!(i===s-1||f===1))if(i!==s-1&&f===2){if(r.length<2||n!==2||r.charCodeAt(r.length-1)!==46||r.charCodeAt(r.length-2)!==46){if(r.length>2){var o=r.lastIndexOf("/");if(o!==r.length-1){o===-1?(r="",n=0):(r=r.slice(0,o),n=r.length-1-r.lastIndexOf("/")),i=s,f=0;continue}}else if(r.length===2||r.length===1){r="",n=0,i=s,f=0;continue}}e&&(r.length>0?r+="/..":r="..",n=2)}else r.length>0?r+="/"+t.slice(i+1,s):r=t.slice(i+1,s),n=s-i-1;i=s,f=0}else a===46&&f!==-1?++f:f=-1}return r}function fe(t,e){var r=e.dir||e.root,n=e.base||(e.name||"")+(e.ext||"");return r?r===e.root?r+n:r+t+n:n}var E={resolve:function(){for(var e="",r=!1,n,i=arguments.length-1;i>=-1&&!r;i--){var f;i>=0?f=arguments[i]:(n===void 0&&(n=process.cwd()),f=n),v(f),f.length!==0&&(e=f+"/"+e,r=f.charCodeAt(0)===47)}return e=_(e,!r),r?e.length>0?"/"+e:"/":e.length>0?e:"."},normalize:function(e){if(v(e),e.length===0)return".";var r=e.charCodeAt(0)===47,n=e.charCodeAt(e.length-1)===47;return e=_(e,!r),e.length===0&&!r&&(e="."),e.length>0&&n&&(e+="/"),r?"/"+e:e},isAbsolute:function(e){return v(e),e.length>0&&e.charCodeAt(0)===47},join:function(){if(arguments.length===0)return".";for(var e,r=0;r<arguments.length;++r){var n=arguments[r];v(n),n.length>0&&(e===void 0?e=n:e+="/"+n)}return e===void 0?".":E.normalize(e)},relative:function(e,r){if(v(e),v(r),e===r||(e=E.resolve(e),r=E.resolve(r),e===r))return"";for(var n=1;n<e.length&&e.charCodeAt(n)===47;++n);for(var i=e.length,f=i-n,a=1;a<r.length&&r.charCodeAt(a)===47;++a);for(var s=r.length,o=s-a,u=f<o?f:o,c=-1,l=0;l<=u;++l){if(l===u){if(o>u){if(r.charCodeAt(a+l)===47)return r.slice(a+l+1);if(l===0)return r.slice(a+l)}else f>u&&(e.charCodeAt(n+l)===47?c=l:l===0&&(c=0));break}var A=e.charCodeAt(n+l),b=r.charCodeAt(a+l);if(A!==b)break;A===47&&(c=l)}var y="";for(l=n+c+1;l<=i;++l)(l===i||e.charCodeAt(l)===47)&&(y.length===0?y+="..":y+="/..");return y.length>0?y+r.slice(a+c):(a+=c,r.charCodeAt(a)===47&&++a,r.slice(a))},_makeLong:function(e){return e},dirname:function(e){if(v(e),e.length===0)return".";for(var r=e.charCodeAt(0),n=r===47,i=-1,f=!0,a=e.length-1;a>=1;--a)if(r=e.charCodeAt(a),r===47){if(!f){i=a;break}}else f=!1;return i===-1?n?"/":".":n&&i===1?"//":e.slice(0,i)},basename:function(e,r){if(r!==void 0&&typeof r!="string")throw new TypeError('"ext" argument must be a string');v(e);var n=0,i=-1,f=!0,a;if(r!==void 0&&r.length>0&&r.length<=e.length){if(r.length===e.length&&r===e)return"";var s=r.length-1,o=-1;for(a=e.length-1;a>=0;--a){var u=e.charCodeAt(a);if(u===47){if(!f){n=a+1;break}}else o===-1&&(f=!1,o=a+1),s>=0&&(u===r.charCodeAt(s)?--s===-1&&(i=a):(s=-1,i=o))}return n===i?i=o:i===-1&&(i=e.length),e.slice(n,i)}else{for(a=e.length-1;a>=0;--a)if(e.charCodeAt(a)===47){if(!f){n=a+1;break}}else i===-1&&(f=!1,i=a+1);return i===-1?"":e.slice(n,i)}},extname:function(e){v(e);for(var r=-1,n=0,i=-1,f=!0,a=0,s=e.length-1;s>=0;--s){var o=e.charCodeAt(s);if(o===47){if(!f){n=s+1;break}continue}i===-1&&(f=!1,i=s+1),o===46?r===-1?r=s:a!==1&&(a=1):r!==-1&&(a=-1)}return r===-1||i===-1||a===0||a===1&&r===i-1&&r===n+1?"":e.slice(r,i)},format:function(e){if(e===null||typeof e!="object")throw new TypeError('The "pathObject" argument must be of type Object. Received type '+typeof e);return fe("/",e)},parse:function(e){v(e);var r={root:"",dir:"",base:"",ext:"",name:""};if(e.length===0)return r;var n=e.charCodeAt(0),i=n===47,f;i?(r.root="/",f=1):f=0;for(var a=-1,s=0,o=-1,u=!0,c=e.length-1,l=0;c>=f;--c){if(n=e.charCodeAt(c),n===47){if(!u){s=c+1;break}continue}o===-1&&(u=!1,o=c+1),n===46?a===-1?a=c:l!==1&&(l=1):a!==-1&&(l=-1)}return a===-1||o===-1||l===0||l===1&&a===o-1&&a===s+1?o!==-1&&(s===0&&i?r.base=r.name=e.slice(1,o):r.base=r.name=e.slice(s,o)):(s===0&&i?(r.name=e.slice(1,a),r.base=e.slice(1,o)):(r.name=e.slice(s,a),r.base=e.slice(s,o)),r.ext=e.slice(a,o)),s>0?r.dir=e.slice(0,s-1):i&&(r.dir="/"),r},sep:"/",delimiter:":",win32:null,posix:null};E.posix=E;var p=E;/**
 * @license BSD-3-Clause
 * Copyright (c) 2022, ッツ Reader Authors
 * All rights reserved.
 */function oe(t){return`data:image/gif;ttu:${t};base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==`}/**
 * @license BSD-3-Clause
 * Copyright (c) 2022, ッツ Reader Authors
 * All rights reserved.
 */function le(t){const e=(r,n)=>{const i=r.getAttribute(n);i&&!(i.startsWith("ttu:")||i.startsWith("data:image/gif;ttu:"))&&(r.setAttribute(`data-ttu-${n}`,i),r.removeAttribute(n))};Array.from(t.getElementsByTagName("image")).forEach(r=>{e(r,"href")}),Array.from(t.getElementsByTagName("img")).forEach(r=>{e(r,"src")})}/**
 * @license BSD-3-Clause
 * Copyright (c) 2022, ッツ Reader Authors
 * All rights reserved.
 */function ce(t){Array.from(t.getElementsByTagName("image")).filter(e=>!e.getAttributeNames().some(r=>r==="href")).forEach(e=>{const r=Array.from(e.attributes).find(n=>n.name.endsWith("href"));!r||e.setAttribute("href",r.value)})}/**
 * @license BSD-3-Clause
 * Copyright (c) 2022, ッツ Reader Authors
 * All rights reserved.
 */function ue(t){return Array.from(t.classList).some(e=>e.includes("gaiji"))}/**
 * @license BSD-3-Clause
 * Copyright (c) 2022, ッツ Reader Authors
 * All rights reserved.
 */function j(t){return t instanceof HTMLImageElement?ue(t):!1}/**
 * @license BSD-3-Clause
 * Copyright (c) 2022, ッツ Reader Authors
 * All rights reserved.
 */function ge(t){return j(t)?1:me(t)}const de=/[^0-9A-Z○◯々-〇〻ぁ-ゖゝ-ゞァ-ヺー０-９Ａ-Ｚｦ-ﾝ\p{Radical}\p{Unified_Ideograph}]+/gimu;function me(t){return t.textContent?he(t.textContent.replace(de,"")):0}function he(t){return Array.from(t).length}/**
 * @license BSD-3-Clause
 * Copyright (c) 2022, ッツ Reader Authors
 * All rights reserved.
 */function ve(t){return R(t,e=>!(e.nodeName==="RT"||e instanceof HTMLElement&&(e.attributes.getNamedItem("aria-hidden")||e.attributes.getNamedItem("hidden")))).filter(e=>{var r;return!!(j(e)||(r=e.textContent)!=null&&r.replace(/\s/g,"").length)})}function R(t,e){return!t.hasChildNodes()||!e(t)?[]:Array.from(t.childNodes).flatMap(r=>r.nodeType===Node.TEXT_NODE?[r]:j(r)?[r]:R(r,e)).filter(e)}/**
 * @license BSD-3-Clause
 * Copyright (c) 2022, ッツ Reader Authors
 * All rights reserved.
 */const T="ttu-";function Se(t,e,r){let n={type:3,content:""},i="";const f=e.package.manifest.item.reduce((d,g)=>(g["@_media-type"]==="application/xhtml+xml"&&(d[g["@_id"]]=g["@_href"],g["@_properties"]==="nav"&&(i=g["@_href"])),d),{}),a=Object.entries(t).reduce((d,[g,m])=>{const h=g.endsWith(".ncx")&&!n.content;return(h||i===g)&&(n={type:h?2:3,content:m}),m instanceof Blob&&d.push(g),d},[]),s=new DOMParser,o=Array.isArray(e.package.spine.itemref)?e.package.spine.itemref:[e.package.spine.itemref],u=[],c=r.createElement("div");let l=[],A=-1;if(n.type&&n.content){const d=s.parseFromString(n.content,"text/html");n.type===3?l=[...d.querySelectorAll('nav[epub\\:type="toc"] a')].map(g=>{const m=g;return{reference:m.href,charactersWeight:1,label:m.innerText}}):l=[...d.querySelectorAll("navPoint")].map(g=>{const m=g.querySelector("navLabel text");return{reference:g.querySelector("content").getAttribute("src"),charactersWeight:1,label:m.innerText}})}l.length&&(A=o.findIndex(d=>l[0].reference.includes(f[d["@_idref"]])),A>0&&l.unshift({reference:f[o[0]["@_idref"]],charactersWeight:1,label:"Preface",startCharacter:0}));let b=l[0],y=b?`${T}${o[A]["@_idref"]}`:"",w=0,O=0,L=0;return o.forEach(d=>{var P,B;const g=d["@_idref"],m=f[g],h=/.*<body(?:[^>]*id="(?<id>.+?)")*[^>]*>(?<body>(.|\s)+)<\/body>.*/.exec(t[m]),H=((P=h==null?void 0:h.groups)==null?void 0:P.id)||"";let N=((B=h==null?void 0:h.groups)==null?void 0:B.body)||"";a.forEach(C=>{N=N.replaceAll(be(m,C),oe(C))});const k=r.createElement("div");if(k.innerHTML=N,k.id=`${T}${g}`,H){const C=r.createElement("span");C.id=H,k.prepend(C)}c.appendChild(k),L+=Ae(k);const x=l.findIndex(C=>C.reference.includes(m)),M=x>-1?l[x]:void 0,S=L-O;M?(b=M,w=u.length,y=`${T}${g}`,u.push({reference:y,charactersWeight:S||1,label:b.label,startCharacter:O,characters:S-(x?0:1)})):b&&(u[w].characters+=S,u.push({reference:`${T}${g}`,charactersWeight:S||1,parentChapter:y})),O=L}),le(c),ce(c),ye(c),{element:c,sections:u.filter(d=>d.reference.startsWith(T))}}function Ae(t){const e=ve(t);let r=0;return e.forEach(n=>{r+=ge(n)}),r}function ye(t){Array.from(t.getElementsByTagName("a")).forEach(e=>{const r=e.getAttribute("href");!r||e.setAttribute("href",`#${r.replace(/.+#/,"")}`)})}function be(t,e){const r=p.dirname(t),n=p.dirname(e),i=p.basename(e);if(r===n)return i;const f=r==="."?[]:r.split("/"),a=n==="."?[]:n.split("/");if(f.length>=a.length){for(let s=0;s<f.length;s+=1)if(f[s]!==a[s])return p.join("../".repeat(f.length-s)+a.slice(s).join("/"),i)}for(let s=0;s<f.length;s+=1)if(f[s]!==a[s])return p.join("../".repeat(f.length-s)+a.slice(s).join("/"),i);return p.join(a.slice(f.length-a.length).join("/"),i)}/*!
 * Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com
 * License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License)
 * Copyright 2022 Fonticons, Inc.
 */var Oe={prefix:"far",iconName:"bookmark",icon:[384,512,[61591,128278],"f02e","M336 0h-288C21.49 0 0 21.49 0 48v431.9c0 24.7 26.79 40.08 48.12 27.64L192 423.6l143.9 83.93C357.2 519.1 384 504.6 384 479.9V48C384 21.49 362.5 0 336 0zM336 452L192 368l-144 84V54C48 50.63 50.63 48 53.1 48h276C333.4 48 336 50.63 336 54V452z"]},Le={prefix:"far",iconName:"image",icon:[512,512,[],"f03e","M152 120c-26.51 0-48 21.49-48 48s21.49 48 48 48s48-21.49 48-48S178.5 120 152 120zM447.1 32h-384C28.65 32-.0091 60.65-.0091 96v320c0 35.35 28.65 64 63.1 64h384c35.35 0 64-28.65 64-64V96C511.1 60.65 483.3 32 447.1 32zM463.1 409.3l-136.8-185.9C323.8 218.8 318.1 216 312 216c-6.113 0-11.82 2.768-15.21 7.379l-106.6 144.1l-37.09-46.1c-3.441-4.279-8.934-6.809-14.77-6.809c-5.842 0-11.33 2.529-14.78 6.809l-75.52 93.81c0-.0293 0 .0293 0 0L47.99 96c0-8.822 7.178-16 16-16h384c8.822 0 16 7.178 16 16V409.3z"]};export{ge as a,oe as b,ke as c,Oe as d,Le as e,Te as f,ve as g,p as h,ue as i,Se as j,le as k,ce as l,Z as m,Ee as o,T as p};
